<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>A dive into the PE file format - PE file structure - Part 1: Overview - 0xRick’s Blog</title>
<meta name="description" content="A dive into the PE file format - PE file structure - Part 1: Overview  Introduction  The aim of this post is to provide a basic introduction to the PE file structure without talking about any details.    PE files  PE stands for Portable Executable, it’s a file format for executables used in Windows operating systems, it’s based on the COFF file format (Common Object File Format).  Not only .exe files are PE files, dynamic link libraries (.dll), Kernel modules (.srv), Control panel applications (.cpl) and many others are also PE files.  A PE file is a data structure that holds information necessary for the OS loader to be able to load that executable into memory and execute it.    Structure Overview  A typical PE file follows the structure outlined in the following figure:    If we open an executable file with PE-bear we’ll see the same thing:    DOS Header  Every PE file starts with a 64-bytes-long structure called the DOS header, it’s what makes the PE file an MS-DOS executable.  DOS Stub  After the DOS header comes the DOS stub which is a small MS-DOS 2.0 compatible executable that just prints an error message saying “This program cannot be run in DOS mode” when the program is run in DOS mode.  NT Headers  The NT Headers part contains three main parts:     PE signature: A 4-byte signature that identifies the file as a PE file.   File Header: A standard COFF File Header. It holds some information about the PE file.   Optional Header: The most important header of the NT Headers, its name is the Optional Header because some files like object files don’t have it, however it’s required for image files (files like .exe files). This header provides important information to the OS loader.   Section Table  The section table follows the Optional Header immediately, it is an array of Image Section Headers, there’s a section header for every section in the PE file. Each header contains information about the section it refers to.  Sections  Sections are where the actual contents of the file are stored, these include things like data and resources that the program uses, and also the actual code of the program, there are several sections each one with its own purpose.    Conclusion  In this post we looked at a very basic overview of the PE file structure and talked briefly about the main parts of a PE files. In the upcoming posts we’ll talk about each one of these parts in much more detail.">


  <meta name="author" content="0xRick">
  
  <meta property="article:author" content="0xRick">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en">
<meta property="og:site_name" content="0xRick's Blog">
<meta property="og:title" content="A dive into the PE file format - PE file structure - Part 1: Overview">
<meta property="og:url" content="https://0xrick.github.io/win-internals/pe2/">


  <meta property="og:description" content="A dive into the PE file format - PE file structure - Part 1: Overview  Introduction  The aim of this post is to provide a basic introduction to the PE file structure without talking about any details.    PE files  PE stands for Portable Executable, it’s a file format for executables used in Windows operating systems, it’s based on the COFF file format (Common Object File Format).  Not only .exe files are PE files, dynamic link libraries (.dll), Kernel modules (.srv), Control panel applications (.cpl) and many others are also PE files.  A PE file is a data structure that holds information necessary for the OS loader to be able to load that executable into memory and execute it.    Structure Overview  A typical PE file follows the structure outlined in the following figure:    If we open an executable file with PE-bear we’ll see the same thing:    DOS Header  Every PE file starts with a 64-bytes-long structure called the DOS header, it’s what makes the PE file an MS-DOS executable.  DOS Stub  After the DOS header comes the DOS stub which is a small MS-DOS 2.0 compatible executable that just prints an error message saying “This program cannot be run in DOS mode” when the program is run in DOS mode.  NT Headers  The NT Headers part contains three main parts:     PE signature: A 4-byte signature that identifies the file as a PE file.   File Header: A standard COFF File Header. It holds some information about the PE file.   Optional Header: The most important header of the NT Headers, its name is the Optional Header because some files like object files don’t have it, however it’s required for image files (files like .exe files). This header provides important information to the OS loader.   Section Table  The section table follows the Optional Header immediately, it is an array of Image Section Headers, there’s a section header for every section in the PE file. Each header contains information about the section it refers to.  Sections  Sections are where the actual contents of the file are stored, these include things like data and resources that the program uses, and also the actual code of the program, there are several sections each one with its own purpose.    Conclusion  In this post we looked at a very basic overview of the PE file structure and talked briefly about the main parts of a PE files. In the upcoming posts we’ll talk about each one of these parts in much more detail.">





  <meta name="twitter:site" content="@ahm3d_h3sham">
  <meta name="twitter:title" content="A dive into the PE file format - PE file structure - Part 1: Overview">
  <meta name="twitter:description" content="A dive into the PE file format - PE file structure - Part 1: Overview  Introduction  The aim of this post is to provide a basic introduction to the PE file structure without talking about any details.    PE files  PE stands for Portable Executable, it’s a file format for executables used in Windows operating systems, it’s based on the COFF file format (Common Object File Format).  Not only .exe files are PE files, dynamic link libraries (.dll), Kernel modules (.srv), Control panel applications (.cpl) and many others are also PE files.  A PE file is a data structure that holds information necessary for the OS loader to be able to load that executable into memory and execute it.    Structure Overview  A typical PE file follows the structure outlined in the following figure:    If we open an executable file with PE-bear we’ll see the same thing:    DOS Header  Every PE file starts with a 64-bytes-long structure called the DOS header, it’s what makes the PE file an MS-DOS executable.  DOS Stub  After the DOS header comes the DOS stub which is a small MS-DOS 2.0 compatible executable that just prints an error message saying “This program cannot be run in DOS mode” when the program is run in DOS mode.  NT Headers  The NT Headers part contains three main parts:     PE signature: A 4-byte signature that identifies the file as a PE file.   File Header: A standard COFF File Header. It holds some information about the PE file.   Optional Header: The most important header of the NT Headers, its name is the Optional Header because some files like object files don’t have it, however it’s required for image files (files like .exe files). This header provides important information to the OS loader.   Section Table  The section table follows the Optional Header immediately, it is an array of Image Section Headers, there’s a section header for every section in the PE file. Each header contains information about the section it refers to.  Sections  Sections are where the actual contents of the file are stored, these include things like data and resources that the program uses, and also the actual code of the program, there are several sections each one with its own purpose.    Conclusion  In this post we looked at a very basic overview of the PE file structure and talked briefly about the main parts of a PE files. In the upcoming posts we’ll talk about each one of these parts in much more detail.">
  <meta name="twitter:url" content="https://0xrick.github.io/win-internals/pe2/">

  
    <meta name="twitter:card" content="summary">
    
  

  



  <meta property="article:published_time" content="2021-10-22T03:01:00+02:00">






<link rel="canonical" href="https://0xrick.github.io/win-internals/pe2/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "0xRick",
      "url": "https://0xrick.github.io/"
    
  }
</script>







<!-- end _includes/seo.html -->




<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          0xRick's Blog
          
        </a>
        <ul class="visible-links">
<li class="masthead__menu-item">
              <a href="/about">About</a>
            </li>
<li class="masthead__menu-item">
              <a href="/categories">Categories</a>
            </li>
<li class="masthead__menu-item">
              <a href="/tags">Tags</a>
            </li>
</ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/images/avatar.jpg" alt="0xRick" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">0xRick</h3>
    
    
      <div class="author__bio" itemprop="description">
        

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Somewhere between 1's and 0's</span>
        </li>
      

      
        
          
            <li><a href="/" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-home" aria-hidden="true"></i><span class="label">Home Page</span></a></li>
          
        
          
            <li><a href="https://twitter.com/ahm3d_h3sham" rel="noopener noreferrer" target="_blank"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
          
        
          
            <li><a href="https://github.com/0xRick" rel="noopener noreferrer" target="_blank"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">Github</span></a></li>
          
        
          
            <li><a href="https://www.buymeacoffee.com/VGEfcAqvn" rel="noopener noreferrer" target="_blank"><i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">buymeacoffee</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>
 
  
  </div>


  <article class="page h-entry" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="A dive into the PE file format - PE file structure - Part 1: Overview">
    <meta itemprop="description" content="A dive into the PE file format - PE file structure - Part 1: OverviewIntroductionThe aim of this post is to provide a basic introduction to the PE file structure without talking about any details.PE filesPE stands for Portable Executable, it’s a file format for executables used in Windows operating systems, it’s based on the COFF file format (Common Object File Format).Not only .exe files are PE files, dynamic link libraries (.dll), Kernel modules (.srv), Control panel applications (.cpl) and many others are also PE files.A PE file is a data structure that holds information necessary for the OS loader to be able to load that executable into memory and execute it.Structure OverviewA typical PE file follows the structure outlined in the following figure:If we open an executable file with PE-bear we’ll see the same thing:DOS HeaderEvery PE file starts with a 64-bytes-long structure called the DOS header, it’s what makes the PE file an MS-DOS executable.DOS StubAfter the DOS header comes the DOS stub which is a small MS-DOS 2.0 compatible executable that just prints an error message saying “This program cannot be run in DOS mode” when the program is run in DOS mode.NT HeadersThe NT Headers part contains three main parts:  PE signature: A 4-byte signature that identifies the file as a PE file.  File Header: A standard COFF File Header. It holds some information about the PE file.  Optional Header: The most important header of the NT Headers, its name is the Optional Header because some files like object files don’t have it, however it’s required for image files (files like .exe files). This header provides important information to the OS loader.Section TableThe section table follows the Optional Header immediately, it is an array of Image Section Headers, there’s a section header for every section in the PE file.Each header contains information about the section it refers to.SectionsSections are where the actual contents of the file are stored, these include things like data and resources that the program uses, and also the actual code of the program, there are several sections each one with its own purpose.ConclusionIn this post we looked at a very basic overview of the PE file structure and talked briefly about the main parts of a PE files.In the upcoming posts we’ll talk about each one of these parts in much more detail.">
    <meta itemprop="datePublished" content="2021-10-22T03:01:00+02:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title p-name" itemprop="headline">
            <a href="https://0xrick.github.io/win-internals/pe2/" class="u-url" itemprop="url">A dive into the PE file format - PE file structure - Part 1: Overview
</a>
          </h1>
          

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2021-10-22T03:01:00+02:00">October 22, 2021</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          2 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content e-content" itemprop="text">
        <div>
          <style>
              #carbonads {
                border: 1px solid black;
                border-radius: 7px;
                border-spacing: 7px;
                display: block;
                overflow: hidden;
                padding: 1em;
                line-height: 1.5;
              }
              #carbonads span {
                position: relative;
                display: block;
                overflow: hidden;
              }
              .carbon-img img {
                display: block;
                float: left;
              }
              .carbon-text {
                display: block;
                font-size: .9em;
                text-align: end;
              }
              .carbon-poweredby {
                display: block;
                font-size: .8em;
                float: right;
                line-height: 1;
                letter-spacing: 1px;
                }
                </style>
                <br>   
          <script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CK7DL23U&amp;placement=0xrickgithubio" id="_carbonads_js"></script> 
                <br>
        </div>
        
          <aside class="sidebar__right ">
            <nav class="toc">
              <header><h4 class="nav__title">
<i class="fas fa-file-alt"></i> Contents</h4></header>
              <ul class="toc__menu"><li>
<a href="#a-dive-into-the-pe-file-format---pe-file-structure---part-1-overview">A dive into the PE file format - PE file structure - Part 1: Overview</a><ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#pe-files">PE files</a></li>
<li>
<a href="#structure-overview">Structure Overview</a><ul>
<li><a href="#dos-header">DOS Header</a></li>
<li><a href="#dos-stub">DOS Stub</a></li>
<li><a href="#nt-headers">NT Headers</a></li>
<li><a href="#section-table">Section Table</a></li>
<li><a href="#sections">Sections</a></li>
</ul>
</li>
<li><a href="#conclusion">Conclusion</a></li>
</ul>
</li></ul>

            </nav>
          </aside>
        
        <h2 id="a-dive-into-the-pe-file-format---pe-file-structure---part-1-overview">A dive into the PE file format - PE file structure - Part 1: Overview</h2>

<h3 id="introduction">Introduction</h3>

<p>The aim of this post is to provide a basic introduction to the PE file structure without talking about any details.</p>

<hr>

<h3 id="pe-files">PE files</h3>

<p>PE stands for Portable Executable, it’s a file format for executables used in Windows operating systems, it’s based on the <code class="language-plaintext highlighter-rouge">COFF</code> file format (Common Object File Format).</p>

<p>Not only <code class="language-plaintext highlighter-rouge">.exe</code> files are PE files, dynamic link libraries (<code class="language-plaintext highlighter-rouge">.dll</code>), Kernel modules (<code class="language-plaintext highlighter-rouge">.srv</code>), Control panel applications (<code class="language-plaintext highlighter-rouge">.cpl</code>) and many others are also PE files.</p>

<p>A PE file is a data structure that holds information necessary for the OS loader to be able to load that executable into memory and execute it.</p>

<hr>

<h3 id="structure-overview">Structure Overview</h3>

<p>A typical PE file follows the structure outlined in the following figure:</p>

<p><img src="/images/wininternals/pe2/1.png" alt="" class="align-center"></p>

<p>If we open an executable file with <code class="language-plaintext highlighter-rouge">PE-bear</code> we’ll see the same thing:</p>

<p><img src="/images/wininternals/pe2/2.png" alt="" class="align-center"></p>

<h4 id="dos-header">DOS Header</h4>

<p>Every PE file starts with a 64-bytes-long structure called the DOS header, it’s what makes the PE file an MS-DOS executable.</p>

<h4 id="dos-stub">DOS Stub</h4>

<p>After the DOS header comes the DOS stub which is a small MS-DOS 2.0 compatible executable that just prints an error message saying “This program cannot be run in DOS mode” when the program is run in DOS mode.</p>

<h4 id="nt-headers">NT Headers</h4>

<p>The NT Headers part contains three main parts:</p>

<ul>
  <li>
<strong>PE signature:</strong> A 4-byte signature that identifies the file as a PE file.</li>
  <li>
<strong>File Header:</strong> A standard <code class="language-plaintext highlighter-rouge">COFF</code> File Header. It holds some information about the PE file.</li>
  <li>
<strong>Optional Header:</strong> The most important header of the NT Headers, its name is the Optional Header because some files like object files don’t have it, however it’s required for image files (files like <code class="language-plaintext highlighter-rouge">.exe</code> files). This header provides important information to the OS loader.</li>
</ul>

<h4 id="section-table">Section Table</h4>

<p>The section table follows the Optional Header immediately, it is an array of Image Section Headers, there’s a section header for every section in the PE file.
<br>Each header contains information about the section it refers to.</p>

<h4 id="sections">Sections</h4>

<p>Sections are where the actual contents of the file are stored, these include things like data and resources that the program uses, and also the actual code of the program, there are several sections each one with its own purpose.</p>

<hr>

<h3 id="conclusion">Conclusion</h3>

<p>In this post we looked at a very basic overview of the PE file structure and talked briefly about the main parts of a PE files.
<br>In the upcoming posts we’ll talk about each one of these parts in much more detail.</p>

        
      </section>

      <footer class="page__meta">
        
        


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2021-10-22T03:01:00+02:00">October 22, 2021</time></p>


      </footer>

      

      
  <nav class="pagination">
    
      <a href="/win-internals/pe1/" class="pagination--pager" title="A dive into the PE file format - Introduction
">Previous</a>
    
    
      <a href="/win-internals/pe3/" class="pagination--pager" title="A dive into the PE file format - PE file structure - Part 2: DOS Header, DOS Stub and Rich Header
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
</div>
    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
    <ul class="social-icons">
      
  
      
  
      
    </ul>
  </div>
      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>







  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-97164925-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-97164925-2', { 'anonymize_ip': false});
</script>









  </body>
</html>
